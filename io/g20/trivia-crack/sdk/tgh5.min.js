var __tgh5_block_popstate_event,TGH5=TGH5||{};(function(){TGH5.keyMapperLib=TGH5.keyMapperLib||{},TGH5.keyMapperLib.keyNames={KEY_RED:"Red",KEY_YELLOW:"Yellow",KEY_BLUE:"Blue",KEY_GREEN:"Green",KEY_INFO:"Info",KEY_SHIFT:"Shift",KEY_EXIT:"Exit",KEY_ESC:"Esc",KEY_ENTER:"Enter",KEY_BACKSPACE:"Backspace",KEY_LEFT:"Left",KEY_RIGHT:"Right",KEY_UP:"Up",KEY_DOWN:"Down",KEY_SPACE:"Space",KEY_DELETE:"Delete",KEY_LEFT_PARENTHESIS:")",KEY_EXCLAMATION_MARK:"!",KEY_AT:"@",KEY_HASH:"#",KEY_DOLLAR:"$",KEY_PERCENT:"%",KEY_CARET:"^",KEY_AMPERSAND:"&",KEY_ASTERISK:"*",KEY_RIGHT_PARENTHESIS:"(",KEY_0:"0",KEY_1:"1",KEY_2:"2",KEY_3:"3",KEY_4:"4",KEY_5:"5",KEY_6:"6",KEY_7:"7",KEY_8:"8",KEY_9:"9",KEY_A:"A",KEY_B:"B",KEY_C:"C",KEY_D:"D",KEY_E:"E",KEY_F:"F",KEY_G:"G",KEY_H:"H",KEY_I:"I",KEY_J:"J",KEY_K:"K",KEY_L:"L",KEY_M:"M",KEY_N:"N",KEY_O:"O",KEY_P:"P",KEY_Q:"Q",KEY_R:"R",KEY_S:"S",KEY_T:"T",KEY_U:"U",KEY_V:"V",KEY_W:"W",KEY_X:"X",KEY_Y:"Y",KEY_Z:"Z",KEY_F1:"F1",KEY_F2:"F2",KEY_F3:"F3",KEY_F4:"F4",KEY_F5:"F5",KEY_F6:"F6",KEY_F7:"F7",KEY_F8:"F8",KEY_F9:"F9",KEY_F10:"F10",KEY_F11:"F11",KEY_F12:"F12",KEY_NUMPAD0:"Num0",KEY_NUMPAD1:"Num1",KEY_NUMPAD2:"Num2",KEY_NUMPAD3:"Num3",KEY_NUMPAD4:"Num4",KEY_NUMPAD5:"Num5",KEY_NUMPAD6:"Num6",KEY_NUMPAD7:"Num7",KEY_NUMPAD8:"Num8",KEY_NUMPAD9:"Num9",KEY_CONTROL:"Control",KEY_FORWARD:"Forward",KEY_REWIND:"Rewind",KEY_PLAY:"Play",KEY_STOP:"Stop",KEY_MENU:"Menu",KEY_SEARCH:"Search",KEY_SUBTITLES:"Subtitles",KEY_AUDIODESC:"AudioDesc",KEY_SKIP:"Skip"}})(),TGH5=TGH5||{},function(){function t(t){var n;for(n in e)if(e.hasOwnProperty(n)&&t===e[n])return!0;return!1}function n(e){var t,n;for(t=e.length-1;t>=0;t--){n=e[t];if(typeof n=="string"&&typeof window[n]!="undefined"&&!!window[n])return window[n];if(n&&typeof n=="number")return n}return null}function r(e){var r,i,s,o,u=[];for(r in e)if(e.hasOwnProperty(r))if(t(r)){i=e[r];for(s=i.length-1;s>=0;s--)o=i[s],o instanceof Array?o=n(o):o=n([o]),typeof o=="number"&&o&&(u[o]=r)}else window.console&&window.console.log&&console.log("prepareIndexedKeySubMap WARNING: key "+r+" not found in keyNames");return u}var e=TGH5.keyMapperLib.keyNames;TGH5.keyMapperLib.utils={prepareIndexedKeyMap:function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=r(e[t]));return n},fixEvent:function(e){e=e||window.event,typeof e.keyCode=="undefined"&&(e.keyCode=0),e.target||(e.target=event.srcElement),!e.relatedTarget&&e.fromElement&&(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement)},getKeyNameByKeyCode:function(e,t,n){var r=e.other[t];return r||(n?r=e.shiftOn[t]:r=e.shiftOff[t]),r},repeatSimulation:!1,repeatTimer:0,repeatInterval:0,repeatFirstIntervalCount:0,repeatLastKey:null,repeatFirstDelayN:5,repeatFirstDelay:100,repeatDelay:300,onKeyDownListener:null,_simulateRepeatKeyDown:function(e){var t=this;if(!this.repeatSimulation)return;if(e==TGH5.keyMapperLib.keyNames.KEY_LEFT||e==TGH5.keyMapperLib.keyNames.KEY_RIGHT||e==TGH5.keyMapperLib.keyNames.KEY_UP||e==TGH5.keyMapperLib.keyNames.KEY_DOWN){this.simulateRepeatStop(),this.repeatLastKey=e;function n(){t.onKeyDownListener&&(t.onKeyDownListener(t.repeatLastKey)||(t.repeatTimer=setTimeout(n,t.repeatDelay)))}this.repeatLastKey&&(this.repeatFirstIntervalCount=0,this.repeatIterval&&clearInterval(this.repeatIterval),this.repeatIterval=setInterval(function(){t.repeatFirstIntervalCount++,t.repeatFirstIntervalCount>=t.repeatFirstDelayN&&(clearInterval(t.repeatIterval),t.repeatIterval=0,n())},this.repeatFirstDelay))}},simulateRepeatStop:function(){if(!this.repeatSimulation)return;this.repeatTimer&&(clearTimeout(this.repeatTimer),this.repeatTimer=0),this.repeatIterval&&(clearInterval(this.repeatIterval),this.repeatIterval=0),this.repeatLastKey=null},addListeners:function(e,t,n,r,i){var s=TGH5.keyMapperLib.utils,o=!1,u=this;this.onKeyDownListener=t,document.documentElement.addEventListener("keydown",function(a){var f,l,c;a=a||window.event,s.fixEvent(a),f=a.keyCode,a.keyCode===r&&(o=!0),l=s.getKeyNameByKeyCode(e,f,o);if(l){a.preventDefault(),c=t(l),i===!0&&(u.simulateRepeatStop(),c|=n(l));if(c)return!1;u._simulateRepeatKeyDown(l)}return!0},!1),i!==!0&&document.documentElement.addEventListener("keyup",function(t){var i,a;t=t||window.event,s.fixEvent(t),u.simulateRepeatStop(),i=t.keyCode,t.keyCode===r&&(o=!1),a=s.getKeyNameByKeyCode(e,i,o);if(a){t.preventDefault();if(n(a))return!1}return!0},!0)},bind:function(e,t){return function(){return e.apply(t,arguments)}}}}(),TGH5=TGH5||{},function(){var e,t;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=TGH5.keyMapperLib.utils,t=e.prepareIndexedKeyMap({shiftOn:{")":[[48,"VK_0"]],"!":[[49,"VK_1"]],"@":[[50,"VK_2"]],"#":[[51,"VK_3"]],$:[[52,"VK_4"]],"%":[[53,"VK_5"]],"^":[[54,"VK_6"]],"&":[[55,"VK_7"]],"*":[[56,"VK_8"]],"(":[[57,"VK_9"]]},shiftOff:{0:[[48,"VK_0"]],1:[[49,"VK_1"]],2:[[50,"VK_2"]],3:[[51,"VK_3"]],4:[[52,"VK_4"]],5:[[53,"VK_5"]],6:[[54,"VK_6"]],7:[[55,"VK_7"]],8:[[56,"VK_8"]],9:[[57,"VK_9"]]},other:{Left:[[37,"VK_LEFT"]],Up:[[38,"VK_UP"]],Right:[[39,"VK_RIGHT"]],Down:[[40,"VK_DOWN"]],Shift:[[16,"VK_SHIFT"]],Esc:[[27,"VK_ESCAPE"]],Backspace:[[8,"VK_BACK","VK_HID_BACK","VK_HID_BACK"]],Enter:[[13,"VK_ENTER"]],Space:[[32,"VK_SPACE"]],Delete:[[46,"VK_DELETE"]],A:[[65,"VK_A"]],B:[[66,"VK_B"]],C:[[67,"VK_C"]],D:[[68,"VK_D"]],E:[[69,"VK_E"]],F:[[70,"VK_F"]],G:[[71,"VK_G"]],H:[[72,"VK_H"]],I:[[73,"VK_I"]],J:[[74,"VK_J"]],K:[[75,"VK_K"]],L:[[76,"VK_L"]],M:[[77,"VK_M"]],N:[[78,"VK_N"]],O:[[79,"VK_O"]],P:[[80,"VK_P"]],Q:[[81,"VK_Q"]],R:[[82,"VK_R"]],S:[[83,"VK_S"]],T:[[84,"VK_T"]],U:[[85,"VK_U"]],V:[[86,"VK_V"]],W:[[87,"VK_W"]],X:[[88,"VK_X"]],Y:[[89,"VK_Y"]],Z:[[90,"VK_Z"]],F1:[[112,"VK_F1"]],F2:[[113,"VK_F2"]],F3:[[114,"VK_F3"]],F4:[[115,"VK_F4"]],F5:[[116,"VK_F5"]],F6:[[117,"VK_F6"]],F7:[[118,"VK_F7"]],F8:[[119,"VK_F8"]],F9:[[120,"VK_F9"]],F10:[[121,"VK_F10"]],F11:[[122,"VK_F11"]],F12:[[123,"VK_F12"]],Num0:[[96,"VK_NUMPAD0"]],Num1:[[97,"VK_NUMPAD1"]],Num2:[[98,"VK_NUMPAD2"]],Num3:[[99,"VK_NUMPAD3"]],Num4:[[100,"VK_NUMPAD4"]],Num5:[[101,"VK_NUMPAD5"]],Num6:[[102,"VK_NUMPAD6"]],Num7:[[103,"VK_NUMPAD7"]],Num8:[[104,"VK_NUMPAD8"]],Num9:[[105,"VK_NUMPAD9"]],Control:[[17,"VK_CONTROL"]],Red:[403],Green:[404],Yellow:[405],Blue:[406],Play:[179],Forward:[228],Rewind:[227]}}),TGH5.keyMapperLib.genericKeyMap=t,TGH5.keyMapperLib.plugins.Generic=function(n,r,i){var s,o=!1;e.addListeners(t,n,r,16),s=function(e){window.history.state!=="backhandler"&&(n(TGH5.keyMapperLib.keyNames.KEY_BACKSPACE),r(TGH5.keyMapperLib.keyNames.KEY_BACKSPACE),window.history.pushState("backhandler",null,null))},this.popStateHandling=function(e){if(e==o)return;e?(window.history.pushState("backhandler",null,null),window.addEventListener("popstate",s,!1)):(window.removeEventListener("popstate",s,!1),history.back()),o=e},i()}}(),TGH5=TGH5||{},function(){var e,t;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=TGH5.keyMapperLib.utils,t=e.prepareIndexedKeyMap({shiftOn:{")":[[48,"VK_0"]],"!":[[49,"VK_1"]],"@":[[50,"VK_2"]],"#":[[51,"VK_3"]],$:[[52,"VK_4"]],"%":[[53,"VK_5"]],"^":[[54,"VK_6"]],"&":[[55,"VK_7"]],"*":[[56,"VK_8"]],"(":[[57,"VK_9"]]},shiftOff:{0:[[48,"VK_0"]],1:[[49,"VK_1"]],2:[[50,"VK_2"]],3:[[51,"VK_3"]],4:[[52,"VK_4"]],5:[[53,"VK_5"]],6:[[54,"VK_6"]],7:[[55,"VK_7"]],8:[[56,"VK_8"]],9:[[57,"VK_9"]]},other:{Left:[[37,"VK_LEFT"]],Up:[[38,"VK_UP"]],Right:[[39,"VK_RIGHT"]],Down:[[40,"VK_DOWN"]],Shift:[[16,"VK_SHIFT"]],Backspace:[[27,"VK_ESCAPE"],[8,"VK_BACK","VK_HID_BACK","VK_HID_BACK"]],Enter:[[13,"VK_ENTER"]],Space:[[32,"VK_SPACE"]],Delete:[[46,"VK_DELETE"]],A:[[65,"VK_A"]],B:[[66,"VK_B"]],C:[[67,"VK_C"]],D:[[68,"VK_D"]],E:[[69,"VK_E"]],F:[[70,"VK_F"]],G:[[71,"VK_G"]],H:[[72,"VK_H"]],I:[[73,"VK_I"]],J:[[74,"VK_J"]],K:[[75,"VK_K"]],L:[[76,"VK_L"]],M:[[77,"VK_M"]],N:[[78,"VK_N"]],O:[[79,"VK_O"]],P:[[80,"VK_P"]],Q:[[81,"VK_Q"]],R:[[82,"VK_R"]],S:[[83,"VK_S"]],T:[[84,"VK_T"]],U:[[85,"VK_U"]],V:[[86,"VK_V"]],W:[[87,"VK_W"]],X:[[88,"VK_X"]],Y:[[89,"VK_Y"]],Z:[[90,"VK_Z"]],F1:[[112,"VK_F1"]],F2:[[113,"VK_F2"]],F3:[[114,"VK_F3"]],F4:[[115,"VK_F4"]],F5:[[116,"VK_F5"]],F6:[[117,"VK_F6"]],F7:[[118,"VK_F7"]],F8:[[119,"VK_F8"]],F9:[[120,"VK_F9"]],F10:[[121,"VK_F10"]],F11:[[122,"VK_F11"]],F12:[[123,"VK_F12"]],Num0:[[96,"VK_NUMPAD0"]],Num1:[[97,"VK_NUMPAD1"]],Num2:[[98,"VK_NUMPAD2"]],Num3:[[99,"VK_NUMPAD3"]],Num4:[[100,"VK_NUMPAD4"]],Num5:[[101,"VK_NUMPAD5"]],Num6:[[102,"VK_NUMPAD6"]],Num7:[[103,"VK_NUMPAD7"]],Num8:[[104,"VK_NUMPAD8"]],Num9:[[105,"VK_NUMPAD9"]],Control:[[17,"VK_CONTROL"]],Red:[403],Green:[404],Yellow:[405],Blue:[406]}}),TGH5.keyMapperLib.hopperKeyMap=t,TGH5.keyMapperLib.plugins.Hopper=function(n,r,i){var s,o=!1;e.addListeners(t,n,r,16),s=function(e){window.history.state!=="backhandler"&&(n(TGH5.keyMapperLib.keyNames.KEY_BACKSPACE),r(TGH5.keyMapperLib.keyNames.KEY_BACKSPACE),window.history.pushState("backhandler",null,null))},this.popStateHandling=function(e){if(e==o)return;e?(window.history.pushState("backhandler",null,null),window.addEventListener("popstate",s,!1)):(window.removeEventListener("popstate",s,!1),history.back()),o=e},i()}}(),TGH5=TGH5||{},function(){var e,t;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=TGH5.keyMapperLib.utils,t=e.prepareIndexedKeyMap({shiftOn:{")":[[48,"VK_0"]],"!":[[49,"VK_1"]],"@":[[50,"VK_2"]],"#":[[51,"VK_3"]],$:[[52,"VK_4"]],"%":[[53,"VK_5"]],"^":[[54,"VK_6"]],"&":[[55,"VK_7"]],"*":[[56,"VK_8"]],"(":[[57,"VK_9"]]},shiftOff:{0:[[48,"VK_0"]],1:[[49,"VK_1"]],2:[[50,"VK_2"]],3:[[51,"VK_3"]],4:[[52,"VK_4"]],5:[[53,"VK_5"]],6:[[54,"VK_6"]],7:[[55,"VK_7"]],8:[[56,"VK_8"]],9:[[57,"VK_9"]]},other:{Left:[[37,"VK_LEFT"]],Up:[[38,"VK_UP"]],Right:[[39,"VK_RIGHT"]],Down:[[40,"VK_DOWN"]],Shift:[[16,"VK_SHIFT"]],Backspace:[[27,"VK_ESCAPE"],[8,"VK_BACK","VK_HID_BACK","VK_HID_BACK"]],Enter:[[13,"VK_ENTER"]],Space:[[32,"VK_SPACE"]],Delete:[[46,"VK_DELETE"]],Control:[[17,"VK_CONTROL"]],Red:[403],Green:[404],Yellow:[405],Blue:[406],Forward:[228],Rewind:[227],Play:[179],Menu:[18]}}),TGH5.keyMapperLib.firetvKeyMap=t,TGH5.keyMapperLib.plugins.FireTV=function(n,r,i){var s,o=!1;e.addListeners(t,n,r,16),s=function(e){window.history.state!=="backhandler"&&(n(TGH5.keyMapperLib.keyNames.KEY_BACKSPACE),r(TGH5.keyMapperLib.keyNames.KEY_BACKSPACE),window.history.pushState("backhandler",null,null))},this.popStateHandling=function(e){if(e==o)return;e?(window.history.pushState("backhandler",null,null),window.addEventListener("popstate",s,!1)):(window.removeEventListener("popstate",s,!1),history.back()),o=e},i()}}(),TGH5=TGH5||{},function(){var e,t;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=TGH5.keyMapperLib.utils,t=e.prepareIndexedKeyMap({shiftOn:{},shiftOff:{0:[[48,"VK_0"]],1:[[49,"VK_1"]],2:[[50,"VK_2"]],3:[[51,"VK_3"]],4:[[52,"VK_4"]],5:[[53,"VK_5"]],6:[[54,"VK_6"]],7:[[55,"VK_7"]],8:[[56,"VK_8"]],9:[[57,"VK_9"]],Left:[[37,"VK_LEFT"]],Up:[[38,"VK_UP"]],Right:[[39,"VK_RIGHT"]],Down:[[40,"VK_DOWN"]]},other:{Backspace:[[8,"VK_BACK_SPACE"],[461,"VK_BACK"]],Enter:[[13,"VK_ENTER"]]}}),TGH5.keyMapperLib.plugins.Opera=function(n,r,i){e.addListeners(t,n,r,null),i()}}(),TGH5=TGH5||{},function(){function i(n,r){var i={};!e&&window.Common&&window["Common.API"]&&window["Common.API.TVKeyValue"]&&(i=new Common.API.TVKeyValue),keyMap=t.prepareIndexedKeyMap({shiftOn:{")":[41,48,i.KEY_0],"!":[33,49,i.KEY_1],"@":[64,50,i.KEY_2],"#":[35,51,i.KEY_3],$:[36,52,i.KEY_4],"%":[37,53,i.KEY_5],"^":[94,54,i.KEY_6],"&":[38,55,i.KEY_7],"*":[42,56,i.KEY_8],"(":[40,57,i.KEY_9]},shiftOff:{0:[48,17,i.KEY_0],1:[49,101,i.KEY_1],2:[50,98,i.KEY_2],3:[51,6,i.KEY_3],4:[52,8,i.KEY_4],5:[53,9,i.KEY_5],6:[54,10,i.KEY_6],7:[55,12,i.KEY_7],8:[56,13,i.KEY_8],9:[57,14,i.KEY_9],Left:[37,4,i.KEY_LEFT],Up:[38,29460,i.KEY_UP],Right:[39,5,i.KEY_RIGHT],Down:[40,29461,i.KEY_DOWN],Red:[403,108,i.KEY_RED],Blue:[406,22,i.KEY_BLUE],Green:[404,20,i.KEY_GREEN],Yellow:[405,21,i.KEY_YELLOW],Info:[457,31,i.KEY_INFO],Play:[415,19],Forward:[417],Rewind:[412]},other:{Backspace:[10009,8,88,i.KEY_RETURN],Enter:[13,29443,i.KEY_ENTER],Exit:[10182,45,i.KEY_EXIT]}}),t.addListeners(keyMap,n,r,null)}function s(t,s,o){var u,a,f=Date.now();e?(i(t,s),o()):(u=document.createElement("script"),u.type="text/javascript",u.async=!0,u.src=n,document.body.appendChild(u),a=setInterval(function(){a&&Date.now()-f>r?(clearInterval(a),a=null,i(t,s),o()):a&&typeof window.Common!="undefined"&&typeof window.Common.API!="undefined"&&window.Common.API.TVKeyValue!=="undefined"&&(clearInterval(a),a=null,i(t,s),o())},100))}var e,t,n,r;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=(navigator.userAgent||"").toLocaleLowerCase().indexOf("tizen")>0,t=TGH5.keyMapperLib.utils,n="$MANAGER_WIDGET/Common/API/TVKeyValue.js",r=5e3,TGH5.keyMapperLib.plugins.Samsung=function(e,t,n,r){s(e,t,n,r)}}(),TGH5=TGH5||{},function(){var e,t;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=TGH5.keyMapperLib.utils,t=e.prepareIndexedKeyMap({shiftOn:{")":[41,[48,"VK_0"]],"!":[33,[49,"VK_1"]],"@":[222,64,34,[50,"VK_2"]],"#":[35,163,[51,"VK_3"]],$:[36,[52,"VK_4"]],"%":[37,[53,"VK_5"]],"^":[94,[54,"VK_6"]],"&":[38,[55,"VK_7"]],"*":[42,[56,"VK_8"]],"(":[40,[57,"VK_9"]]},shiftOff:{"@":[64],"!":[33],0:[[48,"VK_0"]],1:[[49,"VK_1"]],2:[[50,"VK_2"]],3:[[51,"VK_3"]],4:[[52,"VK_4"]],5:[[53,"VK_5"]],6:[[54,"VK_6"]],7:[[55,"VK_7"]],8:[[56,"VK_8"]],9:[[57,"VK_9"]],Left:[37],Up:[38],Right:[39],Down:[40]},other:{Shift:[[16,"VK_SHIFT"]],Esc:[[27,"VK_ESCAPE"]],Backspace:[8,461,3,"VK_BACK","VK_HID_BACK","VK_HID_BACK"],Enter:[[13,"VK_ENTER"]],Space:[[32,"VK_SPACE"]],Delete:[[46]],A:[97,[65,"VK_A"]],B:[98,[66,"VK_B"]],C:[99,[67,"VK_C"]],D:[100,[68,"VK_D"]],E:[101,[69,"VK_E"]],F:[102,[70,"VK_F"]],G:[103,[71,"VK_G"]],H:[104,[72,"VK_H"]],I:[105,[73,"VK_I"]],J:[106,[74,"VK_J"]],K:[107,[75,"VK_K"]],L:[108,[76,"VK_L"]],M:[109,[77,"VK_M"]],N:[110,[78,"VK_N"]],O:[111,[79,"VK_O"]],P:[112,[80,"VK_P"]],Q:[113,[81,"VK_Q"]],R:[114,[82,"VK_R"]],S:[115,[83,"VK_S"]],T:[116,[84,"VK_T"]],U:[117,[85,"VK_U"]],V:[118,[86,"VK_V"]],W:[119,[87,"VK_W"]],X:[120,[88,"VK_X"]],Y:[121,[89,"VK_Y"]],Z:[122,[90,"VK_Z"]],Red:[403],Green:[404],Yellow:[405],Blue:[406],Info:[156,457],Play:[415,19,402],Skip:[424,425],Search:[170],Subtitles:[460],AudioDesc:[464,57347],Forward:[417],Rewind:[412],Stop:[413],Exit:[27]}}),TGH5.keyMapperLib.philipsKeyMap=t,TGH5.keyMapperLib.plugins.Philips=function(n,r,i){e.addListeners(t,n,r,16),i()}}(),__tgh5_block_popstate_event=!0,window.addEventListener("load",function(){setTimeout(function(){__tgh5_block_popstate_event=!1},4)},!1),TGH5=TGH5||{},function(){var e,t;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=TGH5.keyMapperLib.utils,t=e.prepareIndexedKeyMap({shiftOn:{")":[41,[48,"VK_0"]],"!":[33,[49,"VK_1"]],"@":[64,[50,"VK_2"]],"#":[35,[51,"VK_3"]],$:[36,[52,"VK_4"]],"%":[37,[53,"VK_5"]],"^":[94,[54,"VK_6"]],"&":[38,[55,"VK_7"]],"*":[42,[56,"VK_8"]],"(":[40,[57,"VK_9"]]},shiftOff:{0:[48,"VK_0"],1:[49,"VK_1"],2:[50,"VK_2"],3:[51,"VK_3"],4:[52,"VK_4"],5:[53,"VK_5"],6:[54,"VK_6"],7:[55,"VK_7"],8:[56,"VK_8"],9:[57,"VK_9"],Left:[37,"VK_LEFT"],Up:[38,"VK_UP"],Right:[39,"VK_RIGHT"],Down:[40,"VK_DOWN"],Play:[415,19],Forward:[417],Rewind:[412],Info:[457]},other:{Shift:[[16,"VK_SHIFT"]],Esc:[[27,"VK_ESCAPE"]],Backspace:[[461,"VK_BACK"],[8,"VK_HID_BACK"]],Enter:[[13,"VK_ENTER"]],Space:[[32,"VK_SPACE"]],Delete:[[46,"VK_DELETE"]],A:[97,[65,"VK_A"]],B:[98,[66,"VK_B"]],C:[99,[67,"VK_C"]],D:[100,[68,"VK_D"]],E:[101,[69,"VK_E"]],F:[102,[70,"VK_F"]],G:[103,[71,"VK_G"]],H:[104,[72,"VK_H"]],I:[105,[73,"VK_I"]],J:[106,[74,"VK_J"]],K:[107,[75,"VK_K"]],L:[108,[76,"VK_L"]],M:[109,[77,"VK_M"]],N:[110,[78,"VK_N"]],O:[111,[79,"VK_O"]],P:[112,[80,"VK_P"]],Q:[113,[81,"VK_Q"]],R:[114,[82,"VK_R"]],S:[115,[83,"VK_S"]],T:[116,[84,"VK_T"]],U:[117,[85,"VK_U"]],V:[118,[86,"VK_V"]],W:[119,[87,"VK_W"]],X:[120,[88,"VK_X"]],Y:[121,[89,"VK_Y"]],Z:[122,[90,"VK_Z"]],Red:[403],Green:[404],Yellow:[405],Blue:[406]}}),TGH5.keyMapperLib.plugins.LG=function(n,r,i){var s=!1,o=function(e){if(__tgh5_block_popstate_event)return;e.preventDefault(),n(TGH5.keyMapperLib.keyNames.KEY_BACKSPACE),r(TGH5.keyMapperLib.keyNames.KEY_BACKSPACE),history.pushState({tgh5_tag:!0},"tgh5")};this.popStateHandling=function(e){if(e==s)return;e?(history.pushState({tgh5_tag:!0},"tgh5"),window.addEventListener("popstate",o,!1)):(window.removeEventListener("popstate",o,!1),history.back()),s=e},e.addListeners(t,n,r,16),i()}}(),TGH5=TGH5||{},function(){var e,t;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=TGH5.keyMapperLib.utils,t=e.prepareIndexedKeyMap({shiftOn:{")":[48,"VK_0"],"!":[49,"VK_1"],"@":[50,"VK_2"],"#":[51,"VK_3"],$:[52,"VK_4"],"%":[53,"VK_5"],"^":[54,"VK_6"],"&":[55,"VK_7"],"*":[56,"VK_8"],"(":[57,"VK_9"]},shiftOff:{0:[48,"VK_0"],1:[49,"VK_1"],2:[50,"VK_2"],3:[51,"VK_3"],4:[52,"VK_4"],5:[53,"VK_5"],6:[54,"VK_6"],7:[55,"VK_7"],8:[56,"VK_8"],9:[57,"VK_9"]},other:{Left:[37,"VK_LEFT"],Up:[38,"VK_UP"],Right:[39,"VK_RIGHT"],Down:[40,"VK_DOWN"],Shift:[16,"VK_SHIFT"],Esc:[27,"VK_ESCAPE"],Backspace:[461,3,8,"VK_BACK"],Enter:[13,"VK_ENTER"],Space:[32,"VK_SPACE"],Delete:[127,46,"VK_DELETE"],A:[65,"VK_A"],B:[66,"VK_B"],C:[67,"VK_C"],D:[68,"VK_D"],E:[69,"VK_E"],F:[70,"VK_F"],G:[71,"VK_G"],H:[72,"VK_H"],I:[73,"VK_I"],J:[74,"VK_J"],K:[75,"VK_K"],L:[76,"VK_L"],M:[77,"VK_M"],N:[78,"VK_N"],O:[79,"VK_O"],P:[80,"VK_P"],Q:[81,"VK_Q"],R:[82,"VK_R"],S:[83,"VK_S"],T:[84,"VK_T"],U:[85,"VK_U"],V:[86,"VK_V"],W:[87,"VK_W"],X:[88,"VK_X"],Y:[89,"VK_Y"],Z:[90,"VK_Z"]}}),TGH5.keyMapperLib.plugins.LGI=function(n,r,i){e.addListeners(t,n,r,16),i()}}(),TGH5=TGH5||{},function(){var e,t;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=TGH5.keyMapperLib.utils,t=e.prepareIndexedKeyMap({shiftOn:{")":[48,"VK_0"],"!":[49,"VK_1"],"@":[50,"VK_2"],"#":[51,"VK_3"],$:[52,"VK_4"],"%":[53,"VK_5"],"^":[54,"VK_6"],"&":[55,"VK_7"],"*":[56,"VK_8"],"(":[57,"VK_9"]},shiftOff:{0:[48,"VK_0"],1:[49,"VK_1"],2:[50,"VK_2"],3:[51,"VK_3"],4:[52,"VK_4"],5:[53,"VK_5"],6:[54,"VK_6"],7:[55,"VK_7"],8:[56,"VK_8"],9:[57,"VK_9"]},other:{Left:[37,"VK_LEFT"],Up:[38,"VK_UP"],Right:[39,"VK_RIGHT"],Down:[40,"VK_DOWN"],Shift:[16,"VK_SHIFT"],Backspace:[27,461,3,8,"VK_BACK"],Enter:[13,"VK_ENTER"],Space:[32,"VK_SPACE"],Delete:[127,46,"VK_DELETE"],A:[65,"VK_A"],B:[66,"VK_B"],C:[67,"VK_C"],D:[68,"VK_D"],E:[69,"VK_E"],F:[70,"VK_F"],G:[71,"VK_G"],H:[72,"VK_H"],I:[73,"VK_I"],J:[74,"VK_J"],K:[75,"VK_K"],L:[76,"VK_L"],M:[77,"VK_M"],N:[78,"VK_N"],O:[79,"VK_O"],P:[80,"VK_P"],Q:[81,"VK_Q"],R:[82,"VK_R"],S:[83,"VK_S"],T:[84,"VK_T"],U:[85,"VK_U"],V:[86,"VK_V"],W:[87,"VK_W"],X:[88,"VK_X"],Y:[89,"VK_Y"],Z:[90,"VK_Z"]}}),TGH5.keyMapperLib.plugins.LIGHTNING=function(n,r,i){e.addListeners(t,n,r,16),i()}}(),TGH5=TGH5||{},function(){var e,t;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=TGH5.keyMapperLib.utils,t=e.prepareIndexedKeyMap({shiftOff:{0:[[48]],1:[[49]],2:[[50]],3:[[51]],4:[[52]],5:[[53]],6:[[54]],7:[[55]],8:[[56]],9:[[57]]},other:{Info:[[457]],Left:[[37]],Up:[[38]],Right:[[39]],Down:[[40]],Enter:[[13]],Exit:[[403],[8]],Blue:[[406]],Green:[[404]],Yellow:[[405]]}}),TGH5.keyMapperLib.plugins.TiVo=function(n,r,i){e.addListeners(t,n,r,-1),i()}}(),TGH5=TGH5||{},function(){var e,t;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=TGH5.keyMapperLib.utils,t=e.prepareIndexedKeyMap({shiftOn:{},shiftOff:{0:[[48,"VK_0"]],1:[[49,"VK_1"]],2:[[50,"VK_2"]],3:[[51,"VK_3"]],4:[[52,"VK_4"]],5:[[53,"VK_5"]],6:[[54,"VK_6"]],7:[[55,"VK_7"]],8:[[56,"VK_8"]],9:[[57,"VK_9"]]},other:{Left:[[37,"VK_LEFT"]],Up:[[38,"VK_UP"]],Right:[[39,"VK_RIGHT"]],Down:[[40,"VK_DOWN"]],Backspace:[[4,8,"VK_BACK","VK_HID_BACK","VK_HID_BACK"]],Enter:[[13,"VK_ENTER"]],Red:[81],Green:[87],Yellow:[69],Blue:[82]}}),TGH5.keyMapperLib.plugins.Mini4k=function(n,r,i){e.addListeners(t,n,r,null),i()}}(),TGH5=TGH5||{},function(){var e,t;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=TGH5.keyMapperLib.utils,t=e.prepareIndexedKeyMap({shiftOn:{},shiftOff:{0:[48],1:[49],2:[50],3:[51],4:[52],5:[53],6:[54],7:[55],8:[56],9:[57]},other:{Left:[37],Up:[38],Right:[39],Down:[40],Backspace:[46,8],Enter:[13],Info:[79]}}),TGH5.keyMapperLib.plugins.DTV=function(n,r,i){window.onkeydown=function(r){var i=r.keyCode,s=e.getKeyNameByKeyCode(t,i,!1);return n(s),!1},window.onkeyup=function(n){var i=n.keyCode,s=e.getKeyNameByKeyCode(t,i,!1);return r(s),!1},i()}}(),TGH5=TGH5||{},function(){var e,t;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=TGH5.keyMapperLib.utils,t=e.prepareIndexedKeyMap({shiftOn:{},shiftOff:{0:[48],1:[49],2:[50],3:[51],4:[52],5:[53],6:[54],7:[55],8:[56],9:[57]},other:{Left:[37],Up:[38],Right:[39],Down:[40],Backspace:[461,8],Enter:[13]}}),TGH5.keyMapperLib.plugins.Jio=function(n,r,i){e.addListeners(t,n,r,16),i()}}(),TGH5=TGH5||{},function(){var e,t;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=TGH5.keyMapperLib.utils,t=e.prepareIndexedKeyMap({shiftOn:{},shiftOff:{0:[48,"VK_0"],1:[49,"VK_1"],2:[50,"VK_2"],3:[51,"VK_3"],4:[52,"VK_4"],5:[53,"VK_5"],6:[54,"VK_6"],7:[55,"VK_7"],8:[56,"VK_8"],9:[57,"VK_9"]},other:{Left:[37,"VK_LEFT",65,"VK_A"],Up:[38,"VK_UP",87,"VK_W"],Right:[39,"VK_RIGHT",68,"VK_D"],Down:[40,"VK_DOWN",83,"VK_S"],Backspace:[4,8,"VK_BACK","VK_HID_BACK","VK_HID_BACK",27,"VK_ESCAPE"],Enter:[13,"VK_ENTER",32,"VK_SPACE"]}}),TGH5.keyMapperLib.plugins.GD=function(n,r,i){e.addListeners(t,n,r,null),i()}}(),TGH5=TGH5||{},function(){var e,t;TGH5.keyMapperLib.plugins=TGH5.keyMapperLib.plugins||{},e=TGH5.keyMapperLib.utils,t=e.prepareIndexedKeyMap({shiftOff:{0:[48],1:[49],2:[50],3:[51],4:[52],5:[53],6:[54],7:[55],8:[56],9:[57]},other:{Info:[457,113],Left:[37],Up:[38],Right:[39],Down:[40],Backspace:[27,8],Enter:[13],Play:[179],Forward:[228],Rewind:[227],Red:[403],Green:[404],Yellow:[405],Blue:[406]}}),TGH5.keyMapperLib.plugins.Sky=function(n,r,i){e.addListeners(t,n,r,-1),i()}}(),function(){var e="generic",t=TGH5.keyMapperLib.utils,n={generic:TGH5.keyMapperLib.plugins.Generic,hopper:TGH5.keyMapperLib.plugins.Hopper,firetv:TGH5.keyMapperLib.plugins.FireTV,samsung:TGH5.keyMapperLib.plugins.Samsung,opera:TGH5.keyMapperLib.plugins.Opera,philips:TGH5.keyMapperLib.plugins.Philips,lg:TGH5.keyMapperLib.plugins.LG,mobilebus:TGH5.keyMapperLib.plugins.Mobilebus,lgi:TGH5.keyMapperLib.plugins.LGI,lightning:TGH5.keyMapperLib.plugins.LIGHTNING,tivo:TGH5.keyMapperLib.plugins.TiVo,mini4k:TGH5.keyMapperLib.plugins.Mini4k,dtv:TGH5.keyMapperLib.plugins.DTV,jio:TGH5.keyMapperLib.plugins.Jio,gd:TGH5.keyMapperLib.plugins.GD,sky:TGH5.keyMapperLib.plugins.Sky};TGH5.keyMapperLib.KeyMapper=function(r,i){function a(t,r){return new n[t](s,o,function(){u.isKeyMapperReady=!0,r&&r.call(u)},function(){t!==e&&(u.pluginInstance=a(e,r))})}var s,o,u=this;this.isEnabled=!0,this.keyDownListeners=[],this.keyUpListeners=[],this.isKeyMapperReady=!1,s=t.bind(this.internalKeyDownListener,this),o=t.bind(this.internalKeyUpListener,this),this.pluginInstance=a(r,i)},TGH5.keyMapperLib.KeyMapper.prototype={internalKeyDownListener:function(e){var t,n,r;if(this.isEnabled){t=this.keyDownListeners;for(n=t.length,r=0;r<n;r++)t[r].listener.call(t[r].thisArg,e);return!1}return!0},internalKeyUpListener:function(e){var t,n,r;if(this.isEnabled){t=this.keyUpListeners;for(n=t.length,r=0;r<n;r++)t[r].listener.call(t[r].thisArg,e);return!1}return!0},enableKeyInput:function(){this.isEnabled=!0},disableKeyInput:function(){this.isEnabled=!1,TGH5.keyMapperLib.utils.simulateRepeatStop()},popStateHandling:function(e){typeof this.pluginInstance.popStateHandling=="function"&&this.pluginInstance.popStateHandling(e)},addKeyDownListener:function(e,t){this.removeKeyDownListener(e),this.keyDownListeners.push({listener:e,thisArg:t})},removeKeyDownListener:function(e){var t;for(t=this.keyDownListeners.length-1;t>=0;t--)if(this.keyDownListeners[t].listener===e){this.keyDownListeners.splice(t,1);return}},addKeyUpListener:function(e,t){this.removeKeyUpListener(e),this.keyUpListeners.push({listener:e,thisArg:t})},removeKeyUpListener:function(e){var t;for(t=this.keyUpListeners.length-1;t>=0;t--)if(this.keyUpListeners[t].listener===e){this.keyUpListeners.splice(t,1);return}},isReady:function(){return this.isKeyMapperReady}}}();var PWAD;(function(e){var t,n,r=function(){function e(e,t){this.code=e,this.message=t}return e.isErrorClass=function(e){return e&&e.code&&typeof e.setAdditionalInfo=="function"},e.prototype.toString=function(){var e="#"+this.code;return this.infoString&&(e+=":"+this.infoString),e+=":"+this.message,e},e.prototype.duplicate=function(){return new e(this.code,this.message)},e.prototype.extendByInfo=function(e){if(!e)return this;var t=this.duplicate();return t.setAdditionalInfo(e),t},e.prototype.isEqual=function(e){return this.code==e.code},e.prototype.setAdditionalInfo=function(e){this.infoString=e},e}();e.Error=r,t=function(){function e(){}return e.e100=new r(100,"XML parsing error."),e.e101=new r(101,"VAST schema validation error."),e.e102=new r(102,"VAST version of response not supported."),e.e200=new r(200,"Trafficking error. Video player received an Ad type that it was not expecting and/or cannot display."),e.e201=new r(201,"Video player expecting different linearity."),e.e202=new r(202,"Video player expecting different duration."),e.e203=new r(203,"Video player expecting different size."),e.e300=new r(300,"General Wrapper error."),e.e301=new r(301,"Timeout of VAST URI provided in Wrapper element, or of VAST URI provided in a subsequent Wrapper element."),e.e302=new r(302,"Wrapper limit reached, as defined by the video player."),e.e303=new r(303,"No Ads VAST response after one or more Wrappers."),e.e400=new r(400,"General Linear error. Video player is unable to display the Linear Ad."),e.e401=new r(401,"File not found. Unable to find Linear/MediaFile from URI."),e.e402=new r(402,"Timeout of MediaFile URI."),e.e403=new r(403,"Couldn't find MediaFile that is supported by this video player, based on the attributes of the MediaFile element."),e.e405=new r(405,"Problem displaying MediaFile. Video player found a MediaFile with supported type but couldn't display it."),e.e500=new r(500,"General NonLinearAds error."),e.e501=new r(501,"Unable to display NonLinear Ad because creative dimensions do not align with creative display area"),e.e502=new r(502,"Unable to fetch NonLinearAds/NonLinear resource."),e.e503=new r(503,"Couldn't find NonLinear resource with supported type."),e.e600=new r(600,"General CompanionAds error."),e.e601=new r(601,"Unable to display Companion because creative dimensions do not fit within Companion display area (i.e., no available space)."),e.e602=new r(602,"Unable to display Required Companion."),e.e603=new r(603,"Unable to fetch CompanionAds/Companion resource."),e.e604=new r(604,"Couldn't find Companion resource with supported type."),e.e900=new r(900,"Undefined Error."),e.e901=new r(901,"General VPAID error."),e.e1000=new r(1e3,"Error processing AJAX call to retrieve adTag"),e.e1001=new r(1001,"Invalid input for loadAds method"),e.e1002=new r(1002,"Required DOMParser API is not available"),e.e1003=new r(1003,"Could not get source for content player"),e.e1004=new r(1004,"Could not find vast player in DOM"),e.e1005=new r(1005,"Ad video to short"),e.e1006=new r(1006,"Ad video to long"),e.e1007=new r(1007,"Video started but no timeupdate called"),e.noImplementation=new r(1e5,"No implementation"),e}(),e.VastErrors=t,n=function(){function e(){}return e.maxVideoDuration=function(t){return new r(e.MAX_VIDEO_DURATION.code,e.MAX_VIDEO_DURATION.message.replace("[time]",""+t))},e.runtime=function(e){return new r(8e3,"Runtime error: "+e.name+":"+e.message+", "+e.stack)},e.AJAX_TIMEOUT=new r(2e3,"XMLHttpRequest timeout"),e.AJAX_INVALID_STATUS=new r(2001,"Failed request data"),e.AJAX_EMPTY=new r(2002,"Empty ajax response"),e.WATERFALL_TIMEOUT=new r(2003,"Waterfall timeout"),e.PLAYER_VIDEO_TIMEOUT=new r(2004,"Ad player video start timeout"),e.MAX_VIDEO_DURATION=new r(2005,"Ad video playing exceeds [time] seconds"),e.MIXED_CONTENT_NOT_SUPPORTED=new r(2006,"Mixed content not supported"),e.FAILED_START_EVENT_TRACKING=new r(2007,"Tracking start event sending is failed"),e.FAILED_CONVERT_VIDEO=new r(2008,"Fail to convert video"),e.CONVERT_VIDEO_NOT_CACHED=new r(2009,"Not found converted video in cache"),e}(),e.Errors=n})(PWAD||(PWAD={})),function(e){var t=function(){function t(){}return t.ajaxPost=function(e,t){try{var n=new XMLHttpRequest;n.open("POST",e,!0),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.send(JSON.stringify(t))}catch(r){}},t.ajaxPostResponse=function(t,n,r,i){try{var s=new XMLHttpRequest;s.open("POST",t,!0),s.setRequestHeader("Content-Type","application/json;charset=UTF-8"),s.onreadystatechange=function(){s.readyState==4&&(s.status>=200&&s.status<300?r(s.responseText):i(e.Errors.AJAX_INVALID_STATUS))},s.send(JSON.stringify(n))}catch(o){}},t.isMixedContentRequest=function(e,t){try{if(t===!1&&e&&e.indexOf("//")!=0&&e.split(":")[0]!=location.protocol.split(":")[0])return!0}catch(n){return!1}return!1},t.ajax=function(n,r,i,s,o,u){try{if(t.isMixedContentRequest(n,s)){u(e.Errors.MIXED_CONTENT_NOT_SUPPORTED);return}var a=new XMLHttpRequest,f=!1,l=null;a.open("GET",n,!0),i&&(a.withCredentials=!0),a.onreadystatechange=function(){l!==null&&(clearTimeout(l),l=null);if(a.readyState==4){if(f)return;a.status>=200&&a.status<300?o(a.responseText):u(e.Errors.AJAX_INVALID_STATUS)}},t.isNumber(r)&&(l=setTimeout(function(){f=!0,clearTimeout(l),l=null,u(e.Errors.AJAX_TIMEOUT)},r)),a.send(null)}catch(c){u(e.Errors.runtime(c))}},t.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"},t.sliceArray=function(e,t,n){t===void 0&&(t=0),n===void 0&&(n=e.length);var r=Array(n-t);for(var i=t;i<n;i++)r[i]=e[i];return r},t.isObject=function(e){return typeof e=="object"&&e instanceof Object&&!(e instanceof Array)},t.updateMacro=function(e,t,n){while(e.indexOf(t)>=0)e=e.replace(t,n);return e},t.getDurationNodeValue=function(e){if(!e)return null;var n=t.getNodeValue(e,!1);if(n){var r=n.split(":");if(r.length===3){var i=Number(r[0])*3600+Number(r[1])*60+Number(r[2]);if(t.isNumber(i))return i}}return null},t.loadScript=function(e,t,n){var r=document.createElement("script");e.indexOf("?")>0?e+="&":e+="?",e+="cb="+(Math.random()*1e7|0),r.onload=function(){t()},r.onerror=function(){n()},r.src=e,document.body.appendChild(r)},t.getNodeValue=function(e,t){var n=e.childNodes,r="";for(var i=0,s=n.length;i<s;i++)n[i]&&n[i].textContent&&(r+=n[i].textContent.trim());if(r){var o=/^<!\[CDATA\[.*\]\]>$/i;o.test(r)&&(r=r.replace("<![CDATA[","").replace("]]>",""));if(!t)return r;var u=/^(https?:)?\/\//i;if(u.test(r))return r}return null},t.isNumber=function(e){return typeof e=="number"&&!isNaN(e)},t.generateCacheBusting=function(){var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<8;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},t.RFC3986EncodeURIComponent=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)})},t.vastReadableTime=function(e){if(t.isNumber(e)&&e>=0){var n=0,r=0,i=0,s=Math.floor(e%1e3);return s===0?s="000":s<10?s="00"+s:s<100?s="0"+s:s=s+"",n=Math.floor(e*1/1e3),n>59&&(r=Math.floor(n*1/60),n-=r*60),n===0?n="00":n<10?n="0"+n:n=n+"",r>59&&(i=Math.floor(r*1/60),r-=i*60),r===0?r="00":r<10?r="0"+r:r=r+"",i===0?i="00":i<10?i="0"+i:i>23?i="00":i=i+"",i+":"+r+":"+n+"."+s}return"00:00:00.000"},t.getBandwidthEstimate=function(){return 1.4},t.getLaunchParameter=function(e,t){if(!e)return null;var n=e.split("?");if(n.length!==2)return null;var r=n[1].split("&");for(var i=0;i<r.length;i++){var s=r[i].split("=");if(s.length===2&&s[0]==t)return s[1]}return null},t}();e.Utils=t}(PWAD||(PWAD={})),function(e){var t,n=function(){function e(){this._callbacks=[]}return e.prototype.add=function(e){this._callbacks.indexOf(e)<0&&this._callbacks.push(e)},e.prototype.dispatch=function(e){for(var t=0;t<this._callbacks.length;t++)this._callbacks[t].apply(null,e)},e.prototype.removeAll=function(){this._callbacks=[]},e.prototype.remove=function(e){if(!e)return;for(var t=0;t<this._callbacks.length;t++)this._callbacks[t]===e&&(this._callbacks.splice(t,1),t--)},e}();e.Listener=n,t=function(){function e(e){var t=this;this._listeners={},e.forEach(function(e){t._listeners[e]=new n})}return e.prototype.add=function(e,t){this._listeners[e]&&this._listeners[e].add(t)},e.prototype.dispatch=function(e){var t=[];for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];this._listeners[e].dispatch(t)},e.prototype.removeAll=function(){for(var e in this._listeners){if(!this._listeners.hasOwnProperty(e))continue;typeof this._listeners[e].removeAll=="function"&&this._listeners[e].removeAll()}},e.prototype.remove=function(e,t){this._listeners[e]&&this._listeners[e].remove(t)},e}(),e.Dispatcher=t}(PWAD||(PWAD={})),function(e){var t={UP:38,LEFT:37,RIGHT:39,DOWN:40,ENTER:13,BACK:8},n=function(){function n(){this.waterfallErrorTimeout=2e4,this.videoStartErrorTimeout=2e4,this.delayAfterWaterfallTimeout=2e4,this.preload={enabled:!1,vastRequestDelay:3e3,waterfallFrequency:2e4},this.serverMode={enabled:!1,url:"https://ads.play.works"},this.providers=[],this.adParser={ajaxWithCredentials:!1,mixedHTTPProtocol:!0,ajaxTimeout:19e3,maxNumItemsInAdPod:10,maxNumRedirects:4,minVideoDuration:2,maxVideoDuration:-1,convert:{enabled:!1},iAds:{enabled:!0,drivers:{innovid:{enabled:!0,name:"innovid",className:"InnovidPlayerDriver",keyMap:t},trueX:{enabled:!0,name:"trueX",className:"TrueXPlayerDriver",sdkLibURL:"//cdn.jsdelivr.net/npm/@truex/ctv-ad-renderer@1",keyMap:t},brightline:{enabled:!0,name:"brightline",className:"BrightlinePlayerDriver",sdkLibURL:"//cdn-media.brightline.tv/products/master/playworks/assets/js/brightline.webkit.sdk.2.1.2.min.js"}}},testCommonVideoFormats:["video/mp4"],pingEvents:["impression","creativeView","loaded","start","firstQuartile","midpoint","thirdQuartile","complete","mute","unmute","pause","resume","fullscreen","exitFullscreen","skip","progress","clickthrough","close","collapse","acceptInvitation"]},this.log={debug:!1,log:!1},this.player={videoContainerId:"",maxVideoDurationSeconds:-1,width:1280,height:720,x:0,y:0,trackImpressionAfterStart:!1,delayBeforePlay:0,showCoverScreenBeforePlay:!1}}return n.prototype.init=function(t,n,r){var i=function(t,n){for(var r in t){if(!t.hasOwnProperty(r))continue;e.Utils.isObject(t[r])?(typeof n[r]=="undefined"&&(n[r]={}),i(t[r],n[r])):e.Utils.isArray(t[r])?(typeof n[r]=="undefined"&&(n[r]=[]),i(t[r],n[r])):n[r]=t[r]}};i(t,this),r&&this.serverMode&&this.serverMode.enabled&&!this.serverMode.platform&&(this.serverMode.platform=r),!r&&this.serverMode&&this.serverMode.platform&&(r=this.serverMode.platform);for(var s=0;s<this.providers.length;s++){var o=this.providers[s];if(!o.url)continue;n&&(o.url=e.Utils.updateMacro(o.url,"[country]",n)),r&&(o.url=e.Utils.updateMacro(o.url,"[platform]",r))}},n}();e.Settings=n}(PWAD||(PWAD={})),function(e){var t=function(){function t(){}return t._replaceMacros=function(t,n,r){var i=/\[CACHEBUSTING\]/gi,s=t;i.test(s)&&(s=s.replace(i,e.Utils.generateCacheBusting()));var o=/\[ERRORCODE\]/gi;o.test(s)&&e.Utils.isNumber(n)&&n>0&&n<1e3&&(s=s.replace(o,n));var u=/\[CONTENTPLAYHEAD\]/gi,a=e.ContentPlayer.I().getCurrentTime();u.test(s)&&a>-1&&(a=e.Utils.vastReadableTime(a),s=s.replace(u,e.Utils.RFC3986EncodeURIComponent(a)));var f=/\[ASSETURI\]/gi;return f.test(s)&&typeof r=="string"&&r!==""&&(s=s.replace(f,e.Utils.RFC3986EncodeURIComponent(r))),s},t._ping=function(t,n){var r=new XMLHttpRequest;r.open("GET",t,!0),r.onreadystatechange=function(i){r.readyState===4&&(r.status<400?(e.Log.log("VAST tracker successfully loaded "+t),r=null,n&&n(!0,t)):(e.Log.log("VAST tracker failed loading "+t),r=null,n&&n(!1,t)))},r.send(null)},t._tracking=function(n,r,i){var s=t._replaceMacros.call(this,n,null,r);t._ping(s,i),e.Log.debug("VAST tracking requesting ping at URL "+s)},t.trackEvent=function(n,r,i,s,o,u){var a=r.filter(function(e){return n===e.event}),f=a.length;for(var l=0;l<a.length;l++)if(e.Utils.isMixedContentRequest(a[l].url,s)){if(o){o(e.Errors.MIXED_CONTENT_NOT_SUPPORTED);return}}else t._tracking(a[l].url,i,function(t,n){if(t)f--,f<=0&&u&&u();else if(u){o(e.Errors.FAILED_START_EVENT_TRACKING);return}});a.length<=0&&u&&u()},t.error=function(n,r,i,s,o){var u=r;e.VastErrors.e303.isEqual(n)&&i.length>0&&(u=u.concat(i));if(u.length>0)for(var a=0,f=u.length;a<f;a++){var l=t._replaceMacros.call(this,u[a].url,n.code,null);e.Utils.isMixedContentRequest(l,s)?o&&o(e.Errors.MIXED_CONTENT_NOT_SUPPORTED):t._ping(l),e.Log.log("VAST tracking requesting error at URL "+l)}},t}();e.Ping=t}(PWAD||(PWAD={})),function(e){var t,n=function(){function e(){}return e}();e.LogSettings=n,t=function(){function e(e){this._settings=e}return e.prototype.log=function(e){if(!this._settings.log)return;console.log(e)},e.prototype.debug=function(e){if(!this._settings.debug)return;console.log("DEBUG:",e)},e}(),e.Logger=t}(PWAD||(PWAD={})),function(e){var t=function(){function t(t,n,r,i,s,o){var u=this;this.pwProviderName=i,this.trackingTags=r.slice(),this.url=t,this.provider=n,this.priority=this.provider.priority?this.provider.priority:0,this.infoString=s,this.isInteractive=!1,this.cpm="",this.nextVideo=null,this.adTagName=o?o:"",e.Utils.isNumber(this.provider.expirationTime)&&this.provider.expirationTime>0?this.expirationTimeout=setTimeout(function(){u.expirationTimeout=null,u._isExpire=!0},this.provider.expirationTime):(this.expirationTimeout=null,this._isExpire=!1)}return t.prototype.setInteractive=function(e,t){this.isInteractive=!0,this.iAdsDriverSettings=e,this.ulrIFrame=t},t.prototype.getErrorInfo=function(){return this.infoString?this.infoString:""},t.prototype.getAdTagName=function(){return this.adTagName?this.adTagName:""},t.prototype.getProviderName=function(){return this.pwProviderName?this.pwProviderName:this.provider.name},t.prototype.invalidateExpiration=function(){this.expirationTimeout&&(clearTimeout(this.expirationTimeout),this.expirationTimeout=null)},t.prototype.isExpire=function(){return this._isExpire},t}();e.AdVideo=t}(PWAD||(PWAD={})),function(e){var t=function(){function e(){this._videos=[],this._currentVideo=null}return e.prototype.isTrueX=function(){if(!this._videos)return!1;for(var e=0;e<this._videos.length;e++)if(this._videos[e].isTrueX)return!0;return!1},e.prototype.isExpire=function(){if(this._videos&&this._videos.length>0){for(var e=0;e<this._videos.length;e++)if(this._videos[e].isExpire())return!0;return!1}return!0},e.prototype.addVideo=function(e){this._videos.push(e)},e.prototype.getVideosCount=function(){return this._videos?this._videos.length:0},e.prototype.getErrorInfo=function(){return this._currentVideo?this._currentVideo.getErrorInfo():""},e.prototype.getAdTagName=function(){return this._currentVideo?this._currentVideo.getAdTagName():""},e.prototype.shiftVideo=function(){return this._currentVideo=null,!this._videos||this._videos.length<=0?null:(this._currentVideo=this._videos.shift(),this._currentVideo)},e.prototype.getPriority=function(){return this._currentVideo?this._currentVideo.priority:this._videos&&this._videos.length>0?this._videos[0].priority:0},e.prototype.invalidateExpiration=function(){if(this._videos&&this._videos.length>0)for(var e=0;e<this._videos.length;e++)this._videos[e].invalidateExpiration()},e.prototype.getLeftVideosCount=function(){return this._videos?this._videos.length:0},e.prototype.getProviderName=function(){return this._currentVideo?this._currentVideo.getProviderName():this._videos&&this._videos.length>0?this._videos[0].getProviderName():null},e.prototype.getProvider=function(){return this._currentVideo?this._currentVideo.provider:this._videos&&this._videos.length>0?this._videos[0].provider:null},e}();e.AdVideoContainer=t}(PWAD||(PWAD={})),function(e){var t,n,r=function(){function e(){}return e}();e.IAdsSettings=r,t=function(){function e(){}return e}(),e.AdParserSettings=t,n=function(){function t(t){this._dispatcher=new e.Dispatcher(["error","adReady"]),this._parser=new DOMParser,this._videoContainers=[],this._settings=t}return t.prototype.reset=function(e){this._error=null,this.vastErrorTags=[],this.inlineOrWrapperErrorTags=[],this.trackingTags=[],this.adPod=[],this.adPodItemWrapper=!1,this.runningAdPod=!1,this.adPodApiInfo=null,this.adPodWrapperTrackings=null,this.isWrapper=!1,this.vastAdTagURI="",this.adTitle="",this.adDescription="",this.adIsLinear=!1,this.redirectsFollowed=0,this.pwProviderName="",this.iAdsVideo=null,this.cpm="",this._currentVideoContainer=null,this._lock=!1,e!==!0&&(this._standaloneAds=[])},t.prototype.hasVideoForPlay=function(e){this.updateExpirationVideos();var t=0;for(var n=0;n<this._videoContainers.length;n++){var r=this._videoContainers[n],i=r.getProvider();if(!i)continue;if(!i.disabledTypes||!e||i.disabledTypes.indexOf(e)<0)r.isTrueX()||t++}return t>0},t.prototype.hasTrueXVideoForPlay=function(e){this.updateExpirationVideos();var t=!1;for(var n=0;n<this._videoContainers.length;n++){var r=this._videoContainers[n],i=r.getProvider();if(!i.disabledTypes||!e||i.disabledTypes.indexOf(e)<0)if(r.isTrueX()){t=!0;break}}return t},t.prototype._pushVideo=function(t){this.cpm&&(t.cpm=this.cpm),this._currentVideoContainer||(this._currentVideoContainer=new e.AdVideoContainer),this._currentVideoContainer.addVideo(t)},t.prototype.updateExpirationVideos=function(){for(var e=this._videoContainers.length-1;e>=0;e--)this._videoContainers[e].isExpire()&&this._videoContainers.splice(e,1)},t.prototype.getVideoByProvider=function(e){for(var t=0;t<this._videoContainers.length;t++){var n=this._videoContainers[t].getProvider();if(n&&n.name==e.name)return this._videoContainers[t]}return null},t.prototype.removeVideoFromPool=function(e){if(!e)return;var t=this._videoContainers.indexOf(e);t>=0&&this._videoContainers.splice(t,1)},t.prototype.getBestVideo=function(e,t){if(e)for(var n=0;n<this._videoContainers.length;n++){var r=this._videoContainers[n],i=r.getProvider();if(!i)continue;if(typeof e=="string"){if(r.getProviderName()==e&&(!i.disabledTypes||!t||i.disabledTypes.indexOf(t)<0))return r.invalidateExpiration(),r}else if(e.indexOf(r.getProviderName())>=0&&(!i.disabledTypes||!t||i.disabledTypes.indexOf(t)<0))return r.invalidateExpiration(),r}this._videoContainers.sort(function(e,t){return t.getPriority()-e.getPriority()});var s=this._videoContainers.filter(function(e){var n=e.getProvider();return n?!n.disabledTypes||!t||n.disabledTypes.indexOf(t)<0:!1}),o=s[s.length-1],u=s.filter(function(e){return e.getPriority()==o.getPriority()}),a=Math.random()*100,f=0,l=null;for(var n=0;n<u.length;n++){var c=u[n];if(!c)continue;var i=c.getProvider();i&&typeof i.probability=="number"&&(f+=i.probability);if(f>a||n==u.length-1){l=c;break}}return l&&l.invalidateExpiration(),l},t.prototype.getError=function(){return this._error},t.prototype.addListener=function(e,t){this._dispatcher.add(e,t)},t.prototype.removeAllListeners=function(){this._dispatcher.removeAll()},t.prototype.removeListener=function(e,t){this._dispatcher.remove(e,t)},t.prototype._onError=function(e){this.adPod.length===0&&this._standaloneAds.length>0?(this.reset(!0),this._parseRetained(this._standaloneAds.shift())):this._dispatcher.dispatch("error",e)},t.prototype._pingError=function(t){var n=this;e.Ping.error(t,this.inlineOrWrapperErrorTags,this.vastErrorTags,this._settings.mixedHTTPProtocol,function(e){n._dispatcher.dispatch("error",e)})},t.prototype.requestProvider=function(e){this._currentProvider=e,this._requestAndParse(this._currentProvider.url)},t.prototype.setMacroValue=function(e,t){this._macroValues||(this._macroValues={}),this._macroValues[e]=t},t.prototype._replaceRandomIntervalTag=function(e){try{var n=e.indexOf(t.RANDOM_INTERVAL_PREFIX_TAG),r=e.substr(n);r=r.substr(0,r.indexOf("]")+1),console.log("forReplace: "+r);var i=e.substr(n+t.RANDOM_INTERVAL_PREFIX_TAG.length),s=i.indexOf("]")+n+t.RANDOM_INTERVAL_PREFIX_TAG.length,o=parseInt(i),i=i.substr(i.indexOf("_")+1),u=parseInt(i);if(isNaN(o)||isNaN(u))return e.replace(t.RANDOM_INTERVAL_PREFIX_TAG,"[");console.log("min: "+o),console.log("max: "+u);var a=Math.round(Math.random()*(u-o)+o);e=e.replace(r,""+a)}catch(f){e=e.replace(t.RANDOM_INTERVAL_PREFIX_TAG,"[")}return e},t.prototype._requestAndParse=function(n){var r=this;if(this._lock)return;while(n.indexOf(t.RANDOM_NUMBER_TAG)>=0)n=n.replace(t.RANDOM_NUMBER_TAG,""+Math.floor(Math.random()*1e9));while(n.indexOf(t.RANDOM_INTERVAL_PREFIX_TAG)>=0)n=this._replaceRandomIntervalTag(n);if(this._macroValues)for(var i in this._macroValues)if(this._macroValues.hasOwnProperty(i)&&this._macroValues[i]){var s=encodeURIComponent(this._macroValues[i]);while(n.indexOf(i)>=0)n=n.replace(i,s)}e.Utils.ajax(n,this._settings.ajaxTimeout,this._settings.ajaxWithCredentials,this._settings.mixedHTTPProtocol,function(t){typeof t!="string"||!t?r._onError(e.Errors.AJAX_EMPTY):r._parseXML(t)},function(t){r._pingError(e.VastErrors.e301),r._onError(t)})},t.prototype._parseXML=function(t){try{var n=this._parser.parseFromString(t,"text/xml");this._onXmlAvailable(n)}catch(r){this._onError(e.Errors.runtime(r))}},t.prototype._onXmlAvailable=function(t){var n=t.getElementsByTagName("vmap:VMAP");if(n.length>0){this._onError(e.VastErrors.e200);return}var r=t.getElementsByTagName("VAST");if(r.length===0){this._pingError(e.VastErrors.e100),this._onError(e.VastErrors.e100);return}var i=r[0],s=i.getElementsByTagName("Error");if(s.length>0)for(var o=0,u=s.length;o<u;o++)if(s[o].parentNode===i){var a=e.Utils.getNodeValue(s[o],!0);a!==null&&this.vastErrorTags.push({event:"error",url:a})}var f=/^(2|3|4)\./i,l=i.getAttribute("version");if(!f.test(l)){this._pingError(e.VastErrors.e102),this._onError(e.VastErrors.e102);return}var c=i.getElementsByTagName("PWProvider");this.pwProviderName="",c.length>0&&(this.pwProviderName=e.Utils.getNodeValue(c[0],!1));var h=i.getElementsByTagName("Ad");if(h.length===0){this._pingError(e.VastErrors.e303),this._onError(e.VastErrors.e303);return}this._filterAdPod(h)},t.prototype._filterAdPod=function(t){e.Log.debug("_filterAdPod");var n;if(this.adPod.length>0&&!this.adPodItemWrapper)e.Log.debug("loading next ad in pod"),n=t[0],this.adPod.shift();else if(this.adPod.length>0&&this.adPodItemWrapper){e.Log.debug("running ad pod Ad is a wrapper"),this.adPodItemWrapper=!1;for(var r=0,i=t.length;r<i;r++){var s=t[r].getAttribute("sequence");if(s===""||s===null){n=t[r];break}}}else{for(var r=0,i=t.length;r<i;r++){var s=t[r].getAttribute("sequence");s===""||s===null?this._standaloneAds.unshift(t[r]):this.adPod.push(t[r])}this.adPod.length===0&&this._standaloneAds.length>0?n=this._standaloneAds.shift():this.adPod.length>0&&(e.Log.debug("ad pod detected"),this.runningAdPod=!0,this.adPodApiInfo=this.adPod.slice(),this.adPodWrapperTrackings=this.trackingTags.slice(),this.adPod.length>this._settings.maxNumItemsInAdPod&&(this.adPod.length=this._settings.maxNumItemsInAdPod),this.adPod.sort(function(e,t){var n=parseInt(e.getAttribute("sequence")),r=parseInt(t.getAttribute("sequence"));return n-r}),n=this.adPod[0],this.adPod.shift())}this._parseRetained(n)},t.prototype._parseExtensions=function(t){if(!t||t.length<=0)return;var n=t[0].getElementsByTagName("Extension");for(var r=0;r<n.length;r++){var i=n[r].getElementsByTagName("CPM");i.length>0&&(this.cpm=e.Utils.getNodeValue(i[0],!1));var s=n[r].getElementsByTagName("Pricing");s.length>0&&(this.cpm=e.Utils.getNodeValue(s[0],!1))}},t.prototype._parseRetained=function(t){if(this._standaloneAds.length>0&&!t){this._pingError(e.VastErrors.e200),this._onError(e.VastErrors.e200);return}var n=t.getElementsByTagName("InLine"),r=t.getElementsByTagName("Wrapper"),i=t.getElementsByTagName("AdSystem");if(n.length===0&&r.length===0){this._pingError(e.VastErrors.e101),this._onError(e.VastErrors.e101);return}var s;r.length>0?(this.isWrapper=!0,s=r,this.vastAdTagURI=s[0].getElementsByTagName("VASTAdTagURI")):s=n;var o=s[0].getElementsByTagName("Impression"),u=s[0].getElementsByTagName("Error");if(u.length>0){var a=e.Utils.getNodeValue(u[0],!0);a!==null&&this.inlineOrWrapperErrorTags.push({event:"error",url:a})}var f=s[0].getElementsByTagName("AdTitle"),l=s[0].getElementsByTagName("Description"),c=s[0].getElementsByTagName("Creatives");this._parseExtensions(s[0].getElementsByTagName("Extensions"));if(this.isWrapper){if(this.vastAdTagURI.length===0){this._pingError(e.VastErrors.e101),this._onError(e.VastErrors.e101);return}}else if(c.length===0){this._pingError(e.VastErrors.e101),this._onError(e.VastErrors.e101);return}var h;if(c.length>0){h=c[0].getElementsByTagName("Creative");if(!this.isWrapper&&h.length===0){this._pingError(e.VastErrors.e101),this._onError(e.VastErrors.e101);return}}if(o.length>0)for(var p=0,d=o.length;p<d;p++){var v=e.Utils.getNodeValue(o[p],!0);v!==null&&this.trackingTags.push({event:"impression",url:v})}this.isWrapper||(f.length>0&&(this.adTitle=e.Utils.getNodeValue(f[0],!1)),l.length>0&&(this.adDescription=e.Utils.getNodeValue(l[0],!1)));if(this.isWrapper&&!h){this._onError(e.VastErrors.noImplementation);return}this._parseCreatives(h,i)},t.prototype._getIAdsPlayerDriverSettings=function(e){return!this._settings.iAds||!this._settings.iAds.enabled||!e||!this._settings.iAds.drivers[e]||!this._settings.iAds.drivers[e].enabled?null:this._settings.iAds.drivers[e]},t.prototype._parseCreatives=function(t,n){e.Log.debug("_parseCreatives"),this.iAdsVideo=null;if(this._settings.iAds&&this._settings.iAds.enabled)for(var r=0,i=t.length;r<i;r++){var s=t[r],o=s.getElementsByTagName("Linear");if(o.length>0)continue;var u=s.getElementsByTagName("CompanionAds");for(var a=0;a<u.length;a++){var f=u[a].getElementsByTagName("Companion");for(var l=0;l<f.length;l++){var c=f[l],h=c.getAttribute("apiFramework"),p=this._getIAdsPlayerDriverSettings(h);if(p){if(this.runningAdPod){e.Log.debug("Skip interactive ad: "+p.name),this._parseNextPod();return}var d=c.getElementsByTagName("IFrameResource");if(d.length>0){var v=e.Utils.getNodeValue(d[0],!0),m=c.getElementsByTagName("TrackingEvents");m.length>0&&this._trackingFilterPush(m),this.iAdsVideo=new e.AdVideo(v,this._currentProvider,this.trackingTags,this.pwProviderName,this.getInfoString(),this.getAdTagName()),this.iAdsVideo.setInteractive(p,v)}}}}}for(var r=0,i=t.length;r<i;r++){var s=t[r],g=s.getElementsByTagName("NonLinearAds"),o=s.getElementsByTagName("Linear"),u=s.getElementsByTagName("CompanionAds");if(u.length>0)continue;if(g.length===0&&o.length===0){this._onError(e.VastErrors.e303);return}if(o.length>0){var m=o[0].getElementsByTagName("TrackingEvents");m.length>0&&this._trackingFilterPush(m);if(this.isWrapper){this._execRedirect();return}var y=e.Utils.getNodeValue(n[0],!1);y=="trueX"?this._truexParse(s,y):this._linearParse(o);return}}if(this.isWrapper){this._execRedirect();return}},t.prototype._truexParse=function(t,n){if(!this.runningAdPod){var r=t.getElementsByTagName("AdParameters"),i=this._getIAdsPlayerDriverSettings(n);if(i){var s=JSON.parse(e.Utils.getNodeValue(r[0],!1)).vast_config_url;this.iAdsVideo=new e.AdVideo(s,this._currentProvider,this.trackingTags,this.pwProviderName,this.getInfoString(),this.getAdTagName()),this.iAdsVideo.setInteractive(i,s),this.iAdsVideo.isTrueX=!0,this._pushVideo(this.iAdsVideo)}}else e.Log.debug("Skip interactive ad: TrueX");this._parseNextPod()},t.prototype.lock=function(){this._lock=!0},t.prototype.unlock=function(){this._lock=!1},t.prototype._execRedirect=function(){if(this._lock)return;e.Log.debug("adfollowingredirect");var t=e.Utils.getNodeValue(this.vastAdTagURI[0],!0);e.Log.debug("redirect URL is "+t),t!==null?this._settings.maxNumRedirects>this.redirectsFollowed?(this.redirectsFollowed++,this.runningAdPod&&(this.adPodItemWrapper=!0),this.isWrapper=!1,this.vastAdTagURI=null,this._requestAndParse(t)):(this._pingError(e.VastErrors.e302),this._onError(e.VastErrors.e302)):(this._pingError(e.VastErrors.e300),this._onError(e.VastErrors.e300))},t.prototype._trackingFilterPush=function(t){var n=t[0].getElementsByTagName("Tracking");this.adPodWrapperTrackings&&this.adPodWrapperTrackings.length>0&&(this.trackingTags=this.adPodWrapperTrackings);for(var r=0,i=n.length;r<i;r++){var s=n[r].getAttribute("event"),o=e.Utils.getNodeValue(n[r],!0);s!==null&&s!==""&&this._settings.pingEvents.indexOf(s)>-1&&o!==null&&this.trackingTags.push({event:s,url:o})}},t.prototype._linearParse=function(t){var n=this;this.adIsLinear=!0;var r=t[0].getElementsByTagName("MediaFiles");if(r.length===0){this._pingError(e.VastErrors.e101),this._onError(e.VastErrors.e101);return}var i=t[0].getElementsByTagName("Duration");if(r.length>0){var s=e.Utils.getDurationNodeValue(i[0]);e.Log.debug("Video Duration: "+s);if(e.Utils.isNumber(s)){if(this._settings.minVideoDuration>0&&s<this._settings.minVideoDuration){e.Log.debug("Video skipped by minimum duration"),this._onError(e.VastErrors.e1005.extendByInfo(this.getInfoString()));return}if(this._settings.maxVideoDuration>0&&s>=this._settings.maxVideoDuration){e.Log.debug("Video skipped by maximum duration"),this._onError(e.VastErrors.e1006.extendByInfo(this.getInfoString()));return}}}var o=r[0].getElementsByTagName("MediaFile");if(o.length===0){this._pingError(e.VastErrors.e101),this._onError(e.VastErrors.e101);return}var u=[],a=[];for(var f=0,l=o.length;f<l;f++){u[f]={};var c=o[f],h=e.Utils.getNodeValue(c,!0);if(h===null){a.push(f);continue}var p=c.getAttribute("type");if(p===null||p===""){a.push(f);continue}var d=c.getAttribute("apiFramework");if(d){var v=this._getIAdsPlayerDriverSettings(d);if(!v){a.push(f);continue}}u[f].url=h,u[f].type=p;var m=c.getAttribute("codec");m!==null&&m!==""&&(u[f].codec=m);var g=c.getAttribute("width");if(g===null||g==="")e.Log.debug("missing required width attribute on MediaFile tag - this is not a VAST 3 spec compliant adTag - continuing anyway (same as IMA)"),g=0;var y=c.getAttribute("height");if(y===null||y==="")e.Log.debug("missing required height attribute on MediaFile tag - this is not a VAST 3 spec compliant adTag - continuing anyway (same as IMA)"),y=0;var b=c.getAttribute("bitrate");if(b===null||b===""||b<10)b=0;u[f].width=parseInt(g),u[f].height=parseInt(y),u[f].bitrate=parseInt(b)}if(a.length>0)for(var f=a.length-1;f>=0;f--)u.splice(a[f],1);var w=[];for(var f=0,l=u.length;f<l;f++){var E=u[f];w.push(E)}var S=[];S=w.filter(function(e){return n._settings.testCommonVideoFormats.indexOf(e.type)>=0});if(S.length===0){this._pingError(e.VastErrors.e403),this._onError(e.VastErrors.e403);return}S.sort(function(e,t){return e.width-t.width}),e.Log.debug("available linear creative follows");var x=null,T=[],N=[];if(S.length>1){var C=e.ContentPlayer.I().getWidth(),k=e.ContentPlayer.I().getHeight();C>0&&k>0&&(T=S.filter(function(e){return C>=e.width&&k>=e.height})),T.length===0&&(T=[S[0]]);var L=e.Utils.getBandwidthEstimate();L>-1&&T.length>1&&(T.sort(function(e,t){return e.bitrate-t.bitrate}),L=Math.round(L*1e3),N=T.filter(function(e){return L>=e.bitrate}),x=N[N.length-1])}x||(T.length>0?x=T[T.length-1]:(S.sort(function(e,t){return e.bitrate-t.bitrate}),x=S[S.length-1]));if(e.Utils.isMixedContentRequest(x.url,this._settings.mixedHTTPProtocol))this._onError(e.Errors.MIXED_CONTENT_NOT_SUPPORTED);else if(this.iAdsVideo)this.iAdsVideo.url=x.url,this.iAdsVideo.trackingTags=this.trackingTags,this._pushVideo(this.iAdsVideo),this._parseNextPod();else if(this._settings.convert&&this._settings.convert.enabled){var A={url:x.url};typeof this._settings.convert.hlsTimeSec!="undefined"&&(A.hlsTimeSec=this._settings.convert.hlsTimeSec),typeof this._settings.convert.audioBitRate!="undefined"&&(A.audioBitRate=this._settings.convert.audioBitRate),typeof this._settings.convert.maxVideoBitRate!="undefined"&&(A.maxVideoBitRate=this._settings.convert.maxVideoBitRate),typeof this._settings.convert.maxVideoWidth!="undefined"&&(A.maxVideoWidth=this._settings.convert.maxVideoWidth),e.Utils.ajaxPostResponse(this._settings.convert.url,A,function(t){t?n._pushVideo(new e.AdVideo(t,n._currentProvider,n.trackingTags,n.pwProviderName,n.getInfoString(),n.getAdTagName())):n._onError(e.Errors.CONVERT_VIDEO_NOT_CACHED),n._parseNextPod()},function(){n._onError(e.Errors.FAILED_CONVERT_VIDEO),n._parseNextPod()})}else this._pushVideo(new e.AdVideo(x.url,this._currentProvider,this.trackingTags,this.pwProviderName,this.getInfoString(),this.getAdTagName())),this._parseNextPod()},t.prototype._parseNextPod=function(){if(this.adPod.length>0){var t=this.adPod[0];this.iAdsVideo=null,this.adPod.shift(),this.trackingTags=[],this.cpm="",e.Log.debug("Parse next pod, left: "+this.adPod.length),this._parseRetained(t)}else this._currentVideoContainer?(e.Log.debug("Available videos: "+this._currentVideoContainer.getVideosCount()),this._videoContainers.push(this._currentVideoContainer),this._currentVideoContainer=null,this._dispatcher.dispatch("adReady",this,this._videoContainers[this._videoContainers.length-1])):this._onError(e.VastErrors.e303)},t.prototype.getAdTagName=function(){var e="";return this.adTitle?e=this.adTitle:e="<>"+
(this.adDescription?", "+this.adDescription:""),e},t.prototype.getInfoString=function(){var e="";return this.adTitle&&(e+=this.adTitle),this.adDescription&&(e&&(e+=", "),e+=this.adDescription),e},t.RANDOM_NUMBER_TAG="[random]",t.RANDOM_INTERVAL_PREFIX_TAG="[random_interval_",t}(),e.AdParser=n}(PWAD||(PWAD={})),function(e){function t(e){return e?!0:!1}e.isHasPlayerDriver=t}(PWAD||(PWAD={})),function(e){var t=function(){function t(){this._dispatcher=new e.Dispatcher(["error","playing","timeupdate","ended","impression","interrupted"]),this._timeUpdateCalledTimes=0,this._coverEl=null}return t.prototype.create=function(e,t,n){var r=this;this._settings=e,this._videoEl=document.getElementById(this._settings.videoContainerId),this._videoEl&&(this._videoEl.addEventListener("error",function(e){r._onError(e)},!0),this._videoEl.addEventListener("playing",function(){r._onPlayStarted()},!0),this._videoEl.addEventListener("ended",function(){r._onEnded()},!0),this._videoEl.addEventListener("timeupdate",function(){r._onTimeUpdate()},!0)),n&&n()},t.prototype.addListener=function(e,t){this._dispatcher.add(e,t)},t.prototype.removeAllListener=function(){this._dispatcher.removeAll()},t.prototype.removeListener=function(e,t){this._dispatcher.remove(e,t)},t.prototype.interrupt=function(){this._clearTimeouts(),this._dispatcher.dispatch("interrupted")},t.prototype._resetVideoElement=function(){this._videoEl&&(this._videoEl.pause(),this._videoEl.src="",this._videoEl.style.display="none",this._hideCover())},t.prototype.reset=function(){this._isPlaying=!1,this._clearTimeouts(),this._timeUpdateCalledTimes=0,this._resetVideoElement()},t.prototype.getDuration=function(){if(this._videoEl){var t=this._videoEl.duration;if(e.Utils.isNumber(t))return Math.round(t*1e3)}return-1},t.prototype.getCurrentTime=function(){if(this._videoEl){var t=this._videoEl.currentTime;if(e.Utils.isNumber(t))return Math.round(t*1e3)}return-1},t.prototype._onPlayStarted=function(){var n=this;!this._isPlayingFired&&this._isPlaying&&(this._hideCover(),this._isPlayingFired=!0,this._timeUpdateCalledTimes=0,this._timeoutTimeUpdateNotActive=setTimeout(function(){n._timeoutTimeUpdateNotActive=null,n._isPlaying&&(n._resetVideoElement(),n._onError(e.VastErrors.e1007))},t.TIMEUPDATE_NO_ACTIVE_TIMEOUT),this._dispatcher.dispatch("playing"),this._dispatcher.dispatch("impression"))},t.prototype._clearTimeouts=function(){this._timeoutTimeUpdateNotActive&&(clearTimeout(this._timeoutTimeUpdateNotActive),this._timeoutTimeUpdateNotActive=null)},t.prototype._onEnded=function(){!this._isEndedFired&&this._isPlaying&&(this._isEndedFired=!0,this._dispatcher.dispatch("ended")),this._clearTimeouts(),this._isPlaying=!1},t.prototype.pause=function(){this._videoEl&&this._videoEl.pause()},t.prototype.resume=function(){this._videoEl&&this._videoEl.play()},t.prototype._onError=function(e){this._clearTimeouts(),this._isPlaying&&(this._isPlaying=!1,this.reset(),this._dispatcher.dispatch("error",e))},t.prototype._onTimeUpdate=function(){this._isPlaying&&(this._timeUpdateCalledTimes++,this._timeUpdateCalledTimes>=2&&this._timeoutTimeUpdateNotActive&&(clearTimeout(this._timeoutTimeUpdateNotActive),this._timeoutTimeUpdateNotActive=null),this._dispatcher.dispatch("timeupdate"))},t.prototype._initiatePlay=function(e){this._videoEl.src=e.url,this._videoEl.autoplay=!0,this._videoEl.style.display="block",this._videoEl.load()},t.prototype._hideCover=function(){this._coverEl&&(this._coverEl.style.display="none")},t.prototype._showCover=function(){if(!this._coverEl){this._coverEl=document.createElement("div");var e=this._coverEl,t=this._settings;e.style.position="fixed",e.style.top=""+t.y+"px",e.style.left=""+t.x+"px",e.style.width=""+t.width+"px",e.style.height=""+t.height+"px",e.style.background="black",document.body.appendChild(e),e.style.zIndex="9999999"}this._coverEl.style.display="block"},t.prototype.play=function(e){var t=this;this._isPlayingFired=!1,this._isEndedFired=!1,this._isPlaying=!0,this._settings.showCoverScreenBeforePlay&&this._showCover(),this._settings.delayBeforePlay?setTimeout(function(){t._initiatePlay(e)},this._settings.delayBeforePlay):this._initiatePlay(e)},t.prototype.isSkipAllowed=function(){return!0},t.TIMEUPDATE_NO_ACTIVE_TIMEOUT=1e4,t}();e.VideoPlayerDriver=t,e.playerDriverClass=t}(PWAD||(PWAD={})),function(e){var t=function(){function t(){this._dispatcher=new e.Dispatcher(["error","playing","timeupdate","ended","opened","impression","interrupted"])}return t.prototype.create=function(e,t,n){var r=this;this._settings=e;var i=document.getElementById(this._settings.videoContainerId);this._containerEl=document.createElement("div"),this._containerEl.style.display="none",this._containerEl.style.position="fixed",this._containerEl.style.width=e.width+"px",this._containerEl.style.height=e.height+"px",this._containerEl.style.top=e.y+"px",this._containerEl.style.left=e.x+"px",this._containerEl.style.backgroundColor="black",i?i.parentNode.insertBefore(this._containerEl,i.nextSibling):document.body.appendChild(this._containerEl),window.addEventListener("message",function(e){e.data&&r._handleEvents(e.data.type,e.data.params)}),n&&n()},t.prototype.removeAllListener=function(){this._dispatcher.removeAll()},t.prototype.addListener=function(e,t){this._dispatcher.add(e,t)},t.prototype.removeListener=function(e,t){this._dispatcher.remove(e,t)},t.prototype._hideAndStoreByClassName=function(e){var t=document.getElementsByClassName(e);if(t)for(var n=0;n<t.length;n++){var r=t[n];r.style.display!="none"&&(r.style.display="none",this._stripsStates.push(r))}},t.prototype._hideStrip=function(){this._stripsStates=[],this._hideAndStoreByClassName("tgh5-ad-topStripText"),this._hideAndStoreByClassName("tgh5-ad-topStrip")},t.prototype._restoreStrip=function(){if(this._stripsStates&&this._stripsStates.length>0){for(var e=0;e<this._stripsStates.length;e++)this._stripsStates[e].style.display="block";this._stripsStates=[]}},t.prototype._handleEvents=function(e,t){if(!this._isPlaying)return;switch(e){case"iroll-video-progress":t&&(this._duration=t.duration,this._time=t.position,this._dispatcher.dispatch("timeupdate")),this._onStart();break;case"iroll-video-started":break;case"iroll-expand":this._isOpenedFired||(this._isOpenedFired=!0,this._dispatcher.dispatch("opened")),this._paused=!0,this._hideStrip();break;case"iroll-collapse":this._paused=!1,this._restoreStrip();break;case"iroll-ended":this._onEnd()}},t.prototype._onStart=function(){this._isPlayingFired||(this._isPlayingFired=!0,this._dispatcher.dispatch("playing"),this._dispatcher.dispatch("impression"))},t.prototype.reset=function(){this._isPlaying=!1,this._iFrame&&(this._containerEl.removeChild(this._iFrame),this._iFrame=null),this._containerEl.style.display="none"},t.prototype.interrupt=function(){this._dispatcher.dispatch("interrupted")},t.prototype._onEnd=function(){!this._isEndedFired&&this._isPlaying&&(this._isEndedFired=!0,window.focus(),this._dispatcher.dispatch("ended")),this.reset()},t.prototype.play=function(t){this._isPlayingFired=!1,this._isEndedFired=!1,this._isOpenedFired=!1,this._isPlaying=!0,this._paused=!1,this._time=0,this._duration=0;var n=t.provider.url,r=e.Utils.getLaunchParameter(n,"platform");r||(r=e.Utils.getLaunchParameter(location.href,"platform")),r||(console.error("'platform' not specified for Innovid interactive ads, please add 'platform=[platform]' parameter to the Ads TAG URL"),r="none");var i=e.Utils.getLaunchParameter(n,"deviceId");i||(console.error("'deviceId' not specified for Innovid interactive ads, please add 'deviceId=[device_id]' or 'deviceId=[ifa_id]' parameter to the Ads TAG URL"),i="00000000-0000-0000-0000-000000000000");var s={keyMap:t.iAdsDriverSettings.keyMap,platform:r,advertisingId:i};this._iFrame=document.createElement("iframe"),this._iFrame.style.border="none",this._iFrame.style.position="absolute",this._iFrame.style.background="transparent",this._iFrame.style.left="0px",this._iFrame.style.top="0px",this._iFrame.style.width="100%",this._iFrame.style.height="100%",this._iFrame.autoplay=!0,this._containerEl.appendChild(this._iFrame),this._iFrame.src=t.ulrIFrame+"#params="+encodeURIComponent(JSON.stringify(s)),this._containerEl.style.display="block",this._containerEl.parentElement&&(this._containerEl.parentElement.style.display="block")},t.prototype.pause=function(){},t.prototype.resume=function(){},t.prototype.getDuration=function(){return this._isPlaying&&this._duration>0?this._duration*1e3|0:-1},t.prototype.getCurrentTime=function(){return this._isPlaying?this._time*1e3|0:-1},t.prototype.isSkipAllowed=function(){return!1},t}();e.InnovidPlayerDriver=t}(PWAD||(PWAD={})),function(e){var t=function(){function t(){this._dispatcher=new e.Dispatcher(["error","playing","timeupdate","ended","opened","impression","interrupted"])}return t.prototype.create=function(t,n,r){var i=this;this._settings=t,this._iAdSettings=n,e.Utils.loadScript(this._iAdSettings.sdkLibURL,function(){if(!BL){r(!1);return}BL.on_deviceInfo=function(){var t=i._adVideo.provider.url,n=e.Utils.getLaunchParameter(t,"platform");n||(n=e.Utils.getLaunchParameter(location.href,"platform")),n||(console.error("'platform' not specified for Brightline interactive ads, please add 'platform=[platform]' parameter to the Ads TAG URL"),n="none");var r=e.Utils.getLaunchParameter(t,"deviceId");r||(console.error("'deviceId' not specified for Brightline interactive ads, please add 'deviceId=[device_id]' or 'deviceId=[ifa_id]' parameter to the Ads TAG URL"),r="00000000-0000-0000-0000-000000000000");var s={advertisingIdentifier:r,applicationIdentifier:"playworks",applicationVersion:"1.0",deviceName:n,screenResolution:"1280,720",partnerAPI:null};return s},BL.on_BL_opened=function(){},BL.on_BL_rendered=function(){},BL.on_BL_expanded=function(){i._videoPlayerDriver.pause(),i._isOpenedFired||(i._isOpenedFired=!0,i._dispatcher.dispatch("opened"))},BL.on_BL_closed=function(){},i._isBLInitialized=!1,r(!0)},function(){e.Log.debug("Error loading script: "+i._iAdSettings.sdkLibURL),r(!1)})},t.prototype.addListener=function(e,t){this._dispatcher.add(e,t)},t.prototype.removeAllListener=function(){this._dispatcher.removeAll()},t.prototype.removeListener=function(e,t){this._dispatcher.remove(e,t)},t.prototype.reset=function(){this._isPlaying=!1},t.prototype.interrupt=function(){this._dispatcher.dispatch("interrupted")},t.prototype.play=function(e,t){var n=this;this._adVideo=e,this._isOpenedFired=!1,this._isPlaying=!0,this._isBLInitialized||(this._isBLInitialized=!0,BL.init());var r,i,s,o;this._videoPlayerDriver=t;var u=function(){t.removeListener("ended",r),t.removeListener("playing",i),t.removeListener("error",s),t.removeListener("timeupdate",o)};i=function(){var r=n.getDuration();t.removeListener("playing",i),n._dispatcher.dispatch("playing",r),n._dispatcher.dispatch("impression"),setTimeout(function(){BL.openAd(e.ulrIFrame,n._settings.videoContainerId)},500)},r=function(){u(),BL.closeAd(),window.focus(),n._dispatcher.dispatch("ended")},s=function(e){u(),n._dispatcher.dispatch("error")},o=function(){n._dispatcher.dispatch("timeupdate")},BL.on_BL_collapsed=function(){n._isOpenedFired=!1,n._videoPlayerDriver.reset(),r()},t.addListener("error",s),t.addListener("playing",i),t.addListener("ended",r),t.addListener("timeupdate",o),t.play(e)},t.prototype.getDuration=function(){return this._isPlaying?this._videoPlayerDriver.getDuration():-1},t.prototype.getCurrentTime=function(){return this._isPlaying?this._videoPlayerDriver.getCurrentTime():-1},t.prototype.pause=function(){},t.prototype.resume=function(){},t.prototype.isSkipAllowed=function(){return!1},t}();e.BrightlinePlayerDriver=t}(PWAD||(PWAD={})),function(e){var t=function(){function t(){this._dispatcher=new e.Dispatcher(["error","playing","timeupdate","ended","opened","adsFree","notFinished","impression","interrupted"])}return t.prototype.create=function(t,n,r){var i=this;this._containerEl=document.createElement("div"),this._containerEl.style.display="none",this._containerEl.id="turexAdContainer",this._containerEl.style.position="fixed",this._containerEl.style.zIndex="999999999",this._containerEl.style.width=t.width+"px",this._containerEl.style.height=t.height+"px",this._containerEl.style.top=t.y+"px",this._containerEl.style.left=t.x+"px",document.body.appendChild(this._containerEl),this._settings=t,this._iAdSettings=n,this._adFreePod=!1,e.Utils.loadScript(this._iAdSettings.sdkLibURL,function(){i._TAR=TruexAdRenderer.TruexAdRenderer,r(!0)},function(){e.Log.debug("Error loading script: "+i._iAdSettings.sdkLibURL),r(!1)})},t.prototype.addListener=function(e,t){this._dispatcher.add(e,t)},t.prototype.removeListener=function(e,t){this._dispatcher.remove(e,t)},t.prototype.removeAllListener=function(){this._dispatcher.removeAll()},t.prototype.reset=function(){},t.prototype.interrupt=function(){this._dispatcher.dispatch("interrupted")},t.prototype.play=function(e,t){var n=this,r={supportsExitOnUserCancel:!0,keyMapOverrides:{select:e.iAdsDriverSettings.keyMap.ENTER,back:e.iAdsDriverSettings.keyMap.BACK,moveUp:e.iAdsDriverSettings.keyMap.UP,moveDown:e.iAdsDriverSettings.keyMap.DOWN,moveLeft:e.iAdsDriverSettings.keyMap.LEFT,moveRight:e.iAdsDriverSettings.keyMap.RIGHT}},i=function(e){var t=n._tar.adEvents;switch(e.type){case t.adError:s(),n._dispatcher.dispatch("notFinished");break;case t.adStarted:n._containerEl.style.display="block",n._dispatcher.dispatch("playing");var r=n._containerEl.firstChild;r&&r.focus();break;case t.optIn:break;case t.optOut:s(),n._dispatcher.dispatch("notFinished");break;case t.adFreePod:n._adFreePod=!0,n._dispatcher.dispatch("adsFree"),n._dispatcher.dispatch("impression");break;case t.userCancel:s(),n._dispatcher.dispatch("notFinished");break;case t.userCancelStream:s(),n._dispatcher.dispatch("notFinished");break;case t.noAdsAvailable:s(),n._dispatcher.dispatch("notFinished");break;case t.adCompleted:s(),n._adFreePod?n._dispatcher.dispatch("ended",!0):n._dispatcher.dispatch("notFinished")}},s=function(){n._tar&&(n._tar.unsubscribe(i),n._tar=null),n._containerEl.style.display="none",window.focus()};this._tar=new this._TAR(this._validateUrl(e.url),r),this._tar.subscribe(i),this._tar.init().then(function(e){n._tar.start(e,n._containerEl)})},t.prototype.pause=function(){},t.prototype.resume=function(){},t.prototype.getDuration=function(){return-1},t.prototype.getCurrentTime=function(){return-1},t.prototype._validateUrl=function(e){var t=e.split("//");return location.protocol+"//"+t[t.length-1]},t.prototype.isSkipAllowed=function(){return!1},t}();e.TrueXPlayerDriver=t}(PWAD||(PWAD={})),function(e){var t,n=function(){function e(){}return e}();e.ContentPlayerSettings=n,t=function(){function t(){this._dispatcher=new e.Dispatcher(["error","started","timerUpdate","completed","finished","adsFree","notFinished","impression"]),this._driver=new e.playerDriverClass,this._iAdsDrivers={}}return t.prototype.init=function(e){this._settings=e,this._driver.create(this._settings),this._isHasVideo=!1},t.prototype.addListener=function(e,t){this._dispatcher.add(e,t)},t.prototype.removeListener=function(e,t){this._dispatcher.remove(e,t)},t.prototype._getIAdsDriver=function(t,n){var r=this;if(this._iAdsDrivers[t.name]){n(this._iAdsDrivers[t.name]);return}this._iAdsDrivers[t.name]=new e[t.className],this._iAdsDrivers[t.name].create(this._settings,t,function(e){e===!1?n(null):n(r._iAdsDrivers[t.name])})},t.prototype._setupDriver=function(e,t){var n=this;e.isInteractive?this._getIAdsDriver(e.iAdsDriverSettings,function(e){e?n._currentDriver=e:n._currentDriver=n._driver,t()}):(this._currentDriver=this._driver,t())},t.prototype.interrupt=function(){this._currentDriver&&this._currentDriver.interrupt()},t.prototype._playAdVideo=function(t,n,r,i){var s=this;this._impressionTracked=!1,this._setupDriver(t,function(){var o,u,a,f,l,c,h,p,d,v=function(){s._currentDriver.removeListener("ended",o),s._currentDriver.removeListener("playing",u),s._currentDriver.removeListener("error",a),s._currentDriver.removeListener("timeupdate",f),s._currentDriver.removeListener("opened",l),s._currentDriver.removeListener("notFinished",c),s._currentDriver.removeListener("adsFree",h),s._currentDriver.removeListener("impression",p),s._currentDriver.removeListener("interrupted",d)};l=function(){e.Ping.trackEvent("acceptInvitation",t.trackingTags,t.url,r,i)},u=function(){var n=s.getDuration();s._currentDriver.removeListener("playing",u),e.Ping.trackEvent("loaded",t.trackingTags,t.url,r,i),e.Ping.trackEvent("creativeView",t.trackingTags,t.url,r,i),s._settings.trackImpressionAfterStart?(s._impressionTracked=!1,e.Ping.trackEvent("start",t.trackingTags,t.url,r,i,function(){s._impressionTracked||(e.Ping.trackEvent("impression",t.trackingTags,t.url,r,i),s._impressionTracked=!0)})):e.Ping.trackEvent("start",t.trackingTags,t.url,r,i),s._dispatcher.dispatch("started",n,t.cpm)},p=function(){s._impressionTracked||(e.Ping.trackEvent("impression",t.trackingTags,t.url,r,i),s._impressionTracked=!0),s._dispatcher.dispatch("impression",t.cpm)},o=function(o){v(),s.thirdQuartileEventFired&&e.Ping.trackEvent("complete",t.trackingTags,t.url,r,i),s.reset(),n(o)},d=function(t){e.Log.debug("ContentPlayer, Interrupted"),v(),s.reset()},a=function(n){v();var r;e.Error.isErrorClass(n)?r=n.extendByInfo(t.getErrorInfo()):r=e.VastErrors.e405.extendByInfo(t.getErrorInfo()),s._dispatcher.dispatch("error",r)},f=function(){var n=s.getCurrentTime(),o=s.getDuration();s._settings.maxVideoDurationSeconds>0&&n/1e3>=s._settings.maxVideoDurationSeconds&&(v(),s.reset(),s._dispatcher.dispatch("error",e.Errors.maxVideoDuration(s._settings.maxVideoDurationSeconds).extendByInfo(t.getErrorInfo()))),n>=0&&s._dispatcher.dispatch("timerUpdate",n,o),n>0&&o>n&&(!s._settings.trackImpressionAfterStart||s._impressionTracked)&&(n>=o*.25&&!s.firstQuartileEventFired?(s.firstQuartileEventFired=!0,e.Ping.trackEvent("firstQuartile",t.trackingTags,t.url,r,i)):n>=o*.5&&!s.midpointEventFired&&s.firstQuartileEventFired?(s.midpointEventFired=!0,e.Ping.trackEvent("midpoint",t.trackingTags,t.url,r,i)):n>=o*.75&&!s.thirdQuartileEventFired&&s.midpointEventFired&&(s.thirdQuartileEventFired=!0,e.Ping.trackEvent("thirdQuartile",t.trackingTags,t.url,r,i)))},c=function(){v(),s.reset(),s._dispatcher.dispatch("notFinished")},h=function(){s._dispatcher.dispatch("adsFree")},s.firstQuartileEventFired=!1,s.midpointEventFired=!1,s.thirdQuartileEventFired=!1,s._currentDriver.addListener("error",a),s._currentDriver.addListener("playing",u),s._currentDriver.addListener("ended",o),s._currentDriver.addListener("timeupdate",f),s._currentDriver.addListener("opened",l),s._currentDriver.addListener("notFinished",c),s._currentDriver.addListener("adsFree",h),s._currentDriver.addListener("impression",p),s._currentDriver.addListener("interrupted",d),s._currentDriver.play(t,s._driver),s._isHasVideo=!0})},t.prototype.play=function(t,n,r){var i=this,s=!1,o=function(){setTimeout(function(){var u=t.shiftVideo();u?(i.reset(),i._playAdVideo(u,function(t){t&&(s=!0),e.Log.debug("Play Next POD Video, isAdsFree: "+s),i._dispatcher.dispatch("completed",i.thirdQuartileEventFired,s),s?i._dispatcher.dispatch("finished"):o()},n,r)):i._dispatcher.dispatch("finished")},4)};o()},t.prototype.reset=function(){this._isHasVideo&&this._currentDriver&&(this._currentDriver.reset(),this._currentDriver.removeAllListener(),this._currentDriver=null),this._isHasVideo=!1},t.prototype.getWidth=function(){return this._settings.width},t.prototype.getHeight=function(){return this._settings.height},t.prototype.getDuration=function(){return this._isHasVideo&&this._currentDriver?this._currentDriver.getDuration():-1},t.prototype.isSkipAllowed=function(){return!!this._currentDriver&&!!this._currentDriver.isSkipAllowed()},t.prototype.getCurrentTime=function(){return this._isHasVideo&&this._currentDriver?this._currentDriver.getCurrentTime():-1},t.I=function(){return t._instance?t._instance:(t._instance=new t,t._instance)},t._instance=null,t}(),e.ContentPlayer=t}(PWAD||(PWAD={})),function(e){var t=function(){function e(e,t){this.settings=e,this.index=t,this.timeToUpdate=0}return e}();e.PreloadProvider=t}(PWAD||(PWAD={})),function(e){var t=function(){function t(t,n,r){this._enabled=!0,this._settings=new e.Settings,this._settings.init(t,n,r),e.Log=new e.Logger(this._settings.log),console.log("PW Ads Player version: "+this.getVersion()),typeof n=="string"&&n.length>0&&(this._settings.providers=this._settings.providers.filter(function(e){return typeof e.country=="string"&&e.country.length>0&&e.country.toLowerCase()!==n.toLowerCase()?!1:!0}),e.Log.debug(this._settings.providers)),this._adParserPreload=new e.AdParser(this._settings.adParser),this._adParserNoPreload=new e.AdParser(this._settings.adParser),this._currentAdParser=null,e.ContentPlayer.I().init(this._settings.player),this._dispatcher=new e.Dispatcher(["error","started","completed","finished","timerUpdate","request","response","impression"]),this._adParserListenerAdded=!1,this._playerListenersAdded=!1,this._adParserPreloadListenerAdded=!1,this._preloadStarted=!1,this._waterfallTimeout=null,this._videoStartTimeout=null,this._isWaterfallTimeout=!1,this._isVideoStartTimeout=!1,this._disabledProviders=[],this._providersToRequest=null}return t.prototype.getVersion=function(){return t.VERSION},t.prototype.interruptAd=function(){if(this._currentAdVideo){var t=e.ContentPlayer.I();t&&t.interrupt(),this._clearVideoStartTimeout(),this._currentAdParser.removeVideoFromPool(this._currentAdVideo),this.startPreload()}},t.prototype._initPreload=function(){var n=this;this._adParserPreload.removeAllListeners(),this._preloadStarted=!0,this._preloadProviders=[],this._preloadPoolProviders=[],this._preloadTimeToRequest=0,this._preloadLock=!1,this._settings.providers.forEach(function(t,r){n._disabledProviders.indexOf(t.name)<0&&n._preloadProviders.push(new e.PreloadProvider(t,r))}),this._preloadLastTime=Date.now(),this._preloadLastRequestTime=this._preloadLastTime,this._preloadInterval=setInterval(function(){n._updatePreload()},t._PRELOAD_UPDATE_INTERVAL)},t.prototype._updatePreload=function(){var t=this;if(!this._enabled)return;var n=Date.now(),r=n-this._preloadLastTime;this._preloadLastTime=n,this._preloadTimeToRequest-=r;if(this._preloadLock)return;this._preloadTimeToRequest<=0&&(this._adParserPreload.updateExpirationVideos(),this._preloadTimeToRequest=this._settings.preload.waterfallFrequency,this._preloadProviders.forEach(function(n){t._preloadPoolProviders.indexOf(n)<0&&!t._adParserPreload.getVideoByProvider(n.settings)&&n.settings.preload!==!1&&(t._preloadPoolProviders.push(n),n.timeToUpdate=0,e.Utils.isNumber(n.settings.preloadRequestFrequency)&&(n.timeToUpdate=n.settings.preloadRequestFrequency))}),this._preloadPoolProviders.sort(function(e,t){return e.index-t.index}));for(var i=0;i<this._preloadPoolProviders.length;i++){var s=this._preloadPoolProviders[i];s.timeToUpdate-=r;if(s.timeToUpdate<=0&&n-this._preloadLastRequestTime>=this._settings.preload.vastRequestDelay){this._preloadPoolProviders.splice(i,1),this._preloadLastRequestTime=n,this._preloadRequestAd(s);return}}},t.prototype._getProviderEventPostfix=function(e){return""},t.prototype._preloadRequestAd=function(t){var n=this;this._preloadLock=!0,this._adParserPreloadListenerAdded||(this._adParserPreloadListenerAdded=!0,this._adParserPreload.addListener("adReady",function(e,t){n._preloadOnAdReady(e,t)}),this._adParserPreload.addListener("error",function(e){n._preloadOnParserError(e)})),e.Log.debug("+++ PRELOAD REQUEST: "+t.settings.url),this._adParserPreload.reset(),this._dispatcher.dispatch("request",t.settings.name,this._getProviderEventPostfix(t.settings)),this._currentRequestProvider=t.settings,this._adParserPreload.requestProvider(t.settings)},t.prototype._clearVideoStartTimeout=function(){e.Log.debug("_clearVideoStartTimeout"),this._videoStartTimeout!=null&&(clearTimeout(this._videoStartTimeout),this._videoStartTimeout=null)},t.prototype._playAd=function(t,n){var r=this,i=e.ContentPlayer.I();i.reset(),this._currentAdVideo=t.getBestVideo(n,this._requestedAdType),this._currentAdParser=t,this._clearVideoStartTimeout(),this._isVideoStartTimeout=!1;if(!this._currentAdVideo){this.startPreload(),this._dispatcher.dispatch("finished");return}var s=function(){e.Log.debug("setVideoStartTimeout();"),r._videoStartTimeout=setTimeout(function(){r._isVideoStartTimeout=!0,r._clearVideoStartTimeout(),i.reset(),r._currentAdParser.removeVideoFromPool(r._currentAdVideo),r._dispatcher.dispatch("error",e.Errors.PLAYER_VIDEO_TIMEOUT.extendByInfo(r._currentAdVideo.getErrorInfo()),r._currentAdVideo.getProviderName()),r.startPreload()},r._settings.videoStartErrorTimeout)};s();var o=function(e){if(r._isWaterfallTimeout||r._isVideoStartTimeout)return;r._currentAdParser.removeVideoFromPool(r._currentAdVideo),r.startPreload(),r._clearVideoStartTimeout(),r._dispatcher.dispatch("error",e,r._currentAdVideo.getProviderName())},u=function(e,t){r._clearVideoStartTimeout(),r._dispatcher.dispatch("started",e,r._currentAdVideo.getProviderName(),t,r._currentAdVideo.getAdTagName(),r._currentAdVideo.getLeftVideosCount())},a=function(e){r._dispatcher.dispatch("impression",r._currentAdVideo.getProviderName(),e,r._currentAdVideo.getAdTagName())},f=function(){e.Log.debug("finished all videos"),r._currentAdParser.removeVideoFromPool(r._currentAdVideo),r._clearVideoStartTimeout(),r.startPreload(),r._dispatcher.dispatch("finished")},l=function(t,n){e.Log.debug("video completed"),r._dispatcher.dispatch("completed",r._currentAdVideo.getProviderName(),t,n),s()},c=function(e,t){r._dispatcher.dispatch("timerUpdate",e,t)},h=function(){r._clearVideoStartTimeout();if(r._isWaterfallTimeout)return;r._currentAdParser.removeVideoFromPool(r._currentAdVideo),r._playAd(r._currentAdParser,n)},p=function(){clearInterval(r._preloadInterval)};this._playerListenersAdded||(i.addListener("error",o),i.addListener("started",u),i.addListener("completed",l),i.addListener("finished",f),i.addListener("timerUpdate",c),i.addListener("notFinished",h),i.addListener("adsFree",p),i.addListener("impression",a),this._playerListenersAdded=!0),i.play(this._currentAdVideo,this._settings.adParser.mixedHTTPProtocol,function(e){r._clearVideoStartTimeout(),r._dispatcher.dispatch("error",e,r._currentAdVideo.getProviderName())})},t.prototype._preloadOnAdReady=function(t,n){var r=1;n&&n.getVideosCount&&(r=n.getVideosCount()),e.Log.debug("+++ PRELOAD READY: "+r),this._dispatcher.dispatch("response",this._currentRequestProvider.name,this._getProviderEventPostfix(this._currentRequestProvider),r),this._preloadLock=!1},t.prototype._preloadOnParserError=function(t){e.Log.debug("+++ PRELOAD ERROR: "+t),this._dispatcher.dispatch("error",t,this._currentRequestProvider.name),this._preloadLock=!1},t.prototype.reset=function(){e.ContentPlayer.I().reset(),this._adParserPreload.reset(),this._adParserNoPreload.reset(),this._preloadLock=!1},t.prototype.destroy=function(){this._preloadInterval&&(clearInterval(this._preloadInterval),this._preloadInterval=null)},t.prototype._onAdReadyNoPreload=function(t,n){if(this._isWaterfallTimeout)return;var r=1;n&&n.getVideosCount&&(r=n.getVideosCount()),e.Log.debug("+++ NO PRELOAD, AD READY: "+r),this._dispatcher.dispatch("response",this._currentRequestProvider.name,this._getProviderEventPostfix(this._currentRequestProvider),r),this.isHasTrueX()?(this._currentProviderIndex++,this._requestProvider()):(this._clearWaterfallTimeout(),this._playAd(this._adParserNoPreload))},t.prototype._requestProvider=function(){if(this._currentProviderIndex<this._providersToRequest.length){var e=this._providersToRequest[this._currentProviderIndex];this._adParserNoPreload.reset(),this._dispatcher.dispatch("request",e.name,this._getProviderEventPostfix(e)),this._currentRequestProvider=e,this._adParserNoPreload.requestProvider(e)}else this._clearWaterfallTimeout(),this._adParserNoPreload.hasVideoForPlay(this._requestedAdType)?this._playAd(this._adParserNoPreload):(this.startPreload(),this._dispatcher.dispatch("finished"))},t.prototype._onParserError=function(t){if(this._isWaterfallTimeout)return;e.Log.debug("+++ NO PRELOAD, ERROR "+t),this._dispatcher.dispatch("error",t,this._currentRequestProvider.name,this._currentProviderIndex>=this._providersToRequest.length),this._currentProviderIndex++,this._requestProvider()},t.prototype._clearWaterfallTimeout=function(){this._waterfallTimeout!==null&&(clearTimeout(this._waterfallTimeout),this._waterfallTimeout=null)},t.prototype._requestNoPreload=function(t){var n=this;this._providersToRequest=t,this._currentProviderIndex=0,this._preloadLock=!0,this._adParserPreload.reset(),this._adParserPreload.lock(),this._waterfallTimeout=setTimeout(function(){n._isWaterfallTimeout=!0,n._waterfallTimeout=null,e.ContentPlayer.I().reset(),n._adParserNoPreload.lock(),n._dispatcher.dispatch("error",e.Errors.WATERFALL_TIMEOUT,n._currentRequestProvider?n._currentRequestProvider.name:"",!0),n._preloadLock=!0,setTimeout(function(){n._isWaterfallTimeout=!1,n.startPreload()},n._settings.delayAfterWaterfallTimeout)},this._settings.waterfallErrorTimeout),this._adParserListenerAdded||(this._adParserListenerAdded=!0,this._adParserNoPreload.addListener("adReady",function(e,t){n._onAdReadyNoPreload(e,t)}),this._adParserNoPreload.addListener("error",function(e){n._onParserError(e)}));if(this._isWaterfallTimeout)return;this._requestProvider()},t.prototype._requestAllProvidersNoPreload=function(){if(this._isWaterfallTimeout){this._dispatcher.dispatch("finished");return}var e=[];for(var t=0;t<this._settings.providers.length;t++)e.push(this._settings.providers[t]);this._requestNoPreload(e)},t.prototype.addListener=function(e,t){this._dispatcher.add(e,t)},t.prototype.removeListener=function(e,t){this._dispatcher.remove(e,t)},t.prototype.startPreload=function(){this._adParserPreload.unlock(),this._preloadLock=!1;if(!this._settings.preload.enabled)return;this._preloadStarted||this._initPreload()},t.prototype.hasVideoForPlay=function(e){return this._enabled?this._settings.preload.enabled?this._adParserPreload.hasVideoForPlay(e):!0:!1},t.prototype.isHasTrueX=function(){if(!this._preloadProviders){for(var e=0;e<this._settings.providers.length;e++){var t=this._settings.providers[e];if(t&&t.isTrueX===!0)return!0}return!1}for(var e=0;e<this._preloadProviders.length;e++){var n=this._preloadProviders[e];if(n&&n.settings&&n.settings.isTrueX===!0)return!0}return!1},t.prototype.isEnabled=function(){return this._enabled},t.prototype.disableProvider=function(e){if(!e)return;this._preloadProviders?this._preloadProviders=this._preloadProviders.filter(function(t){return t.settings.name!=e}):this._disabledProviders.push(e)},t.prototype.setMacroValue=function(e,t){this._adParserPreload&&this._adParserPreload.setMacroValue(e,t),this._adParserNoPreload&&this._adParserNoPreload.setMacroValue(e,t)},t.prototype.requestAd=function(e,t){this._requestedAdType=t,this._enabled||this._dispatcher.dispatch("finished");if(!this._settings.preload.enabled)this._requestAllProvidersNoPreload();else if(!this._preloadStarted)this._requestAllProvidersNoPreload();else if(this._adParserPreload.hasVideoForPlay(this._requestedAdType))this._playAd(this._adParserPreload,e);else{var n=[];for(var r=0;r<this._settings.providers.length;r++){var i=this._settings.providers[r];i.preload===!1&&n.push(this._settings.providers[r])}n.length>0?this._requestNoPreload(n):this._dispatcher.dispatch("finished")}},t.prototype.isSkipAllowed=function(){return e.ContentPlayer.I().isSkipAllowed()},t.VERSION="1.30",t._PRELOAD_UPDATE_INTERVAL=1e3,t}();e.Player=t}(PWAD||(PWAD={}));var CryptoJS=CryptoJS||function(o,q){var l={},m=l.lib={},n=m.Base=function(){function a(){}return{extend:function(e){a.prototype=this;var c=new a;e&&c.mixIn(e);c.$super=this;return c},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.$super.extend(this)}}}(),j=m.WordArray=n.extend({init:function(a,e){a=
this.words=a||[];this.sigBytes=e!=q?e:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var e=this.words,c=a.words,d=this.sigBytes,a=a.sigBytes;this.clamp();if(d%4)for(var b=0;b<a;b++)e[d+b>>>2]|=(c[b>>>2]>>>24-8*(b%4)&255)<<24-8*((d+b)%4);else if(65535<c.length)for(b=0;b<a;b+=4)e[d+b>>>2]=c[b>>>2];else e.push.apply(e,c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,e=this.sigBytes;a[e>>>2]&=4294967295<<32-8*(e%4);a.length=o.ceil(e/4)},clone:function(){var a=
n.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var e=[],c=0;c<a;c+=4)e.push(4294967296*o.random()|0);return j.create(e,a)}}),k=l.enc={},r=k.Hex={stringify:function(a){for(var e=a.words,a=a.sigBytes,c=[],d=0;d<a;d++){var b=e[d>>>2]>>>24-8*(d%4)&255;c.push((b>>>4).toString(16));c.push((b&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return j.create(c,b/2)}},p=k.Latin1={stringify:function(a){for(var b=
a.words,a=a.sigBytes,c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-8*(d%4);return j.create(c,b)}},h=k.Utf8={stringify:function(a){try{return decodeURIComponent(escape(p.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return p.parse(unescape(encodeURIComponent(a)))}},b=m.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=j.create();
this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=h.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,d=b.sigBytes,f=this.blockSize,i=d/(4*f),i=a?o.ceil(i):o.max((i|0)-this._minBufferSize,0),a=i*f,d=o.min(4*a,d);if(a){for(var h=0;h<a;h+=f)this._doProcessBlock(c,h);h=c.splice(0,a);b.sigBytes-=d}return j.create(h,d)},clone:function(){var a=n.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});m.Hasher=b.extend({init:function(){this.reset()},
reset:function(){b.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);this._doFinalize();return this._hash},clone:function(){var a=b.clone.call(this);a._hash=this._hash.clone();return a},blockSize:16,_createHelper:function(a){return function(b,c){return a.create(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return f.HMAC.create(a,c).finalize(b)}}});var f=l.algo={};return l}(Math);
(function(o){function q(b,f,a,e,c,d,g){b=b+(f&a|~f&e)+c+g;return(b<<d|b>>>32-d)+f}function l(b,f,a,e,c,d,g){b=b+(f&e|a&~e)+c+g;return(b<<d|b>>>32-d)+f}function m(b,f,a,e,c,d,g){b=b+(f^a^e)+c+g;return(b<<d|b>>>32-d)+f}function n(b,f,a,e,c,d,g){b=b+(a^(f|~e))+c+g;return(b<<d|b>>>32-d)+f}var j=CryptoJS,k=j.lib,r=k.WordArray,k=k.Hasher,p=j.algo,h=[];(function(){for(var b=0;64>b;b++)h[b]=4294967296*o.abs(o.sin(b+1))|0})();p=p.MD5=k.extend({_doReset:function(){this._hash=r.create([1732584193,4023233417,
2562383102,271733878])},_doProcessBlock:function(b,f){for(var a=0;16>a;a++){var e=f+a,c=b[e];b[e]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360}for(var e=this._hash.words,c=e[0],d=e[1],g=e[2],i=e[3],a=0;64>a;a+=4)16>a?(c=q(c,d,g,i,b[f+a],7,h[a]),i=q(i,c,d,g,b[f+a+1],12,h[a+1]),g=q(g,i,c,d,b[f+a+2],17,h[a+2]),d=q(d,g,i,c,b[f+a+3],22,h[a+3])):32>a?(c=l(c,d,g,i,b[f+(a+1)%16],5,h[a]),i=l(i,c,d,g,b[f+(a+6)%16],9,h[a+1]),g=l(g,i,c,d,b[f+(a+11)%16],14,h[a+2]),d=l(d,g,i,c,b[f+a%16],20,h[a+3])):48>a?(c=
m(c,d,g,i,b[f+(3*a+5)%16],4,h[a]),i=m(i,c,d,g,b[f+(3*a+8)%16],11,h[a+1]),g=m(g,i,c,d,b[f+(3*a+11)%16],16,h[a+2]),d=m(d,g,i,c,b[f+(3*a+14)%16],23,h[a+3])):(c=n(c,d,g,i,b[f+3*a%16],6,h[a]),i=n(i,c,d,g,b[f+(3*a+7)%16],10,h[a+1]),g=n(g,i,c,d,b[f+(3*a+14)%16],15,h[a+2]),d=n(d,g,i,c,b[f+(3*a+5)%16],21,h[a+3]));e[0]=e[0]+c|0;e[1]=e[1]+d|0;e[2]=e[2]+g|0;e[3]=e[3]+i|0},_doFinalize:function(){var b=this._data,f=b.words,a=8*this._nDataBytes,e=8*b.sigBytes;f[e>>>5]|=128<<24-e%32;f[(e+64>>>9<<4)+14]=(a<<8|a>>>
24)&16711935|(a<<24|a>>>8)&4278255360;b.sigBytes=4*(f.length+1);this._process();b=this._hash.words;for(f=0;4>f;f++)a=b[f],b[f]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360}});j.MD5=k._createHelper(p);j.HmacMD5=k._createHmacHelper(p)})(Math);
var TGH5,__extends=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+(n+"")+" is not a constructor or null");e(t,n),t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),__spreadArray=this&&this.__spreadArray||function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)if(s||!(r in t))s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r];return e.concat(s||Array.prototype.slice.call(t))};(function(e){e.VERSION="5.252"})(TGH5||(TGH5={})),Function.prototype.bind||(Function.prototype.bind=function(e){var t,n,r,i;if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");return t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r?this:e,t.concat(Array.prototype.slice.call(arguments)))},r.prototype=this.prototype,i.prototype=new r,i}),function(e){function o(t){this._messageListener=new e.IFrame.MessageListener(t,function(n,r){n==e.IFrame.Messages.console&&typeof t.console[r.type]=="function"&&t.console[r.type](r.message)})}var t,n,r,i,s;(function(e){e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Log=3]="Log",e[e.Debug=4]="Debug"})(t=e.LogLevel||(e.LogLevel={})),e._RegisterOwnerConsoleListener=o,n=function(){function e(){}return e.prototype.log=function(e){},e.prototype.debug=function(e){},e.prototype.warn=function(e){},e.prototype.error=function(e){},e.prototype.show=function(){},e.prototype.hide=function(){},e.prototype.dir=function(e){},e}(),e.EmptyConsole=n,r=function(){function e(){typeof console!="undefined"&&console&&typeof console.log=="function"&&(this.log=function(e){return console.log(e)},console.debug?this.debug=function(e){return console.debug(e)}:this.debug=function(e){return console.log(e)},console.warn?this.warn=function(e){return console.warn(e)}:this.warn=function(e){return console.log(e)},console.error?this.error=function(e){return console.error(e)}:this.error=function(e){return console.log(e)},console.dir?this.dir=function(e){return console.dir(e)}:this.dir=function(e){return console.log(e)})}return e.prototype.log=function(e){},e.prototype.debug=function(e){},e.prototype.warn=function(e){},e.prototype.error=function(e){},e.prototype.show=function(){},e.prototype.hide=function(){},e.prototype.dir=function(e){},e}(),e.NativeConsole=r,i=function(){function e(e){this._root=document.createElement("div"),this._textNode=document.createTextNode(""),this._root.appendChild(this._textNode),this._text="",this._level=0,e.appendChild(this._root)}return e.prototype.setText=function(e,t){this._level=t,this._text=e,this._update()},e.prototype._update=function(){this._textNode.nodeValue=this._text,this._root.style.color=e.COLOR_LEVELS[this._level-1]},e.prototype.duplicate=function(e){this._level=e._level,this._text=e._text,this._update()},e.COLOR_LEVELS=["red","khaki","white","chartreuse"],e}(),s=function(){function e(t,n,r,s,o,u){this._root=document.createElement("div"),this._root.id="console"+Math.random(),this._root.className="tgh5-console",this._root.style.top=(n?n:14)+"px",this._root.style.left=(t?t:24)+"px",typeof o=="number"&&(this._root.style.width=o+"px"),this._numLines=r?r:e.DEFAULT_MAX_LINES,this._parent=u?u:document.body,this._maxLevel=s?s:4,this._lines=Array(this._numLines),this._currentLine=0;for(var a=0;a<this._numLines;a++)this._lines[a]=new i(this._root);this._parent.appendChild(this._root)}return e.prototype.addText=function(e,t){if(t>this._maxLevel)return;if(this._currentLine>=this._numLines-1)for(var n=0;n<this._numLines-1;n++)this._lines[n].duplicate(this._lines[n+1]);var r=this._lines[this._currentLine];r.setText(e,t),this._currentLine<this._numLines-1&&this._currentLine++},e.prototype.log=function(e){this.addText(e,t.Log)},e.prototype.debug=function(e){this.addText(e,t.Debug)},e.prototype.warn=function(e){this.addText(e,t.Warn)},e.prototype.error=function(e){this.addText(e,t.Error)},e.prototype.show=function(){this._root.style.display="block"},e.prototype.hide=function(){this._root.style.display="none"},e.prototype.dir=function(e){if(typeof e=="undefined")this.log("undefined");else if(e===null)this.log("null");else for(var t in e)e.hasOwnProperty(t)&&this.log(t+":"+e[t])},e.DEFAULT_MAX_LINES=20,e}(),e.Console=s}(TGH5||(TGH5={})),function(e){var t;(function(t){function b(t,n){var r=null,i=t.sdkSettings.reporting,s=t.getProductSettings(t.productId),o=function(e,n){if(!e)return;for(var r in e){if(!e.hasOwnProperty(r))continue;t.isObject(e[r])?(typeof n[r]=="undefined"&&(n[r]={}),o(e[r],n[r])):t.isArray(e[r])?(typeof n[r]=="undefined"&&(n[r]=[]),o(e[r],n[r])):n[r]=e[r]}};s&&s.reporting&&o(s.reporting,i);if(!i.enabled||e.Api.locationGetParam("ga")=="0"){i.enabled=!1,n(null);return}typeof i.samplingRate=="number"&&Math.random()>i.samplingRate&&(t.console.log("Reportingevents disabled by samplingRate: "+i.samplingRate),m=!0),t.getSystem().getUserUID().done(function(i){i?(r=new e.Reporting.ReportingManager(t),r.init(i,function(){n(r)})):n(null)}).fail(function(){n(null)})}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y=function(){function e(){}return e.platform="dimension1",e.adVendor="dimension2",e.adType="dimension3",e.adProvider="dimension4",e.creator="dimension5",e.userAgent="dimension6",e.appType="dimension7",e.adTagName="dimension8",e}();t.Dimensions=y,n=function(){function e(){}return e.Ads="ads",e.Click="click",e.App="app",e.Geo="geo",e.Errors="errors",e.System="system",e.Focus="focus",e.Payment="payment",e.Poll="poll",e.CrossPromotion="cross-promotion",e}(),t.EventCategory=n,r=function(){function e(){}return e.Loaded="loaded",e.Ended="ended",e.SeeAll="see-all",e.Version="version",e.Brightdata="brightdata",e}(),t.AppEvents=r,i=function(){function e(){}return e}(),t.Screen=i,s=function(){function e(){}return e.requestAd="request",e.responseAd="response",e.impression="impression",e.completed="completed",e.requestToPlayAd="request-to-play",e.responsePodsAd="pods-response-",e.startedPodsAd="pods-started-",e.clickThrough="clickThrough",e.skipAd="skipAd",e}(),t.Ads=s,o=function(){function e(){}return e.requestGeo="request-geo",e.requestIp="request-ip",e.responseGeo="response-geo",e.responseIp="response-ip",e.timeout="timeout",e.unknownCountry="unknown-country",e.unknownIp="unknown-ip",e}(),t.Geo=o,u=function(){function e(){}return e.system="system",e.scriptTimeOut="script-time-out",e.textFileError="text-file",e.loadingError="loading",e.musicError="music",e.soundError="sound",e.videoError="video",e.unsupportedMedia="unsupported-media",e.localStorageError="local-storage",e.cookieError="cookie",e.remoteStorageError="remote-storage",e.fileSystemError="file-system",e.adsError="ads",e.paymentError="payment",e.socialError="social",e.configuration="configuration",e.serverRequestError="server-request",e}(),t.Errors=u,a=function(){function e(){}return e.userAgent="user-agent",e.version="version",e}(),t.System=a,f=function(){function e(){}return e.Started="started",e.Finished="finished",e.ViewedTime="viewed-time",e.NextVideoPlay="next-video-play",e.OpenVideo="open-video",e.FirstOpened="first-opened",e}(),t.Video=f,l=function(){function e(){}return e.Success="success",e.BuyOption="buy-option",e.Cancel="cancel",e.Failed="failed",e.Shop="shop",e.Status="status",e.PlayDemoOption="play-demo-option",e.NoThanksOption="no-thanks-option",e.Unsubscribe="unsubscribe",e.UnsubscribeOption="unsubscribe-option",e.CancelUnsubscribe="cancel-unsubscribe",e.RestoreSubscription="restore-subscription",e.PaymentStarted="payment-started",e}(),t.Payment=l,c=function(){function e(){}return e.AfterLoading="after-loading",e.InGame="in-game",e.SelectLevel="select-level",e.TopScores="top-scores",e.Profile="profile",e.MainScreen="main-screen",e.AdScreen="ad-screen",e}(),t.PaymentEventStatus=c,h=function(){function e(){}return e.Skipped="skipped",e.Started="started",e.Finished="finished",e.Answer="answer",e}(),t.PollEventType=h,p=function(){function e(){}return e.Launch="launch",e.WatchNow="watch-now",e}(),t.CrossPromotion=p,d=function(){function e(){}return e.Accept="accept",e.Decline="decline",e.Enabled="enabled",e.DialogShown="dialog-shown",e.Cancel="cancel",e}(),t.BrightData=d,v=function(){function e(e,t,n,r){this._userId=t,this._analyticsId=e,this._sessionId=""+(Date.now()/1e3|0),this._pageTitle=n,this._sessionHitsCount=1,this._sessionNumber=r,this._time=Date.now()}return e.prototype.sendEvent=function(e,t,n,r){var i=new XMLHttpRequest;i.open("POST",this._getUrl(e,t,n,r)),i.setRequestHeader("Content-type","text/plain"),i.send()},e.prototype._getUrl=function(t,n,r,i){var s={};s.v="2",s.tid=this._analyticsId,s._p=""+(Math.random()*1e8|0),s.cid=this._userId,s.ul="en",s.sr="1280x720",s.dt=this._pageTitle,s.dl=location.pathname,s.sid=this._sessionId,s.seg=r?"1":"0",s._s=""+this._sessionHitsCount,s.sct=""+this._sessionNumber;var o=Date.now();s._et=""+(o-this._time),this._time=o,this._sessionHitsCount===1&&i&&(s._ss="1",s._fv="1"),this._sessionHitsCount++,s.en=t;var u=[];for(var a in s)s.hasOwnProperty(a)&&u.push(a+"="+encodeURIComponent(s[a]));for(var a in n)n.hasOwnProperty(a)&&u.push("ep."+a+"="+encodeURIComponent(n[a]));return e.API_URL+"?"+u.join("&")},e.API_URL="https://www.google-analytics.com/g/collect",e}(),m=!1,t.createReportManager=b,g=function(){function r(e){this._api=e,this._appStarted=!1,this._settings=e.sdkSettings.reporting,this._dimensionsOverride={},this._isUserActive=!0}return r.prototype._initialize=function(e,t){var n=this;this._ga4sender=new v(e,t,this._getTitle(),this._api.sdkSettings.cachedSettings.sessionCount);var r={};r[y.platform]=this._api.getPlatformName();var i=this._api.getApplicationType();i||(i="game"),r[y.appType]=i;if(this._dimensionsOverride&&r)for(var s in r)r.hasOwnProperty(s)&&this._dimensionsOverride[s]&&(r[s]=this._dimensionsOverride[s]);r.page_title=this._getTitle(),this._api.addOnPauseResumeListener(function(e){n._isUserActive=!e}),this._ga4sender.sendEvent("page_view",r,this._isUserActive,this._api.isNewUser())},r.prototype.init=function(e,t){var n=this;this._initDimensionsOverride(function(){if(n._api.isArray(n._settings.analyticsId)){var r=n._settings.analyticsId,i=r[0].id;n._api.requestCountryCode().done(function(t){if(typeof t=="string")for(var s=0;s<r.length;s++)if(r[s].country.toLowerCase()===t.toLowerCase()){i=r[s].id;break}n._initialize(i,e)}).fail(function(){n._initialize(i,e)})}else n._initialize(n._settings.analyticsId,e);t()})},r.prototype.reportPollEvent=function(e,t,r,i){var s=t;typeof r=="number"&&(s+="-q_"+r),typeof i=="number"&&(s+="-a_"+i),this.reportEvent(n.Poll,e,s)},r.prototype.reportAppEvent=function(e,t){this.reportEvent(n.App,e,t)},r.prototype.reportEvent=function(e,t,n,r,i){if(m&&this._settings.samplingEvents&&this._settings.samplingEvents[e]&&this._settings.samplingEvents[e].indexOf(t)>=0)return;if(this._settings.bannedEvents&&this._settings.bannedEvents[e]&&this._settings.bannedEvents[e].indexOf(t)>=0)return;this._api.console.debug("Rep: category: "+e+", action: "+t+(n?", label "+n:"")),typeof r=="undefined"&&(r=0),i=i||{},i[y.platform]=this._api.getPlatformName();var s=this._api.getApplicationType();s&&(i[y.appType]=s);if(this._dimensionsOverride&&i)for(var o in i)i.hasOwnProperty(o)&&this._dimensionsOverride[o]&&(i[o]=this._dimensionsOverride[o]);e&&(i.event_category=e),n&&(i.event_label=n),i.event_value=r,this._ga4sender.sendEvent(t,i,this._isUserActive)},r.prototype._initDimensionsOverride=function(e){var t=this;if(this._settings.dimensionsOverride){var n=this._settings.dimensionsOverride,r=0,i=0;for(var s in n){if(!n.hasOwnProperty(s))continue;r++,typeof n[s]=="string"&&(i++,y.hasOwnProperty(s)&&(this._dimensionsOverride[y[s]]=n[s]))}if(r==i){e();return}this._api.requestCountryCode().always(function(r){for(var i in n){if(!n.hasOwnProperty(i)||!t._api.isArray(n[i]))continue;var s=n[i],o=s[0].value;if(typeof r=="string")for(var u=0;u<s.length;u++)if(s[u].country==r.toLowerCase()){o=s[u].value;break}for(var a in y)y.hasOwnProperty(a)&&a==i&&(t._dimensionsOverride[y[a]]=o)}e()})}else e()},r.prototype.reportClickEvent=function(e,t){this.reportEvent(n.Click,e,t,0)},r.prototype.reportPaymentEvent=function(e,t,r){this.reportEvent(n.Payment,e,t,r)},r.prototype.reportSystemEvent=function(e,t){this.reportEvent(n.System,e,t,0)},r.prototype.reportFocusEvent=function(e,t){this.reportEvent(n.Focus,e,t,0)},r.prototype.reportGeoEvent=function(e,t,r){this.reportEvent(n.Geo,e,t,0)},r.prototype.reportCrossPromotionEvent=function(e,t){this.reportEvent(n.CrossPromotion,e,t)},r.prototype.reportErrorEvent=function(e,t){var r={};window&&window.navigator&&(r[y.userAgent]=window.navigator.userAgent),this.reportEvent(n.Errors,e,t,0,r)},r.prototype.reportAdErrorEvent=function(e,r){var i={};i[y.adVendor]=r.vendorName,i[y.adType]=r.event,i[y.adProvider]=r.name,window&&window.navigator&&(i[y.userAgent]=window.navigator.userAgent),this.reportEvent(n.Errors,t.Errors.videoError,e,0,i)},r.prototype.reportAdImpression=function(t,r,i){var s=0;i&&(s=parseFloat(i),isNaN(s)&&(s=0));var o=this._api.sdkSettings.reporting;if(typeof o.samplingRate=="number"){var u=n.Ads,a=e.Reporting.Ads.impression;o.samplingEvents&&o.samplingEvents[u]&&this._settings.samplingEvents[u].indexOf(a)>=0&&(s/=o.samplingRate)}s=s*10|0,this.reportAdEvent(e.Reporting.Ads.impression,t,r,s)},r.prototype._getTitle=function(){return this._api.productSettings.title.replace(/&.*;/,"")},r.prototype.reportAdEvent=function(t,r,i,s){if(r&&r.className||t===e.Reporting.Ads.requestToPlayAd){var o={};r&&r.vendorName&&(o[y.adVendor]=r.vendorName),r&&r.creator&&(o[y.creator]=r.creator),o[y.adType]=i,r&&r.name&&(o[y.adProvider]=r.name),r&&r.adTagName&&(o[y.adTagName]=r.adTagName);var u=r&&r.name?r.name:"";t===e.Reporting.Ads.requestToPlayAd&&(u=this._getTitle()),this.reportEvent(n.Ads,t,u,s,o)}},r}(),t.ReportingManager=g})(t=e.Reporting||(e.Reporting={}))}(TGH5||(TGH5={})),function(e){var t=function(){function e(e,t,n){this._state="pending",this._failCallbacks=[],this._doneCallbacks=[],this._progressCallbacks=[],this._api=e,this._thisArg=n,t!==undefined&&this.resolve(t)}return e.error=function(t,n){return(new e(t)).reject(n)},e.prototype.always=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];return this.isPending()?this.addUniqueCallbacks(e,this._doneCallbacks,this._failCallbacks):this._state=="rejected"?this.applyAndPrune(e,this._rejectArguments):this._state=="resolved"&&this.applyAndPrune(e,this._resolveArguments),this},e.prototype.done=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];return this.isPending()?this.addUniqueCallbacks(e,this._doneCallbacks):this._state=="resolved"&&this.applyAndPrune(e,this._resolveArguments),this},e.prototype.fail=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];return this.isPending()?this.addUniqueCallbacks(e,this._failCallbacks):this._state=="rejected"&&this.applyAndPrune(e,this._rejectArguments),this},e.prototype.then=function(e,t){return this.isPending()?(this.addUniqueCallbacks([e],this._doneCallbacks),this.addUniqueCallbacks([t],this._failCallbacks)):this._state=="rejected"?this.applyAndPrune(this._failCallbacks,this._rejectArguments):this._state=="resolved"&&this.applyAndPrune(this._doneCallbacks,this._resolveArguments),this},e.prototype.notify=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];return this.applyAndPrune(this._progressCallbacks,e,!1)},e.prototype.progress=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];return this.addUniqueCallbacks(e,this._progressCallbacks)},e.prototype.reject=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.isPending()){if(this._api.console){var n=e.join("");n.length>0&&this._api.console.debug("Reject by: "+n)}return this._state="rejected",this.applyAndPrune(this._failCallbacks,this._rejectArguments=e)}return this},e.prototype.resolve=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];return this.isPending()?(this._state="resolved",this.applyAndPrune(this._doneCallbacks,this._resolveArguments=e)):this},e.prototype.isPending=function(){return this._state=="pending"},e.prototype.state=function(){return this._state},e.prototype.reset=function(){this._state="pending"},e.prototype.applyAndPrune=function(e,t,n){for(var r=0;r<e.length;r++)e[r].apply(this._thisArg?this._thisArg:null,t);return n!==!1&&(e.length=0),this},e.prototype.addUniqueCallbacks=function(e){var t=[];for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r;for(var i=0;i<t.length;i++)for(var s=0;s<e.length;s++)r=t[i].indexOf(e[s]),r<0&&t[i].push(e[s]);return this},e}();e.Deferred=t}(TGH5||(TGH5={})),function(e){var t;(function(e){var t=function(){function e(e,t,n,r,i){this.api=e,this.name=t,this.settings=n,this.className=r,this.event=i}return e.prototype.toString=function(){return this.className},e.prototype.startPreload=function(){},e.prototype.reportClickThrough=function(){return!0},e.prototype.reportRequestAd=function(){return!0},e.prototype.reportResponseAd=function(){return!0},e.prototype.reportError=function(){return!0},e.prototype.reportCompleted=function(){return!0},e.prototype.reportImpression=function(){return!0},e.prototype.show=function(){return null},e.prototype.needToStopMusic=function(){return!1},e.prototype.onStart=function(){},e.prototype.onError=function(e,t){},e.prototype.onFinish=function(){},e.prototype.showInstruction=function(e){return!0},e.prototype.needDisableUserInput=function(){return!0},e.prototype.isAdExists=function(){return!1},e.prototype.release=function(){},e.prototype.stopPlayingAd=function(){},e.prototype.isStopPlayingAdAllowed=function(){return!1},e}();e.Vendor=t})(t=e.Ads||(e.Ads={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function t(e){this._api=e,this._api.productSettings.catapultX?this._settings=this._api.productSettings.catapultX:this._api.sdkSettings.adsSettings.catapultX?this._settings=this._api.sdkSettings.adsSettings.catapultX:this._settings={enabled:!1},this._enabled=this._settings.enabled}return t.prototype.disable=function(){this._enabled=!1},t.prototype.start=function(n){var r=this;this._deferred=new e.Deferred(this._api);if(this._enabled){var i=document.getElementById(this._settings.videoContainerId);if(!i){var s="CatapultX: Not found video container: "+this._settings.videoContainerId;this._api.console.error(s),this._deferred.reject(s)}else{var o=this._settings.libUrl+"?group-id="+this._settings.groupId+"&video-container="+(n?n:this._settings.videoContainerId);this._api.loadScript(o,this._settings.loadLibTimeout?this._settings.loadLibTimeout:t.DEFAULT_LOAD_LIB_TIMEOUT).done(function(){r._deferred.resolve()}).fail(function(){r._deferred.reject("CatapultX: Can't load lib: "+o)})}}else this._deferred.reject("CatapultX not found or disabled");return this._deferred},t.DEFAULT_LOAD_LIB_TIMEOUT=15e3,t}();t.CatapultX=n})(t=e.Ads||(e.Ads={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n,r;(function(e){e.PreRoll="pre-roll",e.MidRoll="mid-roll",e.PostRoll="post-roll",e.Rewarded="rewarded"})(n=t.Type||(t.Type={})),r=function(){function r(n){this._api=n,this._settings=this._api.sdkSettings.adsSettings,this._lastPlayedRequestTime=-1,this._lastRequestTime=-1,this._lastR2PTime=-1,this._loadingBar=null,this._currentVendor=null,this._adBaseEl=null,this._paymentMode=!1,this._disabled=!1,this._canvasElements=[],this._disabledTypes=[],this._preloadStarted=!1,this._wrongInputEl=null,this._wrongInputTimeout=null,this._currentKeyDown=null,this._settings&&this._api.isArray(this._settings.ads)&&(this._settings.ads=this._getByProbability(this._settings.ads).ads);var r=this._api.productSettings;r.ads&&this._api.isArray(r.ads)&&(this._settings.ads=this._getByProbability(r.ads).ads),this._catapultXManager=new t.CatapultX(this._api),this._detectAdBlock(),e.Api.locationGetParam("ads")=="0"&&this.disable()}return r.prototype._getByProbability=function(e){var t=Math.random()*100,n=0;for(var r=0;r<e.length;r++){n+=e[r].probability;if(n>t||r==e.length-1)return e[r]}return e[0]},r.prototype._vendorIsAllowed=function(e){var t=this._api.productSettings.ads;if(!this._settings.adVendors)return!1;if(!this._settings.adVendors[e])return!1;if(this._settings.adVendors[e].disabled===!0)return!1;if(t&&t.allowed&&typeof t.allowed[this._type]!="undefined"){var n=t.allowed[this._type];return typeof n=="string"?n===e:this._api.isArray(n)?n.indexOf(e)>=0:n}return!0},r.prototype._vendorRequiredCountryCode=function(e){return e.indexOf("%c")>=0},r.prototype._getVendorsConfig=function(e){var t=this._settings.ads[e],n=this._api.productSettings.ads;if(n&&n.override){var r=n.override;typeof r[e]!="undefined"&&(t=r[e])}return t},r.prototype._getVendorNames=function(){var e=this._getVendorsConfig(this._type);this._vendorNames=[];if(this._api.isArray(e))this._vendorNames=e.slice(0);else{if(typeof e!="string")return!1;this._vendorNames.push(e)}for(var t=this._vendorNames.length-1;t>=0;t--){var n=this._vendorNames[t];!this._vendorRequiredCountryCode(n)&&!this._vendorIsAllowed(n)&&this._vendorNames.splice(t,1)}return this._vendorNames.length!=0},r.prototype._showAd=function(t){var n=this;this._adStarted=!1;var r=this._settings.adVendors[t];this._currentVendor=new e.Ads.Vendors[r.className](this._api,t,r,this._type),this._currentVendor.reportRequestAd()&&this._api.reportAdEvent(e.Reporting.Ads.requestAd,this._currentVendor,this._type),this._currentVendor.onFinish=function(){n._finished=!0,n._lastPlayedRequestTime=Date.now(),n._currentVendor&&n._currentVendor.reportCompleted()&&n._adStarted&&n._api.reportAdEvent(e.Reporting.Ads.completed,n._currentVendor,n._type),n.suspend(n._adStarted)},this._currentVendor.onError=function(e,t){n._currentVendor&&n._currentVendor.reportError()&&n._api.reportAdErrorEvent(e,n._currentVendor),t&&(n._lastPlayedRequestTime=Date.now(),n._finished=!0,n.suspend(n._adStarted))},this._currentVendor.onStart=function(){n._adStarted=!0,n._settings.hideCanvasBeforePlay===!0&&n._hideCanvasElements(),n._loadingBar&&(n._loadingBar.suspend(),n._loadingBar=null),n._currentVendor&&n._currentVendor.reportResponseAd()&&n._api.reportAdEvent(e.Reporting.Ads.responseAd,n._currentVendor,n._type),n._currentVendor&&n._currentVendor.reportImpression()&&n._api.reportAdEvent(e.Reporting.Ads.impression,n._currentVendor,n._type,1)},!this._restoreInput&&this._currentVendor.needDisableUserInput()&&(this._api.getKeyManager().setEnabled(!1,e.Key.ListenerType.Product,e.Key.EventType.Any),this._restoreInput=!0),this._settings.skipAdAllowed&&(this._api.getKeyManager().addListener(e.Key.ListenerType.System,e.Key.EventType.KeyDown,this._onKeyDownHandler,this),this._api.getKeyManager().addListener(e.Key.ListenerType.System,e.Key.EventType.KeyUp,this._onKeyUpHandler,this),this._api.getKeyManager().setEnabled(!0,e.Key.ListenerType.System,e.Key.EventType.Any)),this._api.getAudioManager().cleanup().always(function(){!n._restoreMusic&&n._currentVendor.needToStopMusic()&&n._api.isMusicPlaying()?(n._restoreMusic=!0,n._api.stopMusic().always(function(){n._currentVendor.show().always(function(){n._requestNextVendor()})})):(!n._restoreMusic&&n._currentVendor.needToStopMusic()&&(n._restoreMusic=!0),n._currentVendor.show().always(function(){n._requestNextVendor()}))})},r.prototype._requestNextVendor=function(){var e=this;if(this._finished)return;if(this._currentVendorId>=this._vendorNames.length){this.suspend(!1);return}var t=this._vendorNames[this._currentVendorId++];this._api.console.log("request vendor: "+t),this._vendorRequiredCountryCode(t)?(this._api.console.log("request Country Code for vendor: "+t),this._api.requestCountryCode().done(function(n){e._api.console.log("Country code: "+n);var r=t.replace("%c",n.toLowerCase());e._vendorIsAllowed(r)?e._showAd(r):e._requestNextVendor()}).fail(function(){e._api.console.log("Country code request fail"),e._requestNextVendor()})):this._showAd(t)},r.prototype._hideCanvasElements=function(){this._canvasElements.length=0;var e=document.getElementsByTagName("canvas");for(var t=0;t<e.length;t++){var n={};n.el=e[t],n.el.style.display!="none"&&(n.visibility=!0),n.el.style.visibility="hidden",this._canvasElements.push(n)}},r.prototype._restoreCanvasElements=function(){for(var e=0;e<this._canvasElements.length;e++){var t=this._canvasElements[e];if(!t.el)return;t.visibility&&(t.el.style.visibility="visible")}},r.prototype.release=function(){this._adBaseEl&&this._adBaseEl.parentNode&&(this._adBaseEl.parentNode.removeChild(this._adBaseEl),this._adBaseEl=null),this._wrongInputEl&&this._wrongInputEl.parentNode&&(this._wrongInputEl.parentNode.removeChild(this._wrongInputEl),this._wrongInputEl=null),this._loadingBar&&(this._loadingBar.suspend(),this._loadingBar=null),this._currentVendor&&(this._currentVendor.release(),this._currentVendor=null),this._finished=!0},r.prototype.suspend=function(t){this._paymentMode=!1,this._currentVendor=null,this.release(),this._settings.hideCanvasBeforePlay===!0&&this._restoreCanvasElements(),this._api.getKeyManager().removeListener(e.Key.ListenerType.System,e.Key.EventType.KeyUp,this._onKeyUpHandler),this._api.getMouseManager().removeListener(this._onMouseHandler),this._api.isExitFlow()||(this._restoreInput&&this._api.enableInput(),this._restoreMusic&&this._api.playMusic(),this._api.getAudioManager().restore()),this._deferred.resolve(t),this._api._onAdResponse()},r.prototype._clearWrongInputTimeout=function(){this._wrongInputTimeout&&(clearTimeout(this._wrongInputTimeout),this._wrongInputTimeout=null)},r.prototype._showWrongInputIcon=function(){var e=this;if(!this._wrongInputEl)return;this._clearWrongInputTimeout(),this._wrongInputEl.style.display="block",this._wrongInputTimeout=setTimeout(function(){e._wrongInputTimeout=null,e._wrongInputEl&&(e._wrongInputEl.style.display="none")},this._settings.wrongInputIconTime)},r.prototype._addWrongInputIcon=function(){this._settings.showWrongInputIcon===!0&&(typeof this._settings.wrongInputIconTime=="undefined"&&(this._settings.wrongInputIconTime=r.DEFAULT_WRONG_INPUT_ICON_TIME),this._wrongInputEl=document.createElement("div"),this._wrongInputEl.className="tgh5-not-available",this._wrongInputEl.style.display="none",document.body.appendChild(this._wrongInputEl))},r.prototype._addAdBasedControls=function(){if(!this._api.getPaymentManager().isAllowedSubscribeFromAds())return;this._adBaseEl=document.createElement("div"),this._adBaseEl.className="tgh5-adbased";var t=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div");t.className="tgh5-adbased-line",n.className="tgh5-adbased-arrow",n.innerHTML="&nbsp;",r.className="tgh5-adbased-text",r.innerHTML=this.getText("adBased"),this._adBaseEl.appendChild(t),t.appendChild(r),t.appendChild(n),document.body.appendChild(this._adBaseEl),this._api.getKeyManager().addListener(e.Key.ListenerType.System,e.Key.EventType.KeyUp,this._onKeyUpHandler,this),this._api.enableMouse(),this._api.getMouseManager().addListener(this._onMouseHandler,this)},r.prototype._startPayment=function(){var t=this;if(this._paymentMode)return;this._paymentMode=!0,this.release(),this._api.startPayment(e.Reporting.PaymentEventStatus.AdScreen+"_"+this._type).always(function(e){e===!0?t._type==n.PreRoll||t._type==n.MidRoll?t._api.launchApp(t._api.productId,!0):t.suspend(!0):t._startRequest()})},r.prototype._onMouseHandler=function(t){if(!this._currentVendor)return;t.type==e.Mouse.Event.MouseUp&&(this._api.reportAdEvent(e.Reporting.Ads.skipAd,this._currentVendor,this._type),this._startPayment())},r.prototype._onKeyDownHandler=function(e){if(!this._adStarted)return!1;this._currentKeyDown=e},r.prototype._onKeyUpHandler=function(t){if(!this._adStarted)return!1;if(!this._currentVendor||t!=this._currentKeyDown){this._currentKeyDown=null;return}return this._settings.skipAdAllowed===!0&&t==e.KeyNames.KEY_BACKSPACE&&this._currentVendor.isStopPlayingAdAllowed()?(this._adStarted=!1,this._currentVendor.stopPlayingAd(),!0):(this._settings.showWrongInputIcon===!0&&this._showWrongInputIcon(),this._currentKeyDown=null,!0)},r.prototype._startRequest=function(){var t=this;if(!this._getVendorNames()){this._checkIfNeedToStartPreload(this._type),this.suspend(!1);return}this._paymentMode=!1,this._deferred.notify("requestAd"),this._restoreInput=!1,this._finished=!1,this._currentVendorId=0,this._settings.disableLoadingBar!==!0&&(this._loadingBar=new e.LoadingProgressBar(this._api),this._loadingBar.create(document.body)),this._addWrongInputIcon(),this._addAdBasedControls(),this._api.processLater(function(){t._requestNextVendor()})},r.prototype.isLoadingBarDisabled=function(){return this._settings.disableLoadingBar==1},r.prototype.isEnabled=function(){return!this._disabled},r.prototype.disable=function(){this._disabled=!0,this._catapultXManager.disable()},r.prototype.startCatapult=function(e){this._catapultXManager.start(e)},r.prototype.startPreloadForRewarded=function(){if(!this.isEnabled())return;if(this._preloadStarted)return;this._type=n.Rewarded;if(this._getVendorNames())for(var t=0;t<this._vendorNames.length;t++){var r=this._vendorNames[t];if(this._vendorRequiredCountryCode(r))continue;var i=this._settings.adVendors[r],s=new e.Ads.Vendors[i.className](this._api,r,i,this._type);s.startPreload()}this._preloadStarted=!0},r.prototype.disablePerType=function(e){if(!e)return;for(var t=0;t<e.length;t++)this._disabledTypes.indexOf(e[t])<0&&this._disabledTypes.push(e[t])},r.prototype._getRequestFrequency=function(e){var t=this._api.productSettings.ads;return t&&t.adsRequestFrequency&&t.adsRequestFrequency[e]?t.adsRequestFrequency[e]:this._settings.adsRequestFrequency&&this._settings.adsRequestFrequency[e]?this._settings.adsRequestFrequency[e]:-1},r.prototype._convertTypeToOldStyle=function(e){switch(e){case n.PreRoll:return"preRoll";case n.MidRoll:return"inGame";case n.PostRoll:return"postRoll"}},r.prototype._getVideoFrequency=function(e){var t=this._api.productSettings.ads;return t&&t.adsVideoFrequency&&t.adsVideoFrequency[e]?t.adsVideoFrequency[e]:this._settings.adsVideoFrequency&&this._settings.adsVideoFrequency[e]?this._settings.adsVideoFrequency[e]:-1},r.prototype._checkIfAdExistsInVendor=function(t){var n=this._settings.adVendors[t],r=new e.Ads.Vendors[n.className](this._api,t,n,this._type);return r.isAdExists()},r.prototype.isAdExists=function(t){var n=this,r=new e.Deferred(this._api);if(this._disabled||this._isAdSkippedByFrequency(t)||this._disabledTypes.indexOf(t)>=0)return r.resolve(!1),r;var i=function(e,t){if(e>=n._vendorNames.length){t(!1);return}var r=n._vendorNames[e];n._vendorRequiredCountryCode(r)?(n._api.console.log("request Country Code for vendor: "+r),n._api.requestCountryCode().done(function(s){n._api.console.log("Country code: "+s);var o=r.replace("%c",s.toLowerCase());n._vendorIsAllowed(o)&&n._checkIfAdExistsInVendor(o)?t(!0):i(e+1,t)}).fail(function(){n._api.console.log("Country code request fail"),i(e+1,t)})):n._vendorIsAllowed(r)&&n._checkIfAdExistsInVendor(r)?t(!0):i(e+1,t)};return i(0,function(e){r.resolve(e)}),r},r.prototype._isR2PSkippedByFrequency=function(e){var t=this._getVideoFrequency(e);return t>0&&Date.now()-this._lastR2PTime<t?(this._api.console.debug("R2P Skipped by ads frequency: "+t),!0):!1},r.prototype._isAdSkippedByFrequency=function(e){var t=this._getVideoFrequency(e);if(t>0&&Date.now()-this._lastPlayedRequestTime<t)return this._api.console.debug("Skipped by ads frequency: "+t),!0;var n=this._getRequestFrequency(e);return n>0&&Date.now()-this._lastRequestTime<n?(this._api.console.debug("Skipped by request frequency: "+n),!0):!1},r.prototype._checkIfNeedToStartPreload=function(e){e==n.PreRoll&&(this._type=e,this.startPreloadForRewarded())},r.prototype.requestAds=function(t,r){if(this._disabledTypes.indexOf(t)<0)return this._type=t,this._placement=r||t,this._deferred=new e.Deferred(this._api),this._restoreMusic=!1,this._api.processLater(function(){var r=this;if(this._disabled){this.suspend(!1);return}if(this._isAdSkippedByFrequency(t)){this.suspend(!1);return}this._getVendorNames()&&(t===n.Rewarded?this._api.reportAdEvent(e.Reporting.Ads.requestToPlayAd,null,t):this._isR2PSkippedByFrequency(t)||(this._lastR2PTime=Date.now(),this._api.reportAdEvent(e.Reporting.Ads.requestToPlayAd,null,t))),this._lastRequestTime=Date.now(),this._api.getKeyManager().waitKeyUp().always(function(){r._api.getPaymentManager().isAdsAllowed().always(function(e){e===!0?r._startRequest():(r._checkIfNeedToStartPreload(t),r.suspend(!1))})})},this),this._deferred;var i=new e.Deferred(this._api);return i.resolve(!1),i},r.prototype.formatText=function(e){if(e.indexOf("[producttitle]")>=0){var t=this._api.productSettings.title;if(t)return e.replace("[producttitle]",t)}return e},r.prototype.getText=function(t){var n=this._api.sdkSettings.adsSettings.adsInstruction;if(n&&n[t]){var r=n[t],i=r[this._api.productId];i||(i=r["default"]),r["short"]&&r["short"].models&&e.System.testBoxModel(r["short"].models)?i=r["short"]:r["short"]&&this._api.productSettings&&this._api.productSettings.ads&&this._api.productSettings.ads.instructions&&this._api.productSettings.ads.instructions.useShort&&(this._api.productSettings.ads.instructions.models?e.System.testBoxModel(this._api.productSettings.ads.instructions.models)&&(i=r["short"]):i=r["short"]);if(i){var s=i[this._api.getLanguage()];s||(s=i.en);if(s)return this.formatText(s)}}return""},r.prototype.prepareAdURL=function(t,n){var i=this,s=new e.Deferred(this._api),o=function(t,n){t.indexOf(r.IP6_ADDRESS_TAG)<0?n(t):i._api.requestIp6Address().done(function(i){t=e.Api.replaceAll(t,r.IP6_ADDRESS_TAG,i),n(t)}).fail(function(){t=e.Api.replaceAll(t,r.IP6_ADDRESS_TAG,e.Geo.GeoManager.DEFAULT_IP6_ADDRESS),n(t)})},u=function(t,n){t.indexOf(r.IP_ADDRESS_TAG)<0?n(t):i._api.requestIpAddress().done(function(i){t=e.Api.replaceAll(t,r.IP_ADDRESS_TAG,i),n(t)}).fail(function(){t=e.Api.replaceAll(t,r.IP_ADDRESS_TAG,e.Geo.GeoManager.DEFAULT_IP_ADDRESS),n(t)})},a=function(t,n){t.indexOf(r.GOOGLE_PAL)<0?n(t):i._api.getSystem().getGooglePALSDKEncryptedString().always(function(i){t=e.Api.replaceAll(t,r.GOOGLE_PAL,i?i:""),n(t)})},f=function(t,n){t.indexOf(r.DEVICE_ID_TAG)<0?n(t):i._api.getSystem().getCustomerUID().always(function(i){t=e.Api.replaceAll(t,r.DEVICE_ID_TAG,i),n(t)})};t=t.replace(r.USER_AGENT_TAG,encodeURIComponent(this._api.getSystem().getUserAgent())),t=e.Api.replaceAll(t,r.PRODUCT_ID_TAG,this._api.productId),t=e.Api.replaceAll(t,r.FORMATTED_PRODUCT_ID_TAG,this._api.productId.replace(/_/g,"")),t=e.Api.replaceAll(t,r.PLATFORM,this._api.getPlatformName()),t=e.Api.replaceAll(t,r.IFA_ID,this._api.getSystem().getAdIFAId()),t=e.Api.replaceAll(t,r.SPS_SESSION_ID,this._api.getSystem().getSPSSessionId()),t=e.Api.replaceAll(t,r.IFA_TYPE,this._api.getSystem().getAdIFAType()),t=e.Api.replaceAll(t,r.LMT,this._api.getSystem().getAdLmt()),t=e.Api.replaceAll(t,r.LANGUAGE,this._api.getLanguage()),t=e.Api.replaceAll(t,r.GENRE,this._api.productSettings.genre),t=e.Api.replaceAll(t,r.RATING,this._api.productSettings.rating),t=e.Api.replaceAll(t,r.COPPA,this._api.productSettings.coppa),t=e.Api.replaceAll(t,r.BUNDLE,this._api.productSettings.bundle);var l=e.Api.locationGetParam("us_privacy");return t=e.Api.replaceAll(t,r.US_PRIVACY,l?l:""),n||(t=e.Api.replaceAll(t,r.RANDOM_NUMBER_TAG,""+Math.floor(Math.random()*1e9))),t=e.Api.replaceAll(t,r.GDPR,this._api.getGDPRManager().getString()),t=e.Api.replaceAll(t,r.APP_COMPLETE_URL,encodeURIComponent(location.href)),t=e.Api.replaceAll(t,r.APP_URL,encodeURIComponent(location.href?location.href.split("?")[0]:"")),f(t,function(e){u(e,function(e){o(e,function(e){a(e,function(e){s.resolve(e)})})})}),s},r.prototype.getCurrentPlacement=function(){return this._placement},r.prototype._detectAdBlock=function(){var e=this;if(this._disabled||!this._settings||!this._settings.detectAdBlock||!this._settings.detectAdBlock.enabled||!this._settings.detectAdBlock.url)return;var t=new XMLHttpRequest;t.open("HEAD",this._settings.detectAdBlock.url),t.onerror=function(){e._api.console.log("AdBlock is enabled, ads will be disabled!"),e.disable()},t.send()},r.IP_ADDRESS_TAG="[ip_address]",r.IP6_ADDRESS_TAG="[ip6_address]",r.RANDOM_NUMBER_TAG="[random]",r.USER_AGENT_TAG="[user_agent]",r.PRODUCT_ID_TAG="[product_id]",r.FORMATTED_PRODUCT_ID_TAG="[formatted_product_id]",r.DEVICE_ID_TAG="[device_id]",r.IFA_ID="[ifa_id]",r.SPS_SESSION_ID="[sps_session_id]",r.IFA_TYPE="[ifa_type]",r.LMT="[lmt]",r.US_PRIVACY="[us_privacy]",r.GDPR="[gdpr]",r.GOOGLE_PAL="[google_pal]",r.PLATFORM="[platform]",r.APP_COMPLETE_URL="[app_complete_url]",r.APP_URL="[app_url]",r.GENRE="[genre]",r.RATING="[rating]",r.COPPA="[coppa]",r.LANGUAGE="[language]",r.BUNDLE="[bundle]",r.DEFAULT_WRONG_INPUT_ICON_TIME=2e3,r}(),t.AdsManager=r})(t=e.Ads||(e.Ads={}))}(TGH5||(TGH5={})),function(e){function n(t){var n=new e.Deferred(t);return function(){return n.resolve(t.getLanguage()),n}}var t=function(){function t(t,n){this._api=t,this._allowedLanguage=[];for(var r in n)n.hasOwnProperty(r)&&t.sdkSettings.languages.indexOf(n[r])>=0&&this._allowedLanguage.push(n[r]);this._currentLanguage=t.sdkSettings.cachedSettings.languageCode;if(!this._currentLanguage){var i=e.Api.locationGetParam("language");i||(i=this._api.sdkSettings.defaultLanguage),i?(this._currentLanguage=i,this.flush()):this._currentLanguage=this.getBrowserLanguageCode()}if(!this._currentLanguage||this._allowedLanguage.indexOf(this._currentLanguage)<0)this._currentLanguage=this._allowedLanguage[0]}return t.formatDate=function(e,n){var r,i;typeof e=="string"?r=new Date(e):r=e;var s=t.monthNames[n]?t.monthNames[n]:t.monthNames.en;return i=s[r.getMonth()]+" "+r.getDate()+", "+r.getFullYear(),i},t.prototype.getLanguage=function(){return this._currentLanguage},t.prototype.setLanguage=function(e){if(e===this._currentLanguage)return!0;if(this._allowedLanguage.indexOf(e)<0)return this._api.console.warn("Unrecognized language: "+e),!1;this._currentLanguage=e,this.flush()},t.prototype.flush=function(){this._api.sdkSettings.cachedSettings.languageCode=this._currentLanguage,this._api.sdkSettings.cachedSettings.save()},t.prototype.getAllowedLanguages=function(){return this._allowedLanguage},t.prototype.getBrowserLanguageCode=function(){var e=navigator.language||navigator.userLanguage;return e?e=e.substr(0,2).toLowerCase():e="",e},t.monthNames={en:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],fr:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],de:["Jan.","Febr.","Mrz.","Apr.","Mai","Jun.","Jul.","Aug.","Sept.","Okt.","Nov.","Dez."],ru:["янв.","февр.","март","апр.","май","июнь","июль","авг.","сент.","окт.","нояб.","дек."],es:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sep.","oct.","nov.","dic."],nl:["jan.","feb.","mrt.","apr.","mei","jun.","jul.","aug.","sep.","okt.","nov.","dec."],pl:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],hu:["jan","feb","márc","ápr","máj","jún","júl","aug","szept","okt","nov","dec"],it:["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"]},t}();e.Language=t,e.calculatedLanguage=n}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function t(e,t){var n=this;this.playDeferred=null,this.stopDeferred=null,this._api=e,this._isPlaying=!1,this._errorTimeoutId=null,this._playTimeoutId=null,this._errorReportedCount=0,this._tracks=t,this._track=null,this._audio=null,this._autoLoop=!1,this._onAudioReadyCallback=function(e){n._disableCallbacks||n._onAudioReady(e)},this._onAudioEndCallback=function(e){n._disableCallbacks||n._onAudioEnd(e)},this._settings=this._api.sdkSettings.audioManager.settings,this._settings.loopSupported&&t&&t.length===1&&(this._autoLoop=!0),this._createAudio(),this._media=this._api.supportedMedia(this._audio,"audio",null,this._settings.notSupportedCanPlayType)}return t.prototype.isSupported=function(){return!!this._media&&this._tracks&&this._tracks.length>0},t.prototype.initialize=function(){},t.prototype.isInitialized=function(){return!0},t.prototype.isPlaying=function(){return this._api.console.log("isPlaying: "+this._isPlaying),this.isInitialized()?this._isPlaying:!1},t.prototype.play=function(n,r){var i=this;this._api.console.log("Play Audio");if(!this.isInitialized())return new e.Deferred(this._api,!1);if(!this._track||r)r?this._track=this._api.sdkSettings.audioManager.music.tracks[r]:this._track=this._selectTrack();return this._isPlaying=!0,n&&(this.playDeferred=new e.Deferred(this._api)),this._clearErrorTimeout(),this._clearPlayTimeout(),this._playTimeoutId=setTimeout(function(){i._clearPlayTimeout(),i.playDeferred&&i.playDeferred.isPending()&&(i._api.reportErrorEvent(e.Reporting.Errors.musicError,"Playing TIMEOUT"),i.playDeferred.reject("Music: playing TIMEOUT"))},t._PLAY_TIMEOUT),this._createAudio(),this._loadAudio(),this.playDeferred},t.prototype._stopImmediately=function(){var e=this;this._clearPlayTimeout(),this._suspendAudio(),this.isPlaying()?(this._isPlaying=!1,setTimeout(function(){e.stopDeferred.isPending()&&e.stopDeferred.resolve("Music: Stopped"),e.playDeferred&&e.playDeferred.isPending()&&e.playDeferred.resolve("Music: Playing rejected by Stop"),e._disableCallbacks=!1},t._DELAY_AFTER_STOP)):(this.stopDeferred.isPending()&&this.stopDeferred.resolve("Music: Stop don't need"),this.playDeferred&&this.playDeferred.isPending()&&this.playDeferred.resolve("Music: Playing rejected by Stop"),this._disableCallbacks=!1)},t.prototype.stop=function(){var t=this;return this._api.console.log("Stop Audio"),this._disableCallbacks=!0,this._clearErrorTimeout(),this.stopDeferred=new e.Deferred(this._api),this._settings.stopMusicImmediately?this._stopImmediately():this._api.processLater(function(){t._stopImmediately()}),this.stopDeferred},t.prototype._loadAudio=function(){if(!this._audio||this._audio.src&&this._audio.src!=="")return;this._api.bind(this._audio,t._AUDIO_READY_EVENTS,this._onAudioReadyCallback),this._autoLoop||this._api.bind(this._audio,t._AUDIO_END_EVENTS,this._onAudioEndCallback);var e=this._api.resolvePath(this._track+this._media.ext);this._audio.src=e,this._audio.load()},t.prototype._createAudio=function(){this._audio||(this._api.console.log("Create Audio"),this._settings.dontUseAudioClass===!0?this._audio=document.createElement("audio"):this._audio=new Audio,this._audio.loop=this._autoLoop,this._settings.addAudioToDOM&&document.body.appendChild(this._audio))},t.prototype._suspendAudio=function(){this._audio&&(this._settings.addAudioToDOM&&this._audio.parentNode&&document.body.removeChild(this._audio),this._autoLoop||(this._api.unbind(this._audio,t._AUDIO_END_EVENTS,this._onAudioEndCallback),this._api.unbind(this._audio,t._AUDIO_SUSPEND_EVENTS,this._onAudioEndCallback)),this._api.unbind(this._audio,t._AUDIO_READY_EVENTS,this._onAudioReadyCallback),this._audio.pause(),this._audio.preload="none",this._audio.src="",this._audio.removeAttribute&&this._audio.removeAttribute("src"),this._audio=null)},t.prototype._selectTrack=function(){if(!this._tracks||this._tracks.length<1)return null;var e=Math.round(Math.random()*(this._tracks.length-1));return this._tracks[e]},t.prototype._onAudioReady=function(e){var n=this;this._clearPlayTimeout(),this._api.unbind(this._audio,t._AUDIO_READY_EVENTS,this._onAudioReadyCallback),this._api.console.log("onAudioReady"),this._isPlaying=!0,this._audio.play(),this._autoLoop||setTimeout(function(){n._api.bind(n._audio,t._AUDIO_SUSPEND_EVENTS,n._onAudioEndCallback)},t._DELAY_AFTER_PLAY),this.playDeferred&&this.playDeferred.isPending()&&setTimeout(function(){n.playDeferred.resolve("Music: Played")},t._DELAY_AFTER_PLAY)},t.prototype._onAudioEnd=function(e){var n=this;this._api.console.log("onAudioEnd"),this.stop().always(function(){n._tracks.length>1&&(n._track=n._selectTrack()),e.type==="error"?(n._errorReportedCount===0&&n._errorReportedCount++,n.playDeferred&&n.playDeferred.isPending()&&n.playDeferred.reject("Music: Audio error"),n._api.console.warn("Audio error. Waiting "+t._ERROR_TIMEOUT/1e3+" sec"),n._errorTimeoutId=setTimeout(function(){n.play(!1)},t._ERROR_TIMEOUT)):n.play(!1)})},t.prototype._clearErrorTimeout=function(){this._errorTimeoutId!==null&&(clearTimeout(this._errorTimeoutId),this._errorTimeoutId=null)},t.prototype._clearPlayTimeout=function(){this._playTimeoutId!==null&&(clearTimeout(this._playTimeoutId),this._playTimeoutId=null)},t._AUDIO_READY_EVENTS=["canplay"],t._AUDIO_END_EVENTS=["ended","pause","error","abort"],t._AUDIO_SUSPEND_EVENTS=["suspend"],t._ERROR_TIMEOUT=18e4,t._PLAY_TIMEOUT=6e4,t._DELAY_AFTER_PLAY=100,t._DELAY_AFTER_STOP=200,t}();t.MusicEngine=n})(t=e.Sound||(e.Sound={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){function n(e){if(!e)return;try{e.parentNode&&document.body.removeChild(e),e.pause(),e.preload="none",e.src=""}catch(t){}}function r(e){var t;e===void 0&&(e=!1);try{t=document.createElement("audio");if(!t||t.play)if(typeof Audio!="undefined"){t=new Audio;if(!t||!t.play)return null}e&&document.body.appendChild(t)}catch(n){}return t}var t;(function(e){e[e.SKIP=0]="SKIP",e[e.SINGLE=1]="SINGLE",e[e.QUEUE=2]="QUEUE",e[e.MIX=3]="MIX",e[e.MIX_OR_SKIP=4]="MIX_OR_SKIP",e[e.MIX_OR_SINGLE=5]="MIX_OR_SINGLE",e[e.MIX_OR_QUEUE=6]="MIX_OR_QUEUE",e[e.LOOP=7]="LOOP",e[e.DEFAULT=0]="DEFAULT"})(t=e.PlayMode||(e.PlayMode={})),e.suspendAudioElement=n,e.createAudioElement=r})(t=e.Sound||(e.Sound={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t=function(){function t(t,n){var r=this;this._api=t,this._format=null,this._options=n,this._playing=!1,this._audio=null,this._audioQueue=[],this._platformConfig=null,this._timerId=null;var i=e.createAudioElement();i?this._format=this._api.supportedMedia(i,"audio",this._options.extensions):this._format=null,this._platformConfig=this._api.sdkSettings.audioManager.settings,this._onStartCallback=function(){r.onStart()},this._onEndCallback=function(){r.onEnd()}}return t.prototype.isSupported=function(){return!!this._format&&!!this._platformConfig},t.prototype.initialize=function(){},t.prototype.isInitialized=function(){return!0},t.prototype.play=function(n,r,i){if(!this.isInitialized())return i&&i(!1),!1;typeof r!="number"&&(r=0);switch(r!==0?r:e.PlayMode.DEFAULT){case e.PlayMode.SINGLE:this._audioQueue=[],this.isPlaying()&&this.stop();break;case e.PlayMode.SKIP:if(this.isPlaying())return!1;break;case e.PlayMode.QUEUE:if(this.isPlaying())return this._audioQueue.push({trackName:n,callback:i}),!0}this.suspend(),this._audio=e.createAudioElement(),this._audio.loop=!1,this._audio.preload="auto",this._audio.autoplay=!1,this._playing=!0,this._api.bind(this._audio,t._AUDIO_READY_EVENTS,this._onStartCallback),this._api.bind(this._audio,t._AUDIO_END_EVENTS,this._onEndCallback);var s=this._options.folderUrl+"/"+n+this._format.ext;return this._audio.src=this._api.getResourceManager().resolvePath(s),this._platformConfig.loadBeforePlay&&this._audio.load(),this._trackName=n,!0},t.prototype.isPlaying=function(){return this._playing},t.prototype.stop=function(){if(!this.isInitialized())return;this.suspend()},t.prototype.onStart=function(){var e=this._options.tracks[this._trackName],n=(e.end-e.start)*1e3,r=n;this._timerId=window.setTimeout(this._onEndCallback,r),this._api.unbind(this._audio,t._AUDIO_READY_EVENTS,this._onStartCallback),this._audio.play()},t.prototype.onEnd=function(){this.suspend();if(this._audioQueue.length>0){var t=this._audioQueue.shift();this.play(t.trackName,e.PlayMode.QUEUE,t.callback)}},t.prototype.cleanup=function(e){this.suspend(),e()},t.prototype.suspend=function(){this._playing=!1,this._audio&&(this._api.unbind(this._audio,t._AUDIO_READY_EVENTS,this._onStartCallback),this._api.unbind(this._audio,t._AUDIO_END_EVENTS,this._onEndCallback),this._audio.pause(),this._audio=null),this._timerId&&(clearTimeout(this._timerId),this._timerId=null)},t._AUDIO_READY_EVENTS=["canplay","canplaythrough"],t._AUDIO_END_EVENTS=["ended","pause","error","abort"],t}();e.AudioEngine=t})(t=e.Sound||(e.Sound={}))}(TGH5||(TGH5={})),function(e){var t,n;e.KeyNames={KEY_INFO:"Info",KEY_RED:"Red",KEY_YELLOW:"Yellow",KEY_BLUE:"Blue",KEY_GREEN:"Green",KEY_SHIFT:"Shift",KEY_EXIT:"Exit",KEY_ESC:"Esc",KEY_ENTER:"Enter",KEY_BACKSPACE:"Backspace",KEY_LEFT:"Left",KEY_RIGHT:"Right",KEY_UP:"Up",KEY_DOWN:"Down",KEY_SPACE:"Space",KEY_DELETE:"Delete",KEY_LEFT_PARENTHESIS:")",KEY_EXCLAMATION_MARK:"!",KEY_AT:"@",KEY_HASH:"#",KEY_DOLLAR:"$",KEY_PERCENT:"%",KEY_CARET:"^",KEY_AMPERSAND:"&",KEY_ASTERISK:"*",KEY_RIGHT_PARENTHESIS:"(",KEY_0:"0",KEY_1:"1",KEY_2:"2",KEY_3:"3",KEY_4:"4",KEY_5:"5",KEY_6:"6",KEY_7:"7",KEY_8:"8",KEY_9:"9",KEY_A:"A",KEY_B:"B",KEY_C:"C",KEY_D:"D",KEY_E:"E",KEY_F:"F",KEY_G:"G",KEY_H:"H",KEY_I:"I",KEY_J:"J",KEY_K:"K",KEY_L:"L",KEY_M:"M",KEY_N:"N",KEY_O:"O",KEY_P:"P",KEY_Q:"Q",KEY_R:"R",KEY_S:"S",KEY_T:"T",KEY_U:"U",KEY_V:"V",KEY_W:"W",KEY_X:"X",KEY_Y:"Y",KEY_Z:"Z",KEY_F1:"F1",KEY_F2:"F2",KEY_F3:"F3",KEY_F4:"F4",KEY_F5:"F5",KEY_F6:"F6",KEY_F7:"F7",KEY_F8:"F8",KEY_F9:"F9",KEY_F10:"F10",KEY_F11:"F11",KEY_F12:"F12",KEY_NUMPAD0:"Num0",KEY_NUMPAD1:"Num1",KEY_NUMPAD2:"Num2",KEY_NUMPAD3:"Num3",KEY_NUMPAD4:"Num4",KEY_NUMPAD5:"Num5",KEY_NUMPAD6:"Num6",KEY_NUMPAD7:"Num7",KEY_NUMPAD8:"Num8",KEY_NUMPAD9:"Num9",KEY_CONTROL:"Control",KEY_FORWARD:"Forward",KEY_REWIND:"Rewind",KEY_PLAY:"Play",KEY_STOP:"Stop",KEY_MENU:"Menu",KEY_SEARCH:"Search",KEY_SUBTITLES:"Subtitles",KEY_AUDIODESC:"AudioDesc",KEY_SKIP:"Skip"},function(t){t.keyNames=e.KeyNames}(t=e.KeyMapper||(e.KeyMapper={})),function(t){var n,r,i,s;(function(e){e[e.Any=0]="Any",e[e.System=1]="System",e[e.Product=2]="Product"})(n=t.ListenerType||(t.ListenerType={})),function(e){e[e.Any=0]="Any",e[e.KeyUp=1]="KeyUp",e[e.KeyDown=2]="KeyDown"}(r=t.EventType||(t.EventType={})),i=function(){function e(e,t,n,r){this.type=e,this.enabled=!0,this.callback=n,this.eventType=t,r&&(this.thisArg=r)}return e.prototype.setEnabled=function(e){this.enabled=e},e.prototype.invoke=function(e){if(!this.enabled)return!1;if(this.callback)return this.callback.call(this.thisArg,e)},e}(),s=function(){function t(e){this._api=e,this._listeners=[],this._popstateHandlingEnabled=!1}return t.prototype.waitKeyUp=function(){return this._keyNotReleased?(this._keyReleaseDeferred=new e.Deferred(this._api),this._keyReleaseDeferred):new e.Deferred(this._api,!0)},t.prototype._forEach=function(e,t,i){var s=this._listeners.slice(0);for(var o=s.length-1;o>=0;o--){var u=s[o];if(e!=n.Any&&u.type!=n.Any&&u.type!=e)continue;if(t!=r.Any&&u.eventType!=r.Any&&u.eventType!=t)continue;if(i.call(this,u,o)===!0)break}},t.prototype.isEnabled=function(e,t){var n=!1;return this._forEach(e,t,function(e){return n=e.enabled,!0}),n},t.prototype.setEnabled=function(e,t,n){this._forEach(t,n,function(t){t.setEnabled(e)})},t.prototype.addListener=function(e,t,n,r){this.removeListener(e,t,n),this._listeners.push(new i(e,t,n,r))},t.prototype.removeListener=function(e,t,n){var r=this;this._forEach(e,t,function(e,t){return e.callback==n?(r._listeners.splice(t,1),!0):!1})},t.prototype._getKeyCodeScheme=function(){return this._api.sdkSettings.keyCodeScheme?this._api.sdkSettings.keyCodeScheme:"generic"},t.prototype._onKeyDown=function(e){this._api.getSystem().onUserActivity(),this._keyNotReleased=!0,this._api.resetMouse(),this._forEach(n.Any,r.KeyDown,function(t){return t.invoke(e)})},t.prototype._onKeyUp=function(e){this._api.getSystem().onUserActivity(),this._forEach(n.Any,r.KeyUp,function(t){return t.invoke(e)}),this._keyNotReleased=!1,this._keyReleaseDeferred&&(this._keyReleaseDeferred.resolve(),this._keyReleaseDeferred=null)},t.prototype.init=function(){var t=new e.Deferred(this._api),n=this._getKeyCodeScheme(),r=this;return this._keyMapper=new e.keyMapperLib.KeyMapper(n,function(){this.addKeyDownListener(r._onKeyDown,r),this.addKeyUpListener(r._onKeyUp,r),t.resolve("KeyMapper init as: "+n)}),t},t.prototype.simulateKeyDown=function(e){this._onKeyDown(e)},t.prototype.simulateKeyUp=function(e){this._onKeyUp(e)},t.prototype.isPopStateHandlingEnabled=function(){return this._popstateHandlingEnabled},t.prototype.popStateHandling=function(t){var n=this,r=new e.Deferred(this._api);return this._api.processLater(function(){n._popstateHandlingEnabled=t,n._keyMapper.popStateHandling(t),n._api.processLater(function(){r.resolve()})}),r},t}(),t.KeyManager=s}(n=e.Key||(e.Key={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n,r,i;(function(e){e[e.System=1]="System",e[e.Product=2]="Product"})(n=t.ListenerType||(t.ListenerType={})),r=function(){function e(t,n,r){if(n)this.target=n.target,this.type=n.type,this._getXY(n,t);else if(r){this.target=r.target;switch(r.type){case e.TouchMove:this.type=e.MouseMove;break;case e.TouchStart:this.type=e.MouseDown;break;case e.TouchEnd:this.type=e.MouseUp;break;default:this.type=""}r.targetTouches&&r.targetTouches.length>0&&this._getXY(r.targetTouches[0],t),r.changedTouches&&r.changedTouches.length>0?this._getXY(r.changedTouches[0],t):(this.x=0,this.y=0)}}return e.create=function(t,n,r,i,s){var o=new e(t);return o.target=n,o.type=r,o.x=0,o.y=0,i?o._getXY(i,t):s&&(s.targetTouches&&s.targetTouches.length>0&&o._getXY(s.targetTouches[0],t),s.changedTouches&&s.changedTouches.length>0&&o._getXY(s.changedTouches[0],t)),o},e.prototype._getXY=function(e,t){var n=t.getSystem().getResolutionK(),r=t.getSystem().transformX(),i=t.getSystem().transformY();typeof e.clientX=="number"?this.x=e.clientX:typeof e.pageX=="number"?this.x=e.pageX:typeof e.screenX=="number"?this.x=e.screenX:this.x=0,typeof e.clientY=="number"?this.y=e.clientY:typeof e.pageY=="number"?this.y=e.pageY:typeof e.screenY=="number"?this.y=e.screenY:this.y=0,this.x=this.x/n-r/n,this.y=this.y/n-i/n},e.MouseMove="mousemove",e.MouseOver="mouseover",e.MouseOut="mouseout",e.MouseDown="mousedown",e.MouseUp="mouseup",e.TouchMove="touchmove",e.TouchStart="touchstart",e.TouchEnd="touchend",e}(),t.Event=r,i=function(){function t(e,t){var n=this;this._listeners=[],this._api=e,this._lastFocusedEl=null;if(this._api.sdkSettings.mouseDisabled)return;this._enabled=!0,this._disableProductEvents=!1,t||(t=document.documentElement),this._api.sdkSettings.touchPadEnabled&&(t.addEventListener("touchmove",function(e){return n.onTouchMove(e)},!0),t.addEventListener("touchstart",function(e){return n.onTouchStart(e)},!0),t.addEventListener("touchend",function(e){return n.onTouchEnd(e)},!0)),t.addEventListener("mousemove",function(e){return n.onMouseMove(e)},!0),t.addEventListener("mouseover",function(e){return n.onMouseOver(e)},!0),t.addEventListener("mouseout",function(e){return n.onMouseOut(e)},!0),t.addEventListener("mousedown",function(e){return n.onMouseDown(e)},!0),t.addEventListener("mouseup",function(e){return n.onMouseUp(e)},!0)}return t.prototype.sendMouseEvent=function(e){if(this._enabled){this._api.getSystem().onUserActivity();var t=this._listeners.slice(0);for(var r=t.length-1;r>=0;r--){var i=t[r];if(i.type==n.Product&&this._disableProductEvents)continue;if(i.callback.call(t[r].thisArg,e)==1)return}}},t.prototype.sendOutOverEvents=function(t,n,i,s){t&&this.sendMouseEvent(r.create(this._api,t,e.Mouse.Event.MouseOut,i,s)),n&&this.sendMouseEvent(r.create(this._api,n,e.Mouse.Event.MouseOver,i,s))},t.prototype.eventsAllowed=function(){return this._listeners.length>0},t.prototype.enableProductMouse=function(){this._disableProductEvents=!1},t.prototype.disableProductMouse=function(){this._disableProductEvents=!0},t.prototype.enableMouse=function(){if(this._api.sdkSettings.mouseDisabled)return;this._enabled=!0},t.prototype.disableMouse=function(){if(this._api.sdkSettings.mouseDisabled)return;this.sendOutOverEvents(this._lastFocusedEl,null),this._lastFocusedEl=null,this._enabled=!1},t.prototype.isEnabled=function(){return this._api.sdkSettings.mouseDisabled?!1:this._enabled},t.prototype.reset=function(){this._lastFocusedEl=null},t.prototype.onMouseMove=function(t){if(!this.eventsAllowed())return;this._lastFocusedEl!==t.target&&(this.sendOutOverEvents(this._lastFocusedEl,t.target,t),this._lastFocusedEl=t.target),this.sendMouseEvent(new e.Mouse.Event(this._api,t))},t.prototype.onTouchMove=function(t){if(!this.eventsAllowed())return;this._lastFocusedEl!==t.target&&(this.sendOutOverEvents(this._lastFocusedEl,t.target,null,t),this._lastFocusedEl=t.target),this.sendMouseEvent(new e.Mouse.Event(this._api,null,t)),t.preventDefault()},t.prototype.onMouseOver=function(t){if(!this.eventsAllowed())return;this._lastFocusedEl!==null&&this.sendOutOverEvents(this._lastFocusedEl,null,t),this._lastFocusedEl=t.target,this.sendMouseEvent(new e.Mouse.Event(this._api,t))},t.prototype.onMouseOut=function(t){if(!this.eventsAllowed())return;this._lastFocusedEl!==t.target&&this._lastFocusedEl!==null&&this.sendOutOverEvents(this._lastFocusedEl,null,t),this._lastFocusedEl=null,this.sendMouseEvent(new e.Mouse.Event(this._api,t))},t.prototype.onMouseDown=function(t){if(!this.eventsAllowed())return;this._lastFocusedEl!==t.target&&(this.sendOutOverEvents(this._lastFocusedEl,t.target,t),this._lastFocusedEl=t.target),this.sendMouseEvent(new e.Mouse.Event(this._api,t))},t.prototype.onTouchStart=function(t){if(!this.eventsAllowed())return;this._lastFocusedEl!==t.target&&(this.sendOutOverEvents(this._lastFocusedEl,t.target,null,t),this._lastFocusedEl=t.target),this.sendMouseEvent(new e.Mouse.Event(this._api,null,t)),t.preventDefault()},t.prototype.onMouseUp=function(t){if(!this.eventsAllowed())return;this._lastFocusedEl!==t.target&&this.sendOutOverEvents(this._lastFocusedEl,t.target,t),this.reset(),this.sendMouseEvent(new e.Mouse.Event(this._api,t))},t.prototype.onTouchEnd=function(t){if(!this.eventsAllowed())return;this._lastFocusedEl!==t.target&&this.sendOutOverEvents(this._lastFocusedEl,t.target,null,t),this.reset(),this.sendMouseEvent(new e.Mouse.Event(this._api,null,t)),t.preventDefault()},t.prototype.addListener=function(e,t,r){if(this._api.sdkSettings.mouseDisabled)return;this.removeListener(e),this._listeners.push({callback:e,thisArg:t,type:typeof r=="undefined"?n.Product:r})},t.prototype.removeListener=function(e){if(this._api.sdkSettings.mouseDisabled)return;for(var t=0;t<this._listeners.length;t++)if(this._listeners[t].callback===e){this._listeners.splice(t,1);break}},t.prototype.suspend=function(){this._listeners=null},t}(),t.MouseManager=i})(t=e.Mouse||(e.Mouse={}))}(TGH5||(TGH5={})),function(e){var t=function(){function t(e){this._api=e,this._encryptedString="",this._create(this._api.sdkSettings.googlePALSDK),this._timeout=null}return t.prototype._create=function(e){e?this._settings=e:this._settings={enabled:!1}},t.prototype._clearTimeout=function(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null)},t.prototype.getEncryptedString=function(){var n=this,r=new e.Deferred(this._api);if(!this._settings.enabled)r.resolve("");else if(this._encryptedString)r.resolve(this._encryptedString);else{this._timeout=setTimeout(function(){n._timeout=null,r.reject()},t.PALSDK_TIMEOUT),this._iFrame=document.createElement("iframe"),this._iFrame.id="iframe"+Math.random(),this._iFrame.name=this._iFrame.id,this._iFrame.style.display="none",this._iFrame.src=this._api.resolvePath(this._settings.url),document.body.appendChild(this._iFrame);var i=function(){n._api.getSystem().getCustomerUID().always(function(t){var i=new e.IFrame.Message(n._api,n._iFrame.contentWindow);i.response=function(t,i){switch(t){case e.IFrame.Messages.success:n._clearTimeout(),n._encryptedString=i&&i.encryptedString?i.encryptedString:"",r.resolve(n._encryptedString);break;case e.IFrame.Messages.error:n._clearTimeout(),n._api.console.error("PAL: "+i?i.error:"unknown"),r.reject()}},i.request(e.IFrame.Messages.request,{descriptionUrl:location.href,ppid:t})})},s=function(t,r){t===e.IFrame.Messages.onLoaded&&r.name===n._iFrame.id&&(n._onLoadMessage.suspend(),i())};this._onLoadMessage=new e.IFrame.MessageListener(this._api,s)}return r},t.PALSDK_TIMEOUT=15e3,t}();e.GooglePALSDK=t}(TGH5||(TGH5={})),function(e){var t=function(){function t(e){this._settings=e,this._detectTimeout=null,this._onPlatformDetectedListener=null}return t.prototype.getName=function(){return this._settings.name},t.prototype.onExternalScriptLoaded=function(){},t.prototype.onExternalScriptFailLoad=function(e){this._platformDetected()},t.prototype.detected=function(t){var n=this;this._onPlatformDetectedListener=t;var r=document.getElementById("__pwlog");this._settings.externalLib&&(r.innerHTML+="<br> Load external library: "+this._settings.externalLib,e.System.loadScript(this._settings.externalLib,function(){r.innerHTML+="<br> library loaded",n.onExternalScriptLoaded()},function(e){r.innerHTML+="<br> library load fail: "+e,n.onExternalScriptFailLoad(e)})),this._settings.detectTimeoutMSec&&(this._detectTimeout=setTimeout(function(){r.innerHTML+="<br> Detect Platform on timeout: "+n._settings.detectTimeoutMSec,n._detectTimeout=null,n._platformDetected()},this._settings.detectTimeoutMSec))},t.prototype._platformDetected=function(e){this._detectTimeout&&(clearTimeout(this._detectTimeout),this._detectTimeout=null);if(this._onPlatformDetectedListener){var t=document.getElementById("__pwlog");t.innerHTML+="<br> Platform Detected: name = "+e,e||(e=this._settings.defaultPlatform?this._settings.defaultPlatform:"generic"),this._onPlatformDetectedListener.call(this,e),this._onPlatformDetectedListener=null}},t}();e.DetectPlatform=t}(TGH5||(TGH5={})),function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.detected=function(t){var n=this,r=document.createElement("div");r.id="__pwlog",r.style.position="fixed",r.style.backgroundColor="black",r.style.color="white",r.style.left="600px",r.style.top="100px",r.style.fontSize="20px",r.style.zIndex="10000000000",r.innerHTML="Start detection Metrological platform:",document.body.appendChild(r),window.addEventListener("overcast:loaded",function(){r.innerHTML+="<br> On overcast:loaded, Profile = "+window.Profile+", Profile.get = "+typeof window.Profile.get;if(window.Profile&&typeof window.Profile.get=="function"){var e=window.Profile.get("operator");r.innerHTML+="<br> Profile.get('operator') = "+e,n._platformDetected(e)}else n._platformDetected()}),e.prototype.detected.call(this,t)},t}(e.DetectPlatform);e.MetrologicalDetectPlatform=t}(TGH5||(TGH5={})),function(e){var t,n,r;(function(e){e.ON_CONNECT="onConnect",e.ON_DISCONNECT="onDisconnect",e.ON_MESSAGE="onMessage"})(t=e.MultiControllerListeners||(e.MultiControllerListeners={})),function(e){e.KEY_DOWN="keyDown",e.KEY_UP="keyUp",e.USER="user"}(n=e.MultiControllerMessageType||(e.MultiControllerMessageType={})),r=function(){function e(e,t){var n=this;this._api=e,this._impl=t,this._listeners=[],this._isFirstConnect=!0,this._impl.onConnect=function(e){n._onControllerConnected(e)},this._impl.onDisconnect=function(e){n._onControllerDisconnected(e)},this._impl.onMessage=function(e,t){n._onMessage(e,t)}}return e.prototype._onMessage=function(e,r){var i=this._impl.convertDeviceIdToPlayerNumber(e);if(typeof i!="undefined")switch(r.type){case n.KEY_DOWN:this._api.getKeyManager().simulateKeyDown(r.data);break;case n.KEY_UP:this._api.getKeyManager().simulateKeyUp(r.data);break;case n.USER:this._dispatch(t.ON_MESSAGE,e,r.data)}},e.prototype.sendMessage=function(e,t,n){var r={type:t,data:n};e<0?this._impl.broadcast(r):this._impl.message(e,r)},e.prototype._onControllerDisconnected=function(e){var n=this._impl.convertDeviceIdToPlayerNumber(e);typeof n!="undefined"&&this._dispatch(t.ON_DISCONNECT,e)},e.prototype._onControllerConnected=function(e){this._api.console.log("New controller connected: "+e),this._isFirstConnect&&(this._isFirstConnect=!1,this._impl.setActivePlayers(1)),this._dispatch(t.ON_CONNECT,e)},e.prototype._dispatch=function(e){var t=[];for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<this._listeners.length;r++){var i=this._listeners[r];i.listenerType===e&&i.handler&&i.handler.apply(i.thisArg,__spreadArray([],t,!0))}},e.prototype.addListener=function(e,t,n){this._listeners.push({listenerType:e,handler:t,thisArg:n})},e.prototype.removeListener=function(e,t){for(var n=0;n<this._listeners.length;n++){var r=this._listeners[n];r.listenerType===e&&r.handler===t&&(this._listeners.splice(n,1),n--)}},e.prototype.setActivePlayers=function(e){this._impl.setActivePlayers(e)},e.prototype.getControllerDeviceIds=function(){return this._impl.getControllerDeviceIds()},e.prototype.getMasterControllerDeviceId=function(){return this._impl.getMasterControllerDeviceId()},e.prototype.getUsername=function(e){return this._impl.getNickname(e)},e.prototype.getAvatarUrl=function(e){return this._impl.getProfilePicture(e)},e}(),e.MultiControllerManager=r}(TGH5||(TGH5={})),function(e){var t,n=[new e.MetrologicalDetectPlatform({name:"metrological",externalLib:"https://cdn.metrological.com/overcast/client-1.0.9.js",defaultPlatform:"fetchtv",detectTimeoutMSec:1e4})],r=function(){function e(){}return e.GENERIC="generic",e.PANASONIC="panasonic",e.PHILIPS="philips",e.SAMSUNG="samsung",e.VIZIO="vizio",e.VIZIO_VIA="vizio_via",e.LG="lg",e.WEBOS="webos",e.LGI="lgi",e.BEIN="bein",e.ATT_GENIE="att_genie",e.ATT_OSPREY="att_osprey",e.PC="pc",e.ACTIVEVIDEO="activevideo",e.TIVO="tivo",e.FIRETV="firetv",e.HOPPER="hopper",e.OPERA="opera",e.CORDOVA="cordova",e.MOBILE="mobile",e.COMCAST="comcast",e.VIDEOTRON="videotron",e.SHAW="shaw",e.COX="cox",e.MINI4K="mini4k",e.NETRANGE="netrange",e.DISHTV="dishtv",e.JIO="jio",e.VEWD="vewd",e.GD="gd",e.SKY="sky",e.LIGHTNING="lightning",e.ZEASN="zeasn",e.CRAZYGAMES="crazygames",e.VIDAA="vidaa",e.ROGERS="rogers",e.POKI="poki",e.AIRCONSOLE="airconsole",e}();e.Platforms=r,t=function(){function t(e){this._resolutionK=1,this._transformX=0,this._transformY=0,this._api=e,this._needToRestoreMusic=!1,this._loadingCompletedReported=!1,this._advertiserIFA="",this._advertiserIFAType="",this._advertiserLMT=0,this._IFADone=!0,this._SPSLIBInitialized=!0,this._spsSessionId="",this._sniffingDone=!0,this._comcastAsyncFinished=!0,this._isAmazonPlatformReady=!0,this._isCrazyGamesPlatformReady=!0,this._isPokiPlatformReady=!0,this._isAirConsolePlatformReady=!0,this._comcastInfo={},this._googlePALSDK=null,this._startTime=Date.now(),this._lastActivityTime=this._startTime,this._inactivityTime=0,this._paused=!1,this._startInactivityInterval()}return t.prototype.init=function(){this._deferred=new e.Deferred(this._api),this._fitScreenInit();switch(this._api.getPlatformName()){case r.ATT_GENIE:this.dtvPlatformInit();break;case r.WEBOS:this._webosPlatformInit();break;case r.LG:this.lgPlatformInit();break;case r.FIRETV:this.firetvPlatformInit();break;case r.HOPPER:this.hopperPlatformInit();break;case r.CORDOVA:case r.ATT_OSPREY:this.cordovaPlatformInit();break;case r.MINI4K:this.mini4kPlatformInit();break;case r.CRAZYGAMES:this.crazyGamesPlatformInit();break;case r.VIDAA:this.vidaaPlatformInit();break;case r.MOBILE:this.mobilePlatformInit();break;case r.COMCAST:case r.VIDEOTRON:case r.SHAW:case r.COX:case r.ROGERS:this.comcastPlatformInit();break;case r.VIZIO:case r.VIZIO_VIA:this.vizioPlatformInit();break;case r.JIO:this.jioPlatformInit();break;case r.GD:this.gdPlatformInit();break;case r.SAMSUNG:this.samsungPlatformInit();break;case r.POKI:this.pokiPlatformInit();break;case r.AIRCONSOLE:this.airConsolePlatformInit();break;default:this._deferred.resolve()}return this._api.sdkSettings.showTransition===!0&&this._showTransition(),this._sniffingInit(),this._deferred},t.prototype._hideTransition=function(){document.body.style.backgroundImage="none"},t.prototype._showTransition=function(){document.body.style.backgroundImage="url("+this._api.resolvePath("media/transition_bg.jpg")+")",document.body.style.backgroundRepeat="no-repeat"},t.prototype._fixSniffingUrl=function(e,t){var n=e.replace(/\[deployment\]/g,this._api.getPlatformName()).replace(/\[productId\]/g,this._api.productId).replace(/\[product_id\]/g,this._api.productId).replace(/\[referrer\]/g,encodeURIComponent(location.href)).replace(/\[random\]/g,""+Math.floor(Math.random()*1e9)).replace(/\[device_id\]/g,this._getVirtualUID()).replace(/\[domain\]/g,location.host).replace(/\[timestamp\]/g,""+Date.now());if(n.indexOf("[pm_token]")){var r=setTimeout(function(){n=n.split("&").filter(function(e){return e.indexOf("[pm_token]")<0}).join("&"),t(n),r=null},1e4),i=new XMLHttpRequest;i.open("POST","https://promedia.play.works/request",!0),i.setRequestHeader("Content-type","application/json"),i.onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&i.status==200&&r&&(clearTimeout(r),r=null,n=n.replace(/\[pm_token\]/g,i.responseText),t(n))},i.send('{"url":"'+n+'"}')}else t(n)},t.prototype._sniffingInit=function(){var t=this,n=this._api.getProductSettings(this._api.productId);if(n&&n.sniffingURLsDisabled||e.Api.locationGetParam("sniffing")=="0")console.log("Sniffing URLs disabled");else if(this._api.sdkSettings.sniffingURLs){var r=this._api.sdkSettings.sniffingURLs;for(var i=0;i<r.length;i++)this._fixSniffingUrl(r[i],function(e){var t=document.createElement("img");t.src=e,console.log("SNIFF IMG: "+e)})}n&&n.sniffingScriptURLsDisabled||e.Api.locationGetParam("sniffing")=="0"?console.log("Sniffing Script URLs disabled"):this._api.sdkSettings.sniffingScriptURLs&&this._getSniffingScriptURLs(function(e){var n=e.length;n>0&&(t._sniffingDone=!1);for(var r=0;r<e.length;r++)t._fixSniffingUrl(e[r],function(e){t._api.console.log("SNIFF JS: "+e),t._api.loadScript(e,1e4).always(function(){n--,n<=0&&(t._sniffingDone=!0)})})})},t.prototype._getSniffingScriptURLs=function(e){var t=this;if(!this._api.sdkSettings.sniffingScriptURLs&&!this._api.sdkSettings.sniffingByCountryScriptURLs){e(null);return}if(!this._api.sdkSettings.sniffingByCountryScriptURLs){e(this._api.sdkSettings.sniffingScriptURLs);return}var n=[],r=!1,i=this._api.sdkSettings.sniffingByCountryScriptURLs.length,s=function(){i==0&&!r&&(r=!0,e(n.length>0?n:t._api.sdkSettings.sniffingScriptURLs))};this._api.sdkSettings.sniffingByCountryScriptURLs.forEach(function(e){e&&e.countries&&t._api.requestCountryCode().always(function(t){t&&typeof t=="string"&&e.countries.indexOf(t.toLowerCase())>=0&&n.push(e.url),i--,s()})}),s()},t.prototype._addSystemLaunchParameters=function(t){var n=["operator","platform","language","country","ip","ip6","us_privacy","lmt","fit"];for(var r=0;r<n.length;r++){var i=e.Api.locationGetParam(n[r]);i&&(t=this._api.locationURLAddParam(t,n[r],i))}if(this._api.sdkSettings.crossDomainStorageKeys){var s=this._api.getStorage();for(var r=0;r<this._api.sdkSettings.crossDomainStorageKeys.length;r++){var o=this._api.sdkSettings.crossDomainStorageKeys[r],u=s.getKey(o,null,!0);u&&(t=this._api.locationURLAddParam(t,o,encodeURIComponent(u)));if(o==e.CachedSettings.STORAGE_KEY_NAME){var u=s.getKey(e.Storage.CROSS_DOMAIN_TS_KEY,null,!0);u&&(t=this._api.locationURLAddParam(t,e.Storage.CROSS_DOMAIN_TS_KEY,encodeURIComponent(u)))}}}return t},t.prototype.exit=function(){var e=this;this._unloadAllResources();var t=function(){var t=e._api.getParentProductId(),n=e._getExitTo();if(n&&e._api.sdkSettings.products&&e._api.sdkSettings.products[n]&&e._api.sdkSettings.products[n].url){e.exitParentById(n);return}e._api.console.log("System.exit: "+t),e._api.isPortal()||e._api.productSettings.isStandalone?e.exitSmartTV():t?e.exitParent(t):e._api.launchApp("portal",!0)||e.exitSmartTV()};typeof this._api.sdkSettings.exitDelay=="number"&&this._api.sdkSettings.exitDelay>0?setTimeout(function(){t()},this._api.sdkSettings.exitDelay):t()},t.loadScript=function(e,t,n){var r=document.createElement("script");r.onreadystatechange=r.onload=function(){(!r.readyState||r.readyState==="loaded"||r.readyState==="complete")&&t()},r.onerror=function(){n("Script load failed:"+e)},r.src=e,document.body.appendChild(r)},t.detectPlatformName=function(t,i){var s=e.Api.locationGetParam("platform");if(s){i(s);return}var o=r.GENERIC,u=e.Api.locationGetParam("operator");if(u){var a=null;for(var f=0;f<n.length;f++)if(n[f].getName()===u){a=n[f];break}a?a.detected(i):i(o)}else i(o)},t.getHomeDirectory=function(){try{var t=document.getElementsByTagName("script");if(t)for(var n=0;n<t.length;n++)try{var r=t[n];if(r&&typeof r.getAttribute=="function"){var i=r.getAttribute("src"),s=null;i&&(i.indexOf("tgh5.js")>=0||i.indexOf("tgh5.min.js")>=0)&&(s=i.substr(0,i.lastIndexOf("/")));if(s!==null){s.length===0&&(s=".");if(s.indexOf("//")<0){var o=document.location.href.split("?")[0];o=o.substr(0,o.lastIndexOf("/")),s=e.Api.normalizePath(o+"/"+s)}return s}}}catch(u){}}catch(u){return""}return""},t.prototype.loadingCompleted=function(){if(this._loadingCompletedReported)return;this._api.sdkSettings.showTransition===!0&&this._hideTransition(),this._loadingCompletedReported=!0;switch(this._api.getPlatformName()){case r.COMCAST:case r.VIDEOTRON:case r.SHAW:case r.COX:case r.ROGERS:this.comcastLoadingCompleted();break;case r.POKI:PokiSDK&&PokiSDK.gameLoadingFinished();break;default:}},t.prototype.changeLocation=function(e,n){var i=this;this._api.getKeyManager().popStateHandling(!1).always(function(){i._api.console.log("SDK: changeLocation: replace: "+n+", url: "+e);var s=function(){e=i.addCacheBuster(e),n===!0?document.location.replace(e):document.location.href=e},o=function(){i._api.console.log("change..."),i._unloadAllResources(),e=i._addSystemLaunchParameters(e),typeof i._api.sdkSettings.exitDelay=="number"&&i._api.sdkSettings.exitDelay>0?setTimeout(function(){s()},i._api.sdkSettings.exitDelay):s()};i._api.sdkSettings.useLocationReplace===!0&&(n=!0);switch(i._api.getPlatformName()){case r.FIRETV:setTimeout(o,t.FIRETV_DELAY_POPSTATE);break;case r.NETRANGE:case r.LG:case r.SKY:n=!0,i._api.sdkSettings.forceHistory===!0&&(n=!1),o();break;default:o()}})},t.prototype.prepareExit=function(){var e=document.getElementById("tgh5-ad-container");e&&document.body.removeChild(e),document.body.style.background="#000",document.body.innerHTML="",e&&document.body.appendChild(e)},t.prototype._unloadAllResources=function(){this._api.getResourceManager().unloadAllResources(),document.body.style.background="#000",typeof this._api.sdkSettings.exitDelay=="number"&&this._api.sdkSettings.exitDelay>0&&this._showTransition(),document.body.innerHTML="",this._api.getAudioManager().destroy();var e=document.head.getElementsByTagName("style");for(var t=0;t<e.length;t++){var n=e[t];n.parentNode.removeChild(n)}},t.prototype._onPause=function(){this._api.console.log("onPause"),this._paused=!0,this._api.isMusicPlaying()&&(this._needToRestoreMusic=!0,this._api.stopMusic()),this._api._invokePauseResume(!0)},t.prototype._onResume=function(){this._api.console.log("onResume"),this._paused=!1,this._needToRestoreMusic&&(this._needToRestoreMusic=!1,this._api.playMusic()),this._api._invokePauseResume(!1)},t.prototype.getAppSpentTimeSec=function(){var e=(Date.now()-this._startTime-this._inactivityTime)/1e3|0;return console.log("spentTime: "+e),e},t.prototype.getInactivityTimeout=function(){if(typeof this._api.sdkSettings.inactivityTime!="undefined"){var e=this._api.sdkSettings,t=0;if(typeof e.inactivityTime=="number")t=e.inactivityTime;else if(typeof e.inactivityTime!="undefined"){var n=this._api.productSettings.type;typeof e.inactivityTime[n]=="number"&&(t=e.inactivityTime[n]),!t&&typeof e.inactivityTime["default"]=="number"&&(t=e.inactivityTime["default"])}return t}return typeof this._api.sdkSettings.inactivityTimeout=="number"&&this._api.sdkSettings.inactivityTimeout>0?this._api.sdkSettings.inactivityTimeout:0},t.prototype._startInactivityInterval=function(){var e=this,n=this.getInactivityTimeout();n>0&&(this._inactivityInterval=setInterval(function(){var t=Date.now()-e._lastActivityTime;t>=n&&!e._paused&&e._onPause()},t.INACTIVITY_INTERVAL))},t.prototype.onUserActivity=function(){this._api.getPWAnalyticsManager()&&this._api.getPWAnalyticsManager().onUserActivity();var e=Date.now()-this._lastActivityTime;this._lastActivityTime=Date.now(),this._paused&&this._onResume();var t=this.getInactivityTimeout();t>0&&e>t&&(this._inactivityTime+=e)},t.prototype.mini4kExitPortal=function(){this._api.console.log("mini4kExitPortal"),cordova.exec(function(){},function(){},"LaunchClient","onLaunch",""),navigator.app.exitApp()},t.prototype.cordovaExitPortal=function(){console.log("cordovaExitPortal"),navigator.app.exitApp()},t.prototype._dumpIFA=function(){this._api.console.log("Advertiser ID: "+this._advertiserIFA),this._api.console.log("Advertiser ID Type: "+this._advertiserIFAType),this._api.console.log("Limit Ad Tracking: "+this._advertiserLMT)},t.prototype.getSPSSessionId=function(){return this._spsSessionId},t.prototype._initializeSPSLibrary=function(){var n=this;if(this._api.sdkSettings.spsLibrary&&this._api.sdkSettings.spsLibrary.enabled){this._SPSLIBInitialized=!1;var r=setTimeout(function(){n._api.console.error("initialization SPS Library timeout"),n._SPSLIBInitialized=!0},t.SPS_LIBRARY_INITIALIZE_TIMEOUT),i=new e.IFrame.Message(this._api);i.response=function(t,i){t==e.IFrame.Messages.success?(clearTimeout(r),n._SPSLIBInitialized=!0,n._spsSessionId=i.sessionId,n._api.console.log("SPS Library Session Id: "+n._spsSessionId)):t==e.IFrame.Messages.error&&(n._api.console.error("initialization SPS Library error: "+i),clearTimeout(r),n._SPSLIBInitialized=!0)},i.request(e.IFrame.Messages.requestSpsSession,this._api.sdkSettings.spsLibrary)}},t.prototype.samsungPlatformInit=function(){var t=this;this._advertiserIFAType="tifa",this._IFADone=!1;var n=setTimeout(function(){t._api.console.log("Samsung initialization IFA timeout"),t._IFADone=!0},8e3),r=new e.IFrame.Message(this._api);r.response=function(r,i){r==e.IFrame.Messages.success&&(clearTimeout(n),t._advertiserIFA=i.tifaId,t._advertiserLMT=i.lmt?1:0,t._IFADone=!0,t._dumpIFA())},r.request(e.IFrame.Messages.getIFA),this._initializeSPSLibrary(),this._deferred.resolve()},t.prototype.mobilePlatformInit=function(){var e=this,t=document.createElement("meta");t.name="viewport",t.content="width=device-width, initial-scale=1, user-scalable=no, minimal-ui",document.getElementsByTagName("head")[0].appendChild(t),document.addEventListener("touchmove",function(e){e.preventDefault()}),document.addEventListener("pause",function(){e._onPause()},!1),document.addEventListener("resume",function(){e._onResume()},!1),this._deferred.resolve()},t.prototype.mini4kPlatformInit=function(){var t=this,n=document.createElement("meta");n.name="viewport",n.content="width=1280, user-scalable=no",document.getElementsByTagName("head")[0].appendChild(n),document.addEventListener("touchmove",function(e){e.preventDefault()}),document.addEventListener("deviceready",function(){document.addEventListener("pause",function(){t._onPause()},!1),document.addEventListener("resume",function(){t._onResume()},!1),document.addEventListener("backbutton",function(){t._api.getKeyManager().simulateKeyDown(e.KeyNames.KEY_BACKSPACE),t._api.getKeyManager().simulateKeyUp(e.KeyNames.KEY_BACKSPACE)},!1),t._fitScreen()},!1),this._api.loadScript("../../cordova.js",12e4).always(function(){t._deferred.resolve()})},t.prototype.cordovaPlatformInit=function(){var t=this,n=document.createElement("meta");n.name="viewport",n.content="width=1280, user-scalable=no",document.getElementsByTagName("head")[0].appendChild(n),document.addEventListener("touchmove",function(e){e.preventDefault()}),document.addEventListener("deviceready",function(){t._api.console.log("CORDOVA: deviceready"),document.addEventListener("pause",function(){t._onPause()},!1),document.addEventListener("resume",function(){t._onResume()},!1),document.addEventListener("backbutton",function(){t._api.getKeyManager().simulateKeyDown(e.KeyNames.KEY_BACKSPACE),t._api.getKeyManager().simulateKeyUp(e.KeyNames.KEY_BACKSPACE)},!1)},!1);var i="";return this._api.getPlatformName()==r.ATT_OSPREY?i="../../cordova.js":i="./cordova.js",this._api.loadScript(i,12e4).done(function(){t._deferred.resolve()}).fail(function(e){t._api.console.log("Fail load cordova: "+e),t._deferred.resolve()}),this._fitScreen(),this._deferred},t.prototype._requestComcastInfo=function(){var e=this;this._api.console.log("requestComcastInfo: $badger = "+$badger);if(!$badger||typeof $badger.info!="function")return;var n=$badger.info();n&&n.success&&n.success(function(t){e._api.console.log("$badger.info success: "+t),e._comcastInfo=t,e._comcastAsyncFinished=!0}),n&&n.failure&&n.failure(function(t){e._api.console.log("$badger.info failure: "+t),e._comcastAsyncFinished=!0});if(typeof $badger.adPlatform=="function"){var r=$badger.adPlatform();if(typeof r.advertisingId=="function"){this._IFADone=!1;var i=setTimeout(function(){e._api.console.error("Get IFA timeout"),e._IFADone=!0},t.GET_IFA_TIMEOUT);r.advertisingId().success(function(t){i&&(clearTimeout(i),i=null),e._advertiserIFA=t.ifa,e._advertiserIFAType=t.ifaType,e._advertiserLMT=t.lmt,e._dumpIFA(),e._IFADone=!0}).failure(function(t){i&&(clearTimeout(i),i=null),e._api.console.error("Get ifa fail: "+t),e._IFADone=!0})}}},t.prototype.comcastPlatformInit=function(){var e=this;this._comcastAsyncFinished=!1,document.addEventListener("onMoneyBadgerReady",function(){e._api.console.log("Comcast: onMoneyBadgerReady"),e._requestComcastInfo()}),this._api.loadScript("https://cdn.thor.comcast.com/sdk/money-badger.min.js",4e4).always(function(){}),this._deferred.resolve()},t.prototype.netrangeExitParent=function(e){e=="portal"?this.exitParentById(e):(this._api.console.log("history.back"),history.back())},t.prototype.addCacheBuster=function(e){return this._api.locationURLAddParam(e,"_pwchbr",""+Date.now())},t.prototype.exitParentById=function(e){if(e&&this._api.sdkSettings.products&&this._api.sdkSettings.products[e]&&this._api.sdkSettings.products[e].url){this._api.console.log("Exit to: "+e);var t=this._api.resolvePath(this._api.sdkSettings.products[e].url);t=this._addSystemLaunchParameters(t),t=this.addCacheBuster(t),this._api.sdkSettings.forceHistory===!0?document.location.href=t:document.location.replace(t)}else this._api.console.log("history.back"),history.back()},t.prototype.comcastExitPortal=function(){console.log("comcastExitPortal"),typeof $badger!="undefined"&&typeof $badger.shutdown=="function"?(this._api.console.log("Comcast: call $badger.shutdown"),$badger.shutdown()):(this._api.console.error("Comcast: function undefined $badger.shutdown"),window.close())},t.prototype.exitByCloseMessage=function(){console.log("exitToHubByCloseMessage"),window.parent.postMessage("close","*")},t.prototype.comcastLoadingCompleted=function(){var t=this,n=e.Api.locationGetParam("firstLaunch");this._api.console.log("isFirstLaunch = "+n),n=="1"&&(typeof $badger!="undefined"&&typeof $badger.active=="function"&&$badger.active()?this.callDismissLoadingScreen():document.addEventListener("onMoneyBadgerReady",function(){t.callDismissLoadingScreen()},!1))},t.prototype.callDismissLoadingScreen=function(){typeof $badger!="undefined"&&typeof $badger.dismissLoadingScreen=="function"?(this._api.console.log("call: $badger.dismissLoadingScreen"),$badger.dismissLoadingScreen()):typeof $badger!="undefined"&&typeof $badger.launchCompletedMetricsHandler=="function"?(this._api.console.log("call: $badger.launchCompletedMetricsHandler"),$badger.launchCompletedMetricsHandler()):this._api.console.error("ERROR: $badger or $badger.dismissLoadingScreen undefined")},t.prototype.vidaaPlatformInit=function(){typeof Hisense_disableVKB=="function"&&Hisense_disableVKB(),this._deferred.resolve()},t.prototype.crazyGamesPlatformInit=function(){var e=this;this._isCrazyGamesPlatformReady=!1,this._api.loadScript(this._api.sdkSettings.crazygamessdk,12e4).always(function(){var t=CrazyGames.CrazySDK.getInstance();t.init(),e._isCrazyGamesPlatformReady=!0}),this._deferred.resolve()},t.prototype.pokiPlatformInit=function(){var e=this;this._isPokiPlatformReady=!1,this._api.loadScript(this._api.sdkSettings.pokisdk,12e4).always(function(){PokiSDK!==undefined&&PokiSDK.init(),e._isPokiPlatformReady=!0}),window.addEventListener("keydown",function(e){["ArrowDown","ArrowUp"," "].indexOf(e.key)>=0&&e.preventDefault()}),window.addEventListener("wheel",function(e){e.preventDefault()}),this._deferred.resolve()},t.prototype.getMultiControllerManager=function(){return this._multiControllerManager},t.prototype.airConsolePlatformInit=function(){var t=this;this._isAirConsolePlatformReady=!1,this._api.loadScript(this._api.sdkSettings.airconsolesdk,12e4).always(function(){AirConsole!==undefined&&(t._airconsole=new AirConsole,t._multiControllerManager=new e.MultiControllerManager(t._api,t._airconsole)),t._isAirConsolePlatformReady=!0}),this._deferred.resolve()},t.prototype.airConsoleExitPortal=function(){this._airconsole.navigateHome()},t.prototype.firetvPlatformInit=function(){var e=this;this._isAmazonPlatformReady=!1;var t=document.createElement("meta");t.name="viewport",t.content="width=1280, user-scalable=no",document.getElementsByTagName("head")[0].appendChild(t),document.addEventListener("touchmove",function(e){e.preventDefault()}),document.addEventListener("amazonPlatformReady",function(){e._api.console.log("amazonPlatformReady"),e._isAmazonPlatformReady=!0,document.addEventListener("pause",function(){e._onPause()},!1),document.addEventListener("resume",function(){e._onResume()},!1),e._api.getKeyManager().popStateHandling(!0),e._fitScreen()},!1),this._api.loadScript(this._api.sdkSettings.firetvsdk,12e4).always(function(){e._deferred.resolve()}),this._deferred.resolve()},t.prototype.firetvExitPortal=function(){this._api.getKeyManager().popStateHandling(!1).always(function(){window.open("","_self").close()})},t.prototype.hopperPlatformInit=function(){this._deferred.resolve()},t.prototype.hopperPlatformExitPortal=function(){console.log("Hopper exit: window.top.postMessage('exit','*');"),window.top.postMessage("exit","*")},t.prototype.dtvExitPortal=function(){typeof navigator["Exit"]=="function"?(console.log("Call: navigator.Exit"),navigator.Exit()):(typeof navigator["gc"]=="function"&&navigator.gc(0),history.back())},t.prototype.dtvPlatformInit=function(){typeof navigator["setResolution"]=="function"&&navigator.setResolution(1280,720),typeof navigator["suppressOSD"]=="function"&&navigator.suppressOSD(),this._deferred.resolve()},t.prototype.exitWindowClose=function(){console.log(this._api.getPlatformName()+" exit: window.close()"),window.close()},t.prototype.exitParent=function(e){var t=this;this._api.console.log("SDK: exit parent");if(this._api.sdkSettings.useLocationReplace&&e){this._api.getKeyManager().popStateHandling(!1).always(function(){t.exitParentById(e);return});return}switch(this._api.getPlatformName()){case r.LG:this._exitParentLG(e);break;case r.FIRETV:this._exitParentFireTV(e);break;case r.SKY:this.exitParentById(e);break;case r.COMCAST:case r.VIDEOTRON:case r.SHAW:case r.COX:case r.ROGERS:this.exitParentById(e);break;case r.NETRANGE:this.netrangeExitParent(e);break;default:this._exitParent(e)}},t.prototype._exitParentLG=function(e){var t=this;window.parent&&window.parent.postMessage("popstate","*"),this._api.getKeyManager().popStateHandling(!1).always(function(){t._api.processLater(function(){t._api.sdkSettings.forceHistory===!0?history.back():t.exitParentById(e)})})},t.prototype.samsungExitSmartHub=function(){var t=new e.IFrame.Message(this._api);this._api.getExitRequest()===e.ExitRequest.broadcast?(this._api.console.log("exitToBroadcast"),t.request(e.IFrame.Messages.exitToBroadcast,null,!0)):(this._api.console.log("exitToSmartHub"),t.request(e.IFrame.Messages.exitToSmartHub,null,!0))},t.prototype.exitSmartTV=function(){console.log("SDK: exitSmartTV: "+this._api.getPlatformName());if(typeof this[this._api.sdkSettings.exitMethod]=="function"){this[this._api.sdkSettings.exitMethod]();return}switch(this._api.getPlatformName()){case r.SAMSUNG:this.samsungExitSmartHub();break;case r.VEWD:case r.VIDAA:case r.SKY:case r.LGI:case r.BEIN:case r.OPERA:this.exitWindowClose();break;case r.LG:this.lgExitPortal();break;case r.PHILIPS:this.philipsExitPortal();break;case r.ZEASN:this.zeasnExitPortal();break;case r.VIZIO:case r.VIZIO_VIA:this._vizioExitHome();break;case r.ATT_GENIE:this.dtvExitPortal();break;case r.TIVO:this.tivoExitPortal();break;case r.FIRETV:this.firetvExitPortal();break;case r.CORDOVA:case r.ATT_OSPREY:this.cordovaExitPortal();break;case r.MINI4K:this.mini4kExitPortal();break;case r.HOPPER:this.hopperPlatformExitPortal();break;case r.COMCAST:case r.VIDEOTRON:case r.SHAW:case r.COX:case r.ROGERS:this.comcastExitPortal();break;case r.LIGHTNING:this.exitByCloseMessage();break;case r.AIRCONSOLE:this.airConsoleExitPortal();break;default:this.exitParent()}},t.prototype._vizioExitHome=function(){this._api.console.log("vizioExitHome"),window.VIZIO&&window.VIZIO.exitApplication?(this._api.console.log("window.VIZIO.exitApplication()"),window.VIZIO.exitApplication()):this.exitWindowClose()},t.prototype.generateUUID=function(){var e=(new Date).getTime()+Math.floor(Math.random()*1e3);return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+Math.floor(Math.random()*16))%16|0;return e=Math.floor(e/16),(t==="x"?n:n&3|8).toString(16)})},t.prototype.isValidGUID=function(e){return typeof e!="string"?!1:/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e)},t.prototype._getVirtualUID=function(){var e=this._api.getStorage().getKey(t.DEVICE_STORAGE_KEY_NAME,null,!0);return e||(e=this.generateUUID(),this._api.getStorage().setKey(t.DEVICE_STORAGE_KEY_NAME,e,null,!0)),e},t.prototype.getUserUID=function(){var n=this,i=new e.Deferred(this._api);switch(this._api.getPlatformName()){case r.FIRETV:if(typeof AmazonIapV2!="undefined"&&typeof AmazonIapV2.getUserData=="function"&&typeof AmazonIapV2.addListener=="function"){var s=function(e){e&&e.response&&e.response.amazonUserData?i.resolve(e.response.amazonUserData.userId):i.resolve(null),typeof AmazonIapV2.removeListener=="function"&&AmazonIapV2.removeListener("getUserDataResponse",s)};AmazonIapV2.addListener("getUserDataResponse",s),AmazonIapV2.getUserData()}else i.resolve(this._getVirtualUID());break;case r.COMCAST:case r.COX:case r.VIDEOTRON:case r.SHAW:case r.ROGERS:var o=function(){n._comcastInfo&&n._comcastInfo.deviceHash?i.resolve(n._comcastInfo.deviceHash):i.reject("Fail to retrieve user identification")};if(this._comcastAsyncFinished)o();else var u=setInterval(function(){n._comcastAsyncFinished&&(o(),clearInterval(u))},t.DEVICE_UUID_CHECK_INTERVAL);break;case r.VIZIO:case r.VIZIO_VIA:window.VIZIO&&window.VIZIO.getDeviceId?window.VIZIO.getDeviceId(function(e){i.resolve(e)}):i.resolve(this._getVirtualUID());break;case r.VIDAA:var a=!1;if(typeof Hisense_GetDeviceID=="function"){var f=Hisense_GetDeviceID();typeof f=="string"&&f.length>12?i.resolve(l):a=!0}else a=!0;a&&i.resolve(this._getVirtualUID());break;default:var l=this._getVirtualUID();i.resolve(l)}return i},t.prototype.getUserAgent=function(){var e=window.navigator.userAgent;return e},t.prototype.getCustomerUID=function(){var t=new e.Deferred(this._api);switch(this._api.getPlatformName()){case r.VIZIO:case r.VIZIO_VIA:window.VIZIO&&window.VIZIO.getDeviceId?window.VIZIO.getDeviceId(function(e){t.resolve(e)}):t.resolve(this._getVirtualUID());break;default:var n=this._getVirtualUID();t.resolve(n)}return t},t.prototype.getGooglePALSDKEncryptedString=function(){return this._googlePALSDK||(this._googlePALSDK=new e.GooglePALSDK(this._api)),this._googlePALSDK.getEncryptedString()},t.prototype.tivoExitPortal=function(){var t=e.Api.locationGetParam("TWMReturnUrl");t?(t=decodeURI(t),t.charAt(0)==='"'&&t.charAt(t.length-1)==='"'&&(t=t.substr(1,t.length-2)),t.charAt(0)==="'"&&t.charAt(t.length-1)==="'"&&(t=t.substr(1,t.length-2)),location.replace(t)):tivo.core.exit()},t.prototype._exitParent=function(e){var t=this;this._api.getKeyManager().popStateHandling(!1).always(function(){t._api.console.log("history.back"),history.back()})},t.prototype._exitParentFireTV=function(e){var n=this;this._api.getKeyManager().popStateHandling(!1).always(function(){setTimeout(function(){n._api.console.log("FireTV: history.back()"),history.back()},t.FIRETV_DELAY_POPSTATE)})},t.prototype._isComcastSmartTV=function(){return this._api.console.log("info.partnerId = "+this._comcastInfo.partnerId),this._comcastInfo&&this._comcastInfo.partnerId=="xglobal"?!0:!1},t.prototype.isExtraExitAvailable=function(){return this._isComcastSmartTV()},t.testBoxModel=function(e){if(!e||e.length<=0)return!1;var t=window.navigator.userAgent;if(!t)return!1;for(var n=0;n<e.length;n++)if(t.indexOf(e[n])>=0)return!0;return!1},t.prototype.isLowEndDevice=function(){if(typeof this._isLowEndDevice!="undefined")return this._isLowEndDevice;var e=this._api.sdkSettings.lowEndSettings;this._api.productSettings.lowEndSettings&&(e=this._api.productSettings.lowEndSettings);if(e&&e.enabled)if(e.byPlatform===!0)this._isLowEndDevice=!0;else if(e.byModels){var t=window.navigator.userAgent;for(var n=0;n<e.byModels.length;n++)if(t.indexOf(e.byModels[n])>=0){this._isLowEndDevice=!0;break}}else this._isLowEndDevice=!1;else this._isLowEndDevice=!1;return this._isLowEndDevice},t.prototype.isExitAvailable=function(){if(this._api.sdkSettings.isExitNotAvailable&&!this._api.getParentProductId()&&!this._getExitTo())return!1;switch(this._api.getPlatformName()){case r.LG:case r.WEBOS:case r.GD:if(!this._api.getParentProductId()&&!this._getExitTo())return!1;break;case r.COMCAST:case r.VIDEOTRON:case r.SHAW:case r.COX:case r.ROGERS:if(!this._api.getParentProductId()&&this._isComcastSmartTV())return!1}return!0},t.prototype.lgExitPortal=function(){window.NetCastBack?window.NetCastBack():this._api.getKeyManager().popStateHandling(!1).always(function(){history.back()})},t.prototype._getExitTo=function(){return e.Api.locationGetParam("exitto")},t.prototype._webosPlatformInit=function(){var t=this;this._api.getKeyManager().addListener(e.Key.ListenerType.System,e.Key.EventType.KeyDown,function(n){var r=t.isExitAvailable(),i=t._getExitTo();if(n==e.KeyNames.KEY_BACKSPACE&&!r&&!t._api.getKeyManager().isPopStateHandlingEnabled()&&!i)return!0},this),this._api.getKeyManager().addListener(e.Key.ListenerType.System,e.Key.EventType.KeyUp,function(n){var r=t.isExitAvailable(),i=t._getExitTo();if(n==e.KeyNames.KEY_BACKSPACE&&!r&&!t._api.getKeyManager().isPopStateHandlingEnabled()&&!i)return window.parent&&window.parent.postMessage("showSystemMenu","*"),!0},this),this._deferred.resolve()},t.prototype.lgPlatformInit=function(){var t=this,n=function(){window.removeEventListener("unload",n)};window.addEventListener("unload",n),window.NetCastBack||(this.isExitAvailable()?(this._api.getKeyManager().popStateHandling(!0),window.parent&&(window.parent.postMessage("pushstate","*"),window.addEventListener("message",function(n){n&&n.data==="backspace"&&(t._api.getKeyManager().simulateKeyDown(e.KeyNames.KEY_BACKSPACE),t._api.getKeyManager().simulateKeyUp(e.KeyNames.KEY_BACKSPACE))},!0))):window.parent&&window.parent.postMessage("popstate","*")),!this.isExitAvailable()&&window.NetCastBack&&(this._api.console.log("SDK: Handle backspace"),this._api.getKeyManager().addListener(e.Key.ListenerType.System,e.Key.EventType.KeyDown,function(t){if(t==e.KeyNames.KEY_BACKSPACE)return window.NetCastBack(),!0},this),this._api.getKeyManager().addListener(e.Key.ListenerType.System,e.Key.EventType.KeyUp,function(t){if(t==e.KeyNames.KEY_BACKSPACE)return!0},this)),this._deferred.resolve()},t.prototype.jioPlatformInit=function(){var e=this;window.OnAdClose=function(){},window.OnAdReady=function(){},window.OnAdError=function(){},window.error={},window.onPause=function(){e._onPause(),console.log("JIO: onPause")},window.onResume=function(){e._onResume(),console.log("JIO: onResume")};var t=this._api.sdkSettings.audioManager.music.enabled;this._api.sdkSettings.audioManager.music.enabled=!1,this._api.getAudioManager().disable();var n=function(){t&&(e._api.getAudioManager().enable(),e._api.sdkSettings.audioManager.music.enabled=!0),e._api.getAudioManager().isMusicRequested()&&e._api.playMusic(),document.removeEventListener("keydown",n,!0)};document.addEventListener("keydown",n,!0),this._deferred.resolve()},t.prototype.textToSpeechCancel=function(){switch(this._api.getPlatformName()){case r.VIZIO:window.VIZIO&&window.VIZIO.Chromevox&&window.VIZIO.Chromevox.cancel();break;default:}},t.prototype.textToSpeechPlay=function(e){switch(this._api.getPlatformName()){case r.VIZIO:window.VIZIO&&window.VIZIO.Chromevox&&(window.VIZIO.Chromevox.cancel(),window.VIZIO.Chromevox.play(e));break;default:}},t.prototype.vizioPlatformInit=function(){var t=this,n=document.getElementsByTagName("head")[0]||document.head,r=document.createElement("script");r.src="http://localhost:12345/scfs/cl/js/vizio-companion-lib.js",n.appendChild(r),this._api.getKeyManager().addListener(e.Key.ListenerType.System,e.Key.EventType.KeyDown,function(n){return n===e.KeyNames.KEY_EXIT?(t._api.exit(e.ExitRequest.smarttv),!0):!1},this);var i=window.navigator.userAgent;if(i.indexOf("SmartCast")>=0){this._IFADone=!1;var s=setTimeout(function(){t._api.console.log("Vizio SmartCast initialization timeout"),t._IFADone=!0},15e3);document.addEventListener("VIZIO_LIBRARY_DID_LOAD",function(e){window.VIZIO.setAdvertiserIDListener(function(e){clearTimeout(s),t._advertiserIFA=e.IFA,t._advertiserIFAType=e.IFA_TYPE,t._advertiserLMT=e.LMT,t._IFADone=!0,t._dumpIFA()})},!1)}this._deferred.resolve()},t.prototype.needSynchronize=function(){return!this._SPSLIBInitialized||!this._IFADone||!this._sniffingDone||!this._comcastAsyncFinished||!this._isAmazonPlatformReady||!this._isAirConsolePlatformReady},t.prototype.getAdIFAId=function(){return this._advertiserIFA},t.prototype.getAdIFAType=function(){return this._advertiserIFAType},t.prototype.getAdLmt=function(){var t=this._api.getPlatformName();if(t==r.COMCAST||t==r.VIDEOTRON||t==r.SHAW||t==r.COX||t==r.ROGERS)this._advertiserLMT=e.Api.locationGetParam("lmt"),this._advertiserLMT||(this._advertiserLMT="");return this._advertiserLMT},t.prototype.gdPlatformInit=function(){var e=this,t=this;window._TGH5OnGDAdsEvent=function(e){},window.addEventListener("message",function(e){var n;try{n=JSON.parse(e.data)}catch(r){return}switch(n.type){case"SDK_GAME_START":t._onResume();break;case"SDK_GAME_PAUSE":t._onPause();break;case"STARTED":case"ALL_ADS_COMPLETED":case"AD_ERROR":window._TGH5OnGDAdsEvent(n.type)}});var n=this._api.sdkSettings.audioManager.music.enabled;this._api.sdkSettings.audioManager.music.enabled=!1,this._api.getAudioManager().disable();var r=function(){n&&(e._api.getAudioManager().enable(),e._api.sdkSettings.audioManager.music.enabled=!0),e._api.getAudioManager().isMusicRequested()&&e._api.playMusic(),document.removeEventListener("keydown",r,!0),document.removeEventListener("click",r,!0)};document.addEventListener("keydown",r,!0),document.addEventListener("click",r,!0),this._deferred.resolve()},t.prototype.philipsExitPortal=function(){window.history.go(-999)},t.prototype.zeasnExitPortal=function(){typeof SmartTvA_API!="undefined"&&smarttv_platform&&smarttv_platform.major>=3&&SmartTvA_API.exit?SmartTvA_API.exit():(window.history.go(-999),window.close())},t.prototype._isFitEnabled=function(){return this._api.sdkSettings.fitSettings&&this._api.sdkSettings.fitSettings.enabled||e.Api.locationGetParam("fit")=="1"},t.prototype._fitScreenInit=function(){var e=this;if(!this._isFitEnabled()){this._api.sdkSettings.screenResolution.height=window.innerHeight,this._api.sdkSettings.screenResolution.width=window.innerWidth;return}this._fitScreen();if(this._api.sdkSettings.fitSettings.dynamicFit){var t=window.innerWidth,n=window.innerHeight,r=function(){return t!=window.innerWidth||n!=window.innerHeight?(t=window.innerWidth,n=window.innerHeight,e._fitScreen(),!0):!1};window.addEventListener("resize",r,!1),window.addEventListener("orientationchange",r,!1),window.addEventListener("deviceorientation",r,!1)}},t.prototype._fitScreen=function(){if(!this._isFitEnabled())return;var e=this._api.sdkSettings.fitSettings,t=e.fitToWidth,n=e.fitToHeight,r=!0,i,s;typeof t=="number"&&t>0?i=t:i=window.innerWidth,typeof n=="number"&&n>0?s=n:s=window.innerHeight,this._api.console.log("Fit to: "+i+"x"+s);var o=i/this._api.sdkSettings.screenResolution.width,u=s/this._api.sdkSettings.screenResolution.height;r&&(e.fillByMinSide?u=o=Math.max(o,u):u=o=Math.min(o,u)),this._transformX=Math.round((i-this._api.sdkSettings.screenResolution.width*o)/2),this._transformY=Math.round((s-this._api.sdkSettings.screenResolution.height*u)/2);var a=" translate("+this._transformX+"px, "+this._transformY+"px )",f="0 0";e.useScale2d?a+=" scale("+o+" , "+u+")":a+=" scale3d("+o+" , "+u+",1)",document.body.style.webkitTransform=a,document.body.style.webkitTransformOrigin=f,document.body.style.transform=a,document.body.style.transformOrigin=f,this._resolutionK=o},t.prototype.getResolutionK=function(){return this._resolutionK},t.prototype.transformX=function(){return this._transformX},t.prototype.transformY=function(){return this._transformY},t.prototype.gameplayStart=function(){this.callExternalApi("gameplayStart")},t.prototype.gameplayStop=function(){this.callExternalApi("gameplayStop")},t.prototype.getExternalManager=function(){switch(this._api.getPlatformName()){case r.AIRCONSOLE:return this._airconsole}return null},t.prototype.callExternalApi=function(t){var n=[];for(var i=1;i<arguments.length;i++)n[i-1]=arguments[i];var s=new e.Deferred(this._api);switch(this._api.getPlatformName()){case r.CRAZYGAMES:try{var o=CrazyGames.CrazySDK.getInstance();typeof o[t]=="function"&&o[t](n)}catch(u){this._api.console.error("Fail to call external api: "+t+", error: "+(u+""))}s.resolve();break;case r.POKI:try{typeof PokiSDK[t]=="function"&&PokiSDK[t](n)}catch(u){this._api.console.error("Fail to call external api: "+t+", error: "+(u+""))}break;case r.AIRCONSOLE:try{typeof this._airconsole[t]=="function"&&this._airconsole[t](n)}catch(u){this._api.console.error("Fail to call external api: "+t+", error: "+(u+""))}break;default:s.resolve()}return s},t.FIRETV_DELAY_POPSTATE=1e3,t.SCREEN_WIDTH=1280,t.SCREEN_HEIGHT=720,t.INACTIVITY_INTERVAL=6e4,t.DEVICE_UUID_CHECK_INTERVAL=500,t.DEVICE_STORAGE_KEY_NAME="_tg_device_id",t.SPS_LIBRARY_INITIALIZE_TIMEOUT=16e3,t.GET_IFA_TIMEOUT=8e3,t}(),e.System=t}(TGH5||(TGH5={})),function(e){var t=function(){function t(e){this._api=e,this.load()?this.isNewUser=!1:(this.country="",this.ip="",this.ip6="",this.languageCode="",this.isPlatformReported=!1,this.isNewUser=!0,this.defaultUserName="",this.pollData="",this.lastProfileId="",this.musicControlState=t.AUDIO_SWITCHED_UNDEFINED,this.soundControlState=t.AUDIO_SWITCHED_UNDEFINED,this.sessionCount=1)}return t.prototype._validateAsString=function(e){return!e||e==null||typeof e!="string"?"":e},t.prototype.save=function(){if(this._api.getStorage().isFileSystem())return;var n=new e.PackedStream;n.write(t.SAVE_VERSION),this.country=this._validateAsString(this.country),n.write(this.country),this.languageCode=this._validateAsString(this.languageCode),n.write(this.languageCode),n.write(this.isPlatformReported),this.defaultUserName=this._validateAsString(this.defaultUserName),n.write(this.defaultUserName),this.pollData=this._validateAsString(this.pollData),n.write(this.pollData),this.ip=this._validateAsString(this.ip),n.write(this.ip),this.lastProfileId=this._validateAsString(this.lastProfileId),n.write(this.lastProfileId),n.write(this.musicControlState),n.write(this.soundControlState),this.ip6=this._validateAsString(this.ip6),n.write(this.ip6),n.write(this.sessionCount),this._api.getStorage().setKey(t.STORAGE_KEY_NAME,n.toString(!0),null,!0)},t.prototype.load=function(){var n=this._api.getStorage();if(n.isFileSystem())return!1;var r=n.getKey(t.STORAGE_KEY_NAME,null,!0);if(r){n.forceRemove("_tgh5_");var i=new e.PackedStream;if(!i.init(r,!0))return this._api.reportErrorEvent(n.isLocalStorage()?e.Reporting.Errors.localStorageError:e.Reporting.Errors.cookieError,"Bad CRC in CachedSettings"),!1;var s=i.readInteger();return s!==t.SAVE_VERSION?!1:(this.country=i.readString(),this.languageCode=i.readString(),this.isPlatformReported=i.readBoolean(),this.defaultUserName=i.readString(),this.pollData=i.readString(),this.pollData||(this.pollData=""),this.ip=i.readString(),this.lastProfileId=i.readString(),this.musicControlState=i.readInteger(),this.musicControlState!=t.AUDIO_SWITCHED_ON&&this.musicControlState!=t.AUDIO_SWITCHED_OFF&&(this.musicControlState=t.AUDIO_SWITCHED_UNDEFINED),this.soundControlState=i.readInteger(),this.soundControlState!=t.AUDIO_SWITCHED_ON&&this.soundControlState!=t.AUDIO_SWITCHED_OFF&&(this.soundControlState=t.AUDIO_SWITCHED_UNDEFINED),this.ip6=i.readString(),this.sessionCount=i.readInteger(),this.sessionCount?this.sessionCount++:this.sessionCount=1,this.save(),!0)}return!1},t.SAVE_VERSION=3,t.STORAGE_KEY_NAME="_tgh5_v1",t.AUDIO_SWITCHED_ON=1,t.AUDIO_SWITCHED_OFF=2,t.AUDIO_SWITCHED_UNDEFINED=0,t}();e.CachedSettings=t}(TGH5||(TGH5={})),function(e){var t;(function(e){var t=function(){function e(e,t){this._score=t,this._name=e}return e.prototype.compareTo=function(e){return this._score===e._score?0:this._score<e._score?-1:1},e.prototype.checkScore=function(e){return this._score<=e},e.prototype.getName=function(){return this._name},e.prototype.getScore=function(){return this._score},e.prototype.write=function(e){return e.write(this._name)?e.write(this._score):!1},e.create=function(t){var n=t.read("string"),r=t.read("number");return n===null||r===null?null:new e(n,r)},e}();e.Record=t})(t=e.Leaderboards||(e.Leaderboards={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n,r;(function(e){e[e.ALLTIME=0]="ALLTIME",e[e.WEEKLY=1]="WEEKLY",e[e.MONTHLY=2]="MONTHLY"})(n=t.Type||(t.Type={})),r=function(){function n(t,n,r,i){this._maxRecords=i,this.id=n,this._recordsList=[],this._creationDate=new Date,this._type=r?r:e.Leaderboards.Type.ALLTIME,this._api=t}return n.prototype.reset=function(){this._recordsList=[]},n.prototype.getRecords=function(){return this.invalidate(),this._recordsList},n.prototype.removeRecord=function(e){return e<0||e>=this._recordsList.length?!1:(this._recordsList.splice(e,1),!0)},n.prototype.add=function(e,t){if(!e)return!1;var n=this._recordsList.length,r=!1;if(t===!0)for(var i=0;i<n;i++)if(e.compareTo(this._recordsList[i])>=0){this._recordsList.splice(i,0,e),r=!0;break}return!r&&n<this._maxRecords&&(this._recordsList.push(e),r=!0),this._recordsList.length>this._maxRecords&&this._recordsList.pop(),r},n.prototype.checkScore=function(e){this.invalidate();var t=this._recordsList.length;if(t<this._maxRecords)return!0;for(var n=0;n<t;n++)if(this._recordsList[n].checkScore(e))return!0;return!1},n.prototype.writeTo=function(e){if(!e.write(this.id))return!1;if(!e.write(this._type))return!1;if(!e.write(this._maxRecords))return!1;if(!e.write(this._creationDate.getTime()))return!1;var t=this._recordsList.length;if(!e.write(t))return!1;for(var n=0;n<t;n++)if(!this._recordsList[n].write(e))return!1;return!0},n.prototype.invalidate=function(){var t=!1;switch(this._type){case e.Leaderboards.Type.MONTHLY:var n=this._api.getMonthNumber(new Date,!0);n!=this._api.getMonthNumber(this._creationDate,true)&&(t=!0);break;case e.Leaderboards.Type.WEEKLY:var r=this._api.getWeekNumber(new Date,!0);r!=this._api.getWeekNumber(this._creationDate,true)&&(t=!0)}t&&(this.reset(),this._creationDate=new Date)},n.create=function(e,r){var i=!1,s=function(){i=!0},o=r.read("number"),u=r.read("number"),a=r.read("number"),f=r.read("number"),l=r.read("number");if(o===null||u===null||a===null||f===null||l===null)return null;var c=new n(e,o,u,a);c._creationDate=new Date(f);for(var h=0;h<l;h++)if(!c.add(t.Record.create(r)))return null;return c.invalidate(),c},n}(),t.Leaderboard=r})(t=e.Leaderboards||(e.Leaderboards={}))}(TGH5||(TGH5={})),function(e){var t=function(){function t(){this._data=[],this._index=0}return t.numberToString64=function(t){var n="",r,i=Math.abs(t);for(;;){r=i%64,n=e.Api.RADIX_64_BASE.charAt(r)+n,i=(i-r)/64;if(i===0)break}return(t<0?"-":"")+n},t.prototype.getLength=function(){return this._data.length},t.string64ToNumber=function(t){var n=0,r=t.length;if(r>0){var i=1,s=0;t.charAt(0)=="-"&&(i=-1,s++);while(s<r){var o=t.charAt(s);n=n*64+e.Api.RADIX_64_BASE.indexOf(o),s++}return i<0?-n:n}return n},t.prototype.writeBySaveMap=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];switch(r.type){case"integer":if(typeof t[r.key]=="undefined")this.write(0);else{if(typeof t[r.key]!="number")return this.onError("Key: "+r.key+" is not a "+r.type),!1;this.write(t[r.key])}break;case"string":if(typeof t[r.key]=="undefined")this.write("");else{if(typeof t[r.key]!="string")return this.onError("Key: "+r.key+" is not a "+r.type),!1;this.write(t[r.key])}break;case"boolean":if(typeof t[r.key]=="undefined")this.write(!1);else{if(typeof t[r.key]!="boolean")return this.onError("Key: "+r.key+" is not a "+r.type),!1;this.write(t[r.key])}break;case"stringArray":if(typeof t[r.key]=="undefined")this.write(0);else{if(Object.prototype.toString.call(t[r.key])!=="[object Array]")return this.onError("Key: "+r.key+" is not a "+r.type),!1;this.writeStringArray(t[r.key])}break;case"integerArray":if(typeof t[r.key]=="undefined")this.write(0);else{if(Object.prototype.toString.call(t[r.key])!=="[object Array]")return this.onError("Key: "+r.key+" is not a "+r.type),!1;this.writeIntegerArray(t[r.key])}}}return!0},t.prototype.readBySaveMap=function(e){var t={};for(var n=0;n<e.length;n++){var r=e[n];switch(r.type){case"integer":t[r.key]=this.readInteger();break;case"string":t[r.key]=this.readString();break;case"boolean":t[r.key]=this.readBoolean();break;case"stringArray":t[r.key]=this.readStringArray();break;case"integerArray":t[r.key]=this.readIntegerArray()}}return t},t.prototype.writeArray=function(e){if(e&&e.length>0){this.write(e.length);for(var t=0;t<e.length;t++)this.write(e[t])}else this.write(0)},t.prototype.writeStringArray=function(e){this.writeArray(e)},t.prototype.writeIntegerArray=function(e){this.writeArray(e)},t.prototype.readStringArray=function(){var e=[],t=this.readInteger();if(t)for(var n=0;n<t;n++)e.push(this.readString());return e},t.prototype.readIntegerArray=function(){var e=[],t=this.readInteger();if(t)for(var n=0;n<t;n++)e.push(this.readInteger());return e},t.prototype.write=function(e){var n=null;switch(typeof e){case"string":n=e.replace(t.SEPARATOR_ESCAPE_REG,t.SEPARATOR_CODE);break;case"number":if(e%1!==0)return this.onError("Couldn't parse number value: "+e),!1;n=t.numberToString64(e);break;case"boolean":n=""+(e?1:0);break;default:this.onError("Could not add value of type: "+typeof e)}return n!==null?(this._data.push(n),!0):!1},t.prototype.appendPackedStream=function(e){return this._data=this._data.concat(e._data),!0},t.prototype.toString=function(e){var n="";return e===!0&&(n=t.numberToString64(this.calcCRC())+t.SEPARATOR),n+this._data.join(t.SEPARATOR)},t.prototype.calcCRC=function(){return e.Api.calculateCRC(this._data.join(""))},t.prototype.init=function(e,n){this._data=e.split(t.SEPARATOR);if(n===!0){if(this._data.length<1)return!1;var r=this._data[0];this._data.splice(0,1);if(this.calcCRC()!==t.string64ToNumber(r))return!1}return this._index=0,!0},t.prototype.checkOutOfRange=function(){return this._index<this._data.length?!1:(this.onError("out of range"),!0)},t.prototype.isEnd=function(){return this._index>=this._data.length},t.prototype.onError=function(e){console.error(e)},t.prototype.readLastNumber=function(){var e=this._data[this._data.length-1],n=t.string64ToNumber(e);return isNaN(n)?(this.onError("Number is NaN: "+e),null):n},t.prototype.read=function(e){if(this.checkOutOfRange())return null;var n=this._data[this._index++];switch(e){case"string":return""+n.replace(t.SEPARATOR_UNESCAPE_REG,t.SEPARATOR);case"number":var r=t.string64ToNumber(n);if(isNaN(r))return this.onError("Number is NaN: "+n),null;return r;case"boolean":if(n==="1")return!0;if(n==="0")return!1;this.onError("Couldn't parse boolean value: "+n);break;default:this.onError("Could not read value of type: "+e)}return null},t.prototype.readInteger=function(){return this.read("number")},t.prototype.readString=function(){return this.read("string")},t.prototype.readBoolean=function(){return this.read("boolean")},t.prototype.readPackedStream=function(){var e=new t,n=this.readInteger();if(n===null)return null;for(var r=0;r<n;r++){if(this.checkOutOfRange())return null;e._data.push(this._data[this._index++])}return e},t.prototype.writePackedStream=function(e){var t=e._data.length;this.write(t);for(var n=0;n<t;n++)this._data.push(e._data[n]);return!0},t.SEPARATOR="_",t.SEPARATOR_CODE="%"+t.SEPARATOR.charCodeAt(0).toString(16),t.SEPARATOR_ESCAPE_REG=RegExp(t.SEPARATOR,"g"),t.SEPARATOR_UNESCAPE_REG=RegExp(t.SEPARATOR_CODE,"gi"),t}();e.PackedStream=t}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function n(e){this._leaderBoardsList=[],this._api=e}return n.prototype.reset=function(){this._leaderBoardsList=[]},n.prototype.createLeaderBoard=function(r,i,s){if(typeof r=="undefined")return!1;for(var o=0;o<this._leaderBoardsList.length;o++)if(this._leaderBoardsList[o].id===r)return!1;return this._leaderBoardsList.push(new e.Leaderboards.Leaderboard(this._api,r,i?i:t.Type.ALLTIME,s?s:n.DEFAULT_MAX_RECODRDS)),!0},n.prototype.checkScore=function(e,t){if(typeof e=="undefined"||typeof t!="number")return!1;for(var n=0;n<this._leaderBoardsList.length;n++){var r=this._leaderBoardsList[n];if(r.id===e)return r.checkScore(t)}return!1},n.prototype.addScore=function(t,n,r){if(typeof t!="number"||typeof r!="number"||typeof n!="string")return!1;for(var i=0;i<this._leaderBoardsList.length;i++){var s=this._leaderBoardsList[i];if(s.id===t)return s.invalidate(),s.add(new e.Leaderboards.Record(n,r),!0)}return!1},n.prototype.getRecords=function(e){for(var t=0;t<this._leaderBoardsList.length;t++){var n=this._leaderBoardsList[t];if(n.id===e)return n.getRecords()}return null},n.prototype.removeRecord=function(e,t){for(var n=0;n<this._leaderBoardsList.length;n++){var r=this._leaderBoardsList[n];if(r.id===e)return r.removeRecord(t)}return!1},n.prototype.writeTo=function(e){if(!e.write(this._leaderBoardsList.length))return!1;for(var t=0;t<this._leaderBoardsList.length;t++)if(!this._leaderBoardsList[t].writeTo(e))return!1;return!0},n.prototype.readFrom=function(e){this.reset();var n=e.read("number");if(n===null)return!1;for(var r=0;r<n;r++){var i=t.Leaderboard.create(this._api,e);if(i===null)return!1;this._leaderBoardsList.push(i)}return!0},n.DEFAULT_MAX_RECODRDS=10,n}();t.LeaderboardManager=n})(t=e.Leaderboards||(e.Leaderboards={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function t(e,t,n,r){this.params=r,this.src=t,this._api=e,this.isLoaded=!1,this._cacheEl=n,this._imgEl=null,this._notLoadedByTimeout=!1,this._loadDeferred=null}return t.prototype.getGroup=function(){return this.params.group},t.prototype.update=function(n){var r=this;if(this.isLoaded)return;this._img&&(typeof this._img.naturalWidth!="undefined"?this.isLoaded=this._img.complete&&this._img.naturalWidth!==0:this.isLoaded=this._img.complete);if(this.isLoaded)this.onLoad();else{this._loadTime+=n;var i=this._api.sdkSettings.resourceManager;this._loadTime>i.loadingTimeout&&(this._api.console.error("Image loading timeout: "+this._img.src),this._api.reportErrorEvent(e.Reporting.Errors.loadingError,"Image loading timeout attempt: "+this._numAttempts+", src: "+this._img.src),this._loadTime=0,this._numAttempts++,this.suspendImage(function(){setTimeout(function(){r._numAttempts<i.attemptsCount?r.requestImage(r.src):(r._notLoadedByTimeout=!0,r.requestImage(t.emptyImage))},i.postImageDelay)}))}},t.prototype.getHTMLElement=function(){return this._img},t.prototype.getData=function(){return this._img},t.prototype.onLoad=function(){var e=this;this.isLoaded=!0,setTimeout(function(){e._notLoadedByTimeout?e._loadDeferred.reject(e):(e._api.sdkSettings.resourceManager.disableImageCache?e._imgEl=null:(e._imgEl=document.createElement("div"),e._imgEl.setAttribute("style","position:fixed;top:0;left:1279px;width:1px;height:1px;background-image:url('"+e._rSrc+"')"),e._cacheEl.appendChild(e._imgEl)),e._loadDeferred.resolve(e))},this._api.sdkSettings.resourceManager.postImageDelay)},t.prototype.suspendImage=function(e){var n=this;this._imgEl&&(this._imgEl.style.backgroundImage="url('"+t.emptyImage+"')"),this._img&&(this._img.src=t.emptyImage),this._api.processLater(function(){n._imgEl!==null&&(n._imgEl.parentNode&&(n._imgEl=n._imgEl.parentNode.removeChild(n._imgEl)),n._imgEl=null),n._img=null,n.isLoaded=!1,n._notLoadedByTimeout=!1,e&&e()})},t.prototype.requestImage=function(e){this._img=document.createElement("img");var t=this._api.sdkSettings.resourceManager;t.crossOriginAnonymous!==!1&&this._img.setAttribute("crossOrigin","anonymous"),this._rSrc=this._api.getResourceManager().resolvePath(e),this._img.src=this._rSrc,this._imgEl=null,this._loadTime=0},t.prototype.suspend=function(e){this.suspendImage(e),this._cacheEl=null,this._loadDeferred=null},t.prototype.load=function(){return this._numAttempts=0,this._loadDeferred=new e.Deferred(this._api),this.requestImage(this.src),this._loadDeferred},t.emptyImage="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",t}();t.Image=n})(t=e.Resources||(e.Resources={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function t(e,t,n,r){this.params=r,this.src=t,this._api=e,this.isLoaded=!1,this._cacheEl=n,this._fontEl=null,this._textEl=null,this._notLoadedByTimeout=!1}return t.registerTTFFont=function(e,t){var n=document.createElement("style");return n.setAttribute("type","text/css"),n.innerHTML='@font-face {font-family: "'+e+'";'+'src: url("'+t+'") format("truetype");}',document.head.appendChild(n),n},t.createEmptyFont=function(e,n){n.sdkSettings.resourceManager.fontSimpleFlow?t._simpleFlow=!0:t._simpleFlow=!1;if(!t._simpleFlow)try{t.registerTTFFont(t.emptyFrontFamily,t.emptyFont);var r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:1279px;font-size:5px",r.style.fontFamily='"'+t.emptyFrontFamily+'"',r.innerHTML="A",e.appendChild(r),getComputedStyle(r,null).getPropertyValue("width")}catch(i){t._simpleFlow=!0}},t.prototype.getGroup=function(){return this.params.group},t.prototype.update=function(n){var r=this;if(!this._textEl||this.isLoaded)return;if(t._simpleFlow){this.onLoad();return}this._loadTime+=n;var i=this._api.sdkSettings.resourceManager;this._loadTime>i.loadingTimeout&&(this._api.console.error("Font loading timeout: "+this._fontSrc),this._api.reportErrorEvent(e.Reporting.Errors.loadingError,"Font loading timeout attempt: "+this._numAttempts+", src: "+this._fontSrc),this._loadTime=0,this._numAttempts++,this._numAttempts<i.attemptsCount?(this.suspendFont(),setTimeout(function(){r.requestFont()},i.postFontDelay)):(this._notLoadedByTimeout=!0,this.onLoad()));if(this._textEl){var s=getComputedStyle(this._textEl,null).getPropertyValue("width").replace("px","");s!=="0"&&this.onLoad()}},t.prototype.onLoad=function(){var e=this;this._textEl.style.width="1px",this._textEl.style.height="1px",this.isLoaded=!0,setTimeout(function(){e._notLoadedByTimeout?e._loadDeferred.reject(e):e._loadDeferred.resolve(e)},this._api.sdkSettings.resourceManager.postFontDelay)},t.prototype.requestFont=function(){this._loadTime=0,this._fontEl=t.registerTTFFont(this._fontFamily,this._api.getResourceManager().resolvePath(this._fontSrc)),this._textEl=document.createElement("div"),this._textEl.style.cssText="position:fixed;top:0;left:1279px;font-size:20px;",t._simpleFlow?this._textEl.style.fontFamily='"'+this._fontFamily+'"':this._textEl.style.fontFamily='"'+this._fontFamily+'", "'+t.emptyFrontFamily+'"',this._textEl.innerHTML="AA",this._cacheEl.appendChild(this._textEl),getComputedStyle(this._textEl,null).getPropertyValue("width")},t.prototype.load=function(){var n=this,r=this.src.split("|");if(r.length!=2)throw"Font src should be: FontFamily|FontRelativePath.ttf";return this._fontFamily=r[0],this._fontSrc=r[1],this._loadDeferred=new e.Deferred(this._api),this._fontEl=null,this._textEl=null,this._numAttempts=0,t.needToWaitEmptyFont?(t.needToWaitEmptyFont=!1,setTimeout(function(){n.requestFont()},this._api.sdkSettings.resourceManager.postFontDelay)):this.requestFont(),this._loadDeferred},t.prototype.suspendFont=function(){this._fontEl&&this._fontEl.parentNode&&(this._fontEl.parentNode.removeChild(this._fontEl),this._fontEl=null),this._textEl&&(this._cacheEl.removeChild(this._textEl),this._textEl=null)},t.prototype.suspend=function(e){this.suspendFont(),this._notLoadedByTimeout=!1,this._cacheEl=null,this._loadDeferred=null,e&&e()},t.prototype.getHTMLElement=function(){return null},t.prototype.getData=function(){return null},t._simpleFlow=!1,t.emptyFont="data:application/x-font-ttf;base64,AAEAAAAKAIAAAwAgT1MvMgAAAAAAAACsAAAAWGNtYXAAAAAAAAABBAAAACxnbHlmAAAAAAAAATAAAAAQaGVhZAAAAAAAAAFAAAAAOGhoZWEAAAAAAAABeAAAACRobXR4AAAAAAAAAZwAAAAIbG9jYQAAAAAAAAGkAAAACG1heHAAAAAAAAABrAAAACBuYW1lAAAAAAAAAcwAAAAgcG9zdAAAAAAAAAHsAAAAEAAEAAEAZAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAABAAMAAQAAAAwABAAgAAAABAAEAAEAAABB//8AAABB////wAABAAAAAAABAAAAAAAAAAAAAAAAMQAAAQAAAAAAAAAAAABfDzz1AAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAEAAgAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAIAAAAAQAAAAIAAQABAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAIAHgADAAEECQABAAAAAAADAAEECQACAAIAAAAAAAEAAAAAAAAAAAAAAAAAAA==",t.emptyFrontFamily="empty_font_tgh5",t.needToWaitEmptyFont=!0,t}();t.Font=n})(t=e.Resources||(e.Resources={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function t(e,t){this.src=t,this._api=e,this.isLoaded=!1,this._loadDeferred=null}return t.prototype.getGroup=function(){return-2},t.prototype.update=function(e){},t.prototype.onLoad=function(e){this.isLoaded=!0,e?this._loadDeferred.reject(this):this._loadDeferred.resolve(this)},t.prototype.getData=function(){return this._data},t.prototype.getHTMLElement=function(){return null},t.prototype.requestJson=function(e){var t=this,n=this._api.sdkSettings.resourceManager;this._api.loadTextFile(e,n.loadingTimeout).fail(function(){t._numAttempts++,t._numAttempts<n.attemptsCount?t.requestJson(e):t.onLoad(!0)}).done(function(e){try{t._data=JSON.parse(e),t.onLoad(!1)}catch(n){t.onLoad(!0)}})},t.prototype.suspend=function(e){this.isLoaded=!1,this._data=null,this._loadDeferred=null,e&&e()},t.prototype.load=function(){return this._numAttempts=0,this._loadDeferred=new e.Deferred(this._api),this.requestJson(this.src),this._loadDeferred},t}();t.Json=n})(t=e.Resources||(e.Resources={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n,r=function(){function e(){}return e.Progress="progress",e.ShowPopup="showPopup",e.HidePopup="hidePopup",e}();t.ProgressEvents=r,n=function(){function n(e){this._api=e,this._resources=[],this._notLoadedByTimeout=[],this._loadingInterval=0,this._settings=this._api.sdkSettings.resourceManager,this._rootEl=document.createElement("div"),this._cacheEl=document.createElement("div"),this._rootEl.appendChild(this._cacheEl);var n=document.createElement("div"),r=window.getComputedStyle(document.body,null).getPropertyValue("background-color");n.setAttribute("style","position:fixed;top:0;left:1279px;width:1px;height:720px;background-color:"+(r?r:"#000")),this._rootEl.appendChild(n),document.body.insertBefore(this._rootEl,document.body.firstChild),t.Font.createEmptyFont(this._rootEl,this._api)}return n.prototype.getResource=function(e){return e>=0&&e<this._resources.length?this._resources[e]:null},n.prototype.unloadAllResources=function(){this._resources.length=0},n.prototype.unloadResources=function(t,n){var r=this,i=[],s=new e.Deferred(this._api,undefined,n);for(var o=0;o<t.length;o++){var u=this.indexOfResource(t[o]),a=this.getResource(u);if(a){i.push(a),this._resources.splice(u,1);var f=this._notLoadedByTimeout.indexOf(a);f>=0&&this._notLoadedByTimeout.splice(f,1)}}var l=function(){if(i.length>0){var e=Math.min(i.length,r._settings.parallelUnloads),t=0,n=function(){t++,t===e&&l()};for(var o=0;o<e&&i.length>0;o++)i.pop().suspend(n)}else s.resolve(),s=null};return this._api.processLater(function(){return l()}),s},n.prototype.createResource=function(t){var n,r,i=this._api.sdkSettings.resourceManager.supportedImages;for(r=0;r<i.length;r++){n="data:image/"+i[r].ext.substr(1);if(t.substr(0,n.length).toLowerCase()===n)return new e.Resources.Image(this._api,t,this._cacheEl,i[r])}var s=t.toLowerCase(),o=t.length,i=this._api.sdkSettings.resourceManager.supportedImages;for(r=0;r<i.length;r++){n=i[r].ext;if(s.lastIndexOf(n)+n.length==o)return new e.Resources.Image(this._api,t,this._cacheEl,i[r])}n=".json";if(s.lastIndexOf(n)+n.length==o)return new e.Resources.Json(this._api,t);var u=this._api.sdkSettings.resourceManager.supportedFonts;for(r=0;r<u.length;r++){n=u[r].ext;if(s.lastIndexOf(n)+n.length==o)return new e.Resources.Font(this._api,t,this._cacheEl,u[r])}throw"Unsupported resource format: "+t},n.prototype.indexOfResource=function(e){for(var t=0;t<this._resources.length;t++)if(e===this._resources[t].src)return t;return-1},n.prototype.isCached=function(e){var t=this.getResource(this.indexOfResource(e));return t&&t.isLoaded},n.prototype.getResourceHTMLElement=function(e){var t=this.getResource(this.indexOfResource(e));return t?t.getHTMLElement():null},n.prototype.getResourceData=function(e){var t=this.getResource(this.indexOfResource(e));return t?t.getData():null},n.prototype.getNotLoadedResourcesNames=function(){var e=[];for(var t=0;t<this._notLoadedByTimeout.length;t++)e.push(this._notLoadedByTimeout[t].src);return e},n.prototype.loadResources=function(t,n,r){var i=this;typeof n=="undefined"&&(n=!0),this._isLoadingPopup=!1,this._isLoaded=!1,this._requestedResources=[],this._loadingPool=[];for(var s=0;s<t.length;s++){var o=t[s];if(!this.isCached(o)){var u=this.createResource(o);this._requestedResources.push(u)}}return this._requestedResources.length==0?new e.Deferred(this._api,!0,r):(this._loadDeferred=new e.Deferred(this._api,undefined,r),this._requestedResources.sort(function(e,t){return t.getGroup()-e.getGroup()}),this._progressStarted=!1,this._api.processLater(function(){n===!0?i.tryLoadImmediately().fail(function(){i._isLoaded||(i._isLoadingPopup=!0,i._popupDisplayTime=0,i._loadDeferred.notify(e.Resources.ProgressEvents.ShowPopup),i.load())}):i.load()}),this._loadDeferred)},n.prototype.tryLoadImmediately=function(){var t=this,n=new e.Deferred(this._api);if(this._requestedResources.length/this._settings.parallelLoads*this._settings.postImageDelay<this._settings.loadImmediatelyTimeout){var r=Date.now();this._loadingInterval=setInterval(function(){t.update(t._settings.loadingUpdateInterval);if(!t._isLoaded){var e=Date.now()-r;e>t._settings.loadImmediatelyTimeout&&(t._loadingInterval&&(clearInterval(t._loadingInterval),t._loadingInterval=0),n.reject())}else n.resolve()},this._settings.loadingUpdateInterval)}else n.reject();return n},n.prototype.fillPool=function(){var e=-2;for(var t=0;t<this._settings.parallelLoads;t++){if(this._requestedResources.length==0)break;var n=this._requestedResources[this._requestedResources.length-1],r=n.getGroup();if(e!==-2&&e!=r)break;e=r,this._loadingPool.push(this._requestedResources.pop());if(r==-1)break}},n.prototype.startProgress=function(){this._progressStarted=!0,this._percent=0,this._numToLoad=this._requestedResources.length+this._loadingPool.length},n.prototype.updateProgress=function(t){if(!this._progressStarted)return;var n=this._requestedResources.length+this._loadingPool.length;this._percent=1-n/this._numToLoad,this._percent>1&&(this._percent=1),this._percent<0&&(this._percent=0),this._loadDeferred.notify(e.Resources.ProgressEvents.Progress,this._percent)},n.prototype.update=function(e){var t=this;this.updateProgress(e),this._isLoadingPopup&&(this._popupDisplayTime+=e);if(this._loadingPool.length==0){this.fillPool(),this._loadingPool.length==0&&this.onFinish();for(var n=0;n<this._loadingPool.length;n++)this._loadingPool[n].load().done(function(e){var n=t._loadingPool.indexOf(e);t._loadingPool.splice(n,1);var r=t._notLoadedByTimeout.indexOf(e);r>=0&&t._notLoadedByTimeout.splice(r,1),t._resources.push(e),t.updateProgress(0)}).fail(function(e){var n=t._loadingPool.indexOf(e);t._loadingPool.splice(n,1),t._resources.push(e),t._notLoadedByTimeout.push(e),t.updateProgress(0)})}var r=this._loadingPool.slice(0);for(var i=0;i<r.length;i++)r[i].update(e)},n.prototype.onFinish=function(){var t=this;this._isLoaded=!0,this._loadingInterval&&(clearInterval(this._loadingInterval),this._loadingInterval=0);var n=this._settings.postDelay;if(this._isLoadingPopup&&this._popupDisplayTime<this._settings.popupMinDisplayTime){var r=this._settings.popupMinDisplayTime-this._popupDisplayTime;r>n?n=r:n+=r}setTimeout(function(){t._isLoadingPopup&&(t._isLoadingPopup=!1,t._loadDeferred.notify(e.Resources.ProgressEvents.HidePopup)),t._loadDeferred.resolve()},n)},n.prototype.load=function(){var e=this;this.startProgress(),this._loadingInterval=setInterval(function(){e.update(e._settings.loadingUpdateInterval)},this._settings.loadingUpdateInterval)},n.prototype.getExternalServerURL=function(){return this._api.productSettings.resourcesServer?this._api.productSettings.resourcesServer:""},n.prototype.resolvePath=function(e){var t="data:";if(e.substr(0,t.length).toLowerCase()===t)return e;var n=this.getExternalServerURL();return n&&e.indexOf(n)>=0?e:n+e},n}(),t.ResourceManager=n})(t=e.Resources||(e.Resources={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t=0,n=function(){function e(e,n){this._api=e,this._receiver=n?n:window.parent,this._id="mid"+t++}return e.prototype.isOwnMessage=function(e){if(typeof e=="undefined"||typeof e!="string")return!1;var t=e.split(";");return t[1]==this._id},e.prototype.response=function(e,t){},e.prototype.release=function(){this.onResponse&&typeof this.onResponse=="function"&&(this._api.unbind(window,"message",this.onResponse),this.onResponse=null)},e.prototype.request=function(e,t,n){var r=this;this.release(),n||(this.onResponse=function(e){if(!e||!r.isOwnMessage(e.data))return;r.release();var t=e.data,n=t.split(";"),i=null;n.length>2&&(i=JSON.parse(n[2])),r.response(n[0],i)});if(typeof e!="undefined"){var i=e+";"+this._id;typeof t!="undefined"&&(i+=";"+JSON.stringify(t)),this._receiver.postMessage(i,"*")}n||this._api.bind(window,"message",this.onResponse)},e}();e.Message=n})(t=e.IFrame||(e.IFrame={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t=function(){function e(e,t){this._api=e,this._onMessage=function(e){try{var n=e.data,r=n.split(";"),i=null;r.length>2&&(i=JSON.parse(r[2])),t(r[0],i)}catch(s){}},this._api.bind(window,"message",this._onMessage)}return e.prototype.suspend=function(){this._api.unbind(window,"message",this._onMessage)},e}();e.MessageListener=t})(t=e.IFrame||(e.IFrame={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function n(e,t){this._api=e,this._iFrameSettings=t}return n.prototype.show=function(t,n){return this._deferred=new e.Deferred(this._api),this._settings=n,this._create(t),this._deferred},n.prototype._create=function(e){var r=this;this._iFrame=document.createElement("iframe"),this._iFrame.id="if_"+Math.random(),this._iFrame.name=this._iFrame.id,this._iFrame.className=this._iFrameSettings.className,e.appendChild(this._iFrame),this._message=new t.Message(this._api,this._iFrame.contentWindow),this._inputMessage=new t.Message(this._api,this._iFrame.contentWindow);var i=function(e,n){e===t.Messages.onLoaded&&n==r._iFrame.id&&(s.suspend(),o&&(clearTimeout(o),o=null),r._onLoaded())},s=new t.MessageListener(this._api,i),o=setTimeout(function(){r._api.enableInput(),s.suspend(),r._deferred.reject("Time Out"),r.suspend(!1)},n.LOADING_IFRAME_TIME);this._api.disableInput(),this._iFrame.src=this._api.resolvePath(this._iFrameSettings.src)},n.prototype._onKeyDownHandler=function(e){return this._inputMessage.request(t.Messages.onKeyDown,e,!0),!0},n.prototype._onKeyUpHandler=function(e){return this._inputMessage.request(t.Messages.onKeyUp,e,!0),!0},n.prototype._onClose=function(e){this.suspend(!0,e),this._api.enableInput()},n.prototype.onMessage=function(e,t){},n.prototype._onLoaded=function(){var n=this,r=this._api.getKeyManager();r.setEnabled(!1,e.Key.ListenerType.Product,e.Key.EventType.Any),r.addListener(e.Key.ListenerType.System,e.Key.EventType.KeyUp,this._onKeyUpHandler,this),r.addListener(e.Key.ListenerType.System,e.Key.EventType.KeyDown,this._onKeyDownHandler,this),this._message.request(t.Messages.init,this._settings),this._message.response=function(e,r){switch(e){case t.Messages.close:n._onClose(r);break;case t.Messages.restoreFocus:window.focus(),n._message.request();break;default:n.onMessage(e,r),n._message.request()}}},n.prototype.pause=function(){this._api.disableInput(),this._api.getKeyManager().setEnabled(!1,e.Key.ListenerType.System,e.Key.EventType.Any)},n.prototype.resume=function(){this._api.getKeyManager().setEnabled(!1,e.Key.ListenerType.Product,e.Key.EventType.Any),this._api.getKeyManager().setEnabled(!0,e.Key.ListenerType.System,e.Key.EventType.Any)},n.prototype.suspend=function(t,n){var r=this._api.getKeyManager();r.removeListener(e.Key.ListenerType.System,e.Key.EventType.KeyUp,this._onKeyUpHandler),r.removeListener(e.Key.ListenerType.System,e.Key.EventType.KeyDown,this._onKeyDownHandler),this._message&&this._message.release(),this._api.enableInput(),this._inputMessage&&this._inputMessage.release(),this._iFrame&&this._iFrame.parentNode&&this._iFrame.parentNode.removeChild(this._iFrame),this._iFrame=null,window.focus(),t&&this._deferred.resolve(n),this._deferred=null},n.LOADING_IFRAME_TIME=6e4,n}();t.Screen=n})(t=e.IFrame||(e.IFrame={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t=function(){function e(){}return e.requestAd="requestAd",e.adError="adError",e.adCompleted="adCompleted",e.adStarted="adStarted",e.adNoResponse="adNoResponse",e.exitToSmartHub="exitToSmartHub",e.exitToBroadcast="exitToBroadcast",e.disableAutoFocus="disableAutoFocus",e.onLoaded="onLoaded",e.init="init",e.onKeyDown="onKeyDown",e.onKeyUp="onKeyUp",e.close="close",e.launchApp="launchApp",e.paymentInit="paymentInit",e.paymentGetStatus="paymentGetStatus",e.paymentApplyProducts="paymentApplyProducts",e.paymentUnsubscribe="paymentUnsubscribe",e.paymentGetProductsInfo="paymentGetProductsInfo",e.paymentStart="paymentStart",e.paymentSuccess="paymentSuccess",e.paymentFailure="paymentFailure",e.paymentError="paymentError",e.restoreFocus="restoreFocus",e.console="console",e.success="success",e.error="error",e.cancel="cancel",e.disagree="disagree",e.request="request",e.getUserUID="getUserUID",e.getIFA="getIFA",e.requestSpsSession="requestSpsSession",e.playAudio="playAudio",e.stopAudio="stopAudio",e.onAudioEnd="onAudioEnd",e.onAudioError="onAudioError",e}();e.Messages=t})(t=e.IFrame||(e.IFrame={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(n){var r=function(){function n(e,t,r){this._api=e,this._products=r,this._settings=t,this._initialized=!1,this._checkoutInterval=null,this._settings.requestProductsTimeout||(this._settings.requestProductsTimeout=n.DEFAULT_REQUEST_PRODUCTS_TIMEOUT),this._settings.requestPaymentTimeout||(this._settings.requestPaymentTimeout=n.DEFAULT_REQUEST_PAYMENT_TIMEOUT),this._settings.applyPaymentTimeout||(this._settings.applyPaymentTimeout=n.DEFAULT_APPLY_PAYMENT_TIMEOUT),this._settings.checkoutInterval||(this._settings.checkoutInterval=n.DEFAULT_CHECKOUT_INTERVAL),this._settings.checkRequestTimout||(this._settings.checkRequestTimout=n.DEFAULT_CHECK_REQUEST_TIMEOUT),this._loadingBar=null}return n.prototype._requestProductsInfo=function(e,t){var n=this;this._productsInfo=this._products.map(function(e){return{productId:e.name,owner:e}}),this._requestServer("/products",{products:this._products.map(function(e){return{product:e.productId,projectId:e.projectId}})},this._settings.requestProductsTimeout,function(t){for(var r=0;r<t.length;r++)for(var i=0;i<n._productsInfo.length;i++){var s=n._productsInfo[i].owner;if(s.productId==t[r].product){n._productsInfo[i].name=t[r].name,n._productsInfo[i].desc=t[r].desc,n._productsInfo[i].price=t[r].price,n._productsInfo[i].currency=t[r].currency,n._productsInfo[i].period=t[r].period,n._productsInfo[i].periodValue=t[r].periodValue,n._productsInfo[i].values=null;if(t[r].desc&&t[r].desc.en){var o=t[r].desc.en.replace(/[,.]/g,"").match(/^\d+|\d+\b|\d+(?=\w)/g);if(o){n._productsInfo[i].values=[];for(var u=0;u<o.length;u++){var a=parseInt(o[u]);isNaN(a)&&(a=0),n._productsInfo[i].values.push(a)}}}break}}e()},t)},n.prototype._requestServer=function(e,t,n,r,i){var s=new XMLHttpRequest;s.open("POST",this._settings.host+e,!0);var o=!1,u=setTimeout(function(){i("Request timeout: "+e),o=!0},n);s.onreadystatechange=function(){if(s&&s.readyState===4)if(s.status===200){if(o)return;clearTimeout(u);var e;try{e=JSON.parse(s.responseText)}catch(t){i("Runtime error, fail to parse data");return}r(e)}else{if(o)return;clearTimeout(u);var n=[s.responseText,s.statusText,"(status: "+s.status+")"];i(n.filter(function(e){return!!e}).join(", "))}},s.send(JSON.stringify(t))},n.prototype._initProvider=function(){var t=this,n=new e.Deferred(this._api);return this._initialized?n.resolve():this.getUserUID().done(function(e){t._userId=e,t._requestProductsInfo(function(){t._initialized=!0,n.resolve()},function(e){n.reject(e,!1)})}).fail(function(e){n.reject(e,!0)}),n},n.prototype.getUserUID=function(){return this._api.getSystem().getUserUID()},n.prototype.applyPurchases=function(t){var n=this,r=t.map(function(e){return{product:e.productId,projectId:e.projectId?e.projectId:n._settings.projectId}});return this._applyDeferred=new e.Deferred(this._api),this._initProvider().done(function(){n._requestServer("/apply",{userId:n._userId,products:r},n._settings.applyPaymentTimeout,function(e){var r=[];if(e&&e.products)for(var i=0;i<e.products.length;i++)for(var s=0;s<t.length;s++)t[s].productId===e.products[i].product&&r.push(t[s].name);n._applyDeferred.resolve(r)},function(e){n._applyDeferred.reject(e)})}).fail(function(e,t){n._applyDeferred.reject(e)}),this._applyDeferred},n.prototype._showLoading=function(){this._loadingBar=new e.LoadingProgressBar(this._api),this._loadingBar.create(document.body)},n.prototype._hideLoading=function(){this._loadingBar&&(this._loadingBar.suspend(),this._loadingBar=null)},n.prototype._hideDialogs=function(){this.checkoutDialog&&(this.checkoutDialog.hide(),this.checkoutDialog.suspend(),this.checkoutDialog=null)},n.prototype._startCheckoutInterval=function(){var t=this;this._checkoutIntervalLocked=!1,this._checkoutInterval=setInterval(function(){if(t._checkoutIntervalLocked)return;t._checkoutIntervalLocked=!0,t._requestServer("/check",{sessionId:t._sessionId},t._settings.checkRequestTimout,function(n){t._checkoutIntervalLocked=!1;if(n.transactionCompleted){t._hideDialogs(),t._clearCheckoutInterval();if(n.error)t._onPurchaseError(n.error,!1);else if(t._settings.congratulationDialog){var r=new e.MessageDialog(t._api,t._settings.congratulationDialog);r.create(t._currentPaymentData),r.show().always(function(){r.hide(),r.suspend(),t._purchaseDeferred.resolve(!0,t._currentPaymentData.product)})}else t._purchaseDeferred.resolve(!0,t._currentPaymentData.product)}},function(e){t._checkoutIntervalLocked=!1,t._hideDialogs(),t._clearCheckoutInterval(),t._onPurchaseError(e,!0)})},this._settings.checkoutInterval)},n.prototype._onPurchaseError=function(t,n){var r=this;if(this._settings.errorDialog){var i=new e.MessageDialog(this._api,this._settings.errorDialog),s=this._currentPaymentData;s||(s={}),s.error=t,s.params={supportURL:n?this._api.sdkSettings.paymentManager.supportURL:this._settings.supportURL},i.create(s),i.show().always(function(){i.hide(),i.suspend(),r._purchaseDeferred.reject(t)})}else this._purchaseDeferred.reject(t)},n.prototype._clearCheckoutInterval=function(){this._checkoutInterval&&(clearInterval(this._checkoutInterval),this._checkoutInterval=null)},n.prototype.startPayment=function(t){var n=this;return this._purchaseDeferred=new e.Deferred(this._api),this._showLoading(),this._initProvider().done(function(){var r={projectId:t.projectId,product:t.productId,userId:n._userId,locale:n._api.getLanguage(),qr:!0};t.currency&&(r.currency=t.currency),n._requestServer("/buy",r,n._settings.requestPaymentTimeout,function(r){n._hideLoading(),n._sessionId=r.sessionId,n._api.console.log("session: "+n._sessionId+", userid: "+n._userId),n._currentPaymentData=r;for(var i=0;i<n._productsInfo.length;i++){var s=n._productsInfo[i].owner;if(s.productId==t.productId){n._currentPaymentData.product=n._productsInfo[i];break}}n.checkoutDialog=new e.MessageDialog(n._api,n._settings.checkoutDialog),n.checkoutDialog.create(n._currentPaymentData),n._startCheckoutInterval(),n.checkoutDialog.show().always(function(){n.checkoutDialog.hide(),n.checkoutDialog.suspend(),n.checkoutDialog=null,n._clearCheckoutInterval(),n._purchaseDeferred.resolve(!1)})},function(e){n._hideLoading(),n._onPurchaseError(e,!1)})}).fail(function(e,t){n._hideLoading(),n._onPurchaseError(e,t)}),this._purchaseDeferred},n.prototype.getProductsPaymentInfo=function(t){var n=this,r=new e.Deferred(this._api);return this._initProvider().done(function(){var e=function(e){if(!e)return"";var t=n._api.getLanguage();return e[t]?e[t]:e.en?e.en:e},i=function(t){var r=[];for(var i=0;i<t.length;i++){var s=t[i];r.push({productId:s.productId,price:s.periodValue&&s.period?n._api.getPaymentManager().localizePrice(s.price,s.period,s.periodValue):s.price,currency:s.currency,name:e(s.name),desc:e(s.desc),values:s.values,isSubscription:!!s.periodValue&&!!s.period})}return r};t?r.resolve(i(n._productsInfo.filter(function(e){for(var n=0;n<t.length;n++)if(t[n].name==e.productId)return!0;return!1}))):r.resolve(i(n._productsInfo))}).fail(function(e){r.reject(e)}),r},n.prototype._convertCancelationDateToTimestamp=function(e){return(new Date(e)).getTime()},n.prototype._convertCancelationDate=function(t){var n=e.Language.formatDate(t,this._api.getLanguage());return n},n.prototype.getStatus=function(n){var r=this,i=new e.Deferred(this._api);return this._initProvider().done(function(){r._requestServer("/status",{products:n.map(function(e){return{projectId:e.projectId,product:e.productId}}),userId:r._userId},r._settings.requestProductsTimeout,function(e){var s=[];for(var o=0;o<e.length;o++){var u="";for(var a=0;a<n.length;a++)if(n[a].productId==e[o].product&&n[a].projectId==e[o].projectId){u=n[a].name;break}if(u){var f={name:u,status:t.ProductStatus.Unknown,cancelationDate:null,cancelationTimestamp:null};e[o].isPurchased&&!e[o].isCancelation&&(f.status=t.ProductStatus.Purchased),e[o].isPurchased&&e[o].isCancelation&&(f.status=t.ProductStatus.Cancellation,f.cancelationDate=r._convertCancelationDate(e[o].cancelationDate),f.cancelationTimestamp=r._convertCancelationDateToTimestamp(e[o].cancelationDate)),s.push(f)}}i.resolve(s)},function(e){i.reject(e)})}).fail(function(e){i.reject(e)}),i},n.prototype.restoreSubscription=function(t){return new e.Deferred(this._api,!0)},n.prototype.isRestoreSubscriptionSupported=function(){return!1},n.prototype.isUnsubscribeSupported=function(){return!0},n.prototype.unsubscribe=function(n){var r=this;return this._purchaseDeferred=new e.Deferred(this._api),this._showLoading(),this._initProvider().done(function(){r._requestServer("/unsubscribe",{projectId:n.projectId,product:n.productId,userId:r._userId},r._settings.requestPaymentTimeout,function(i){r._hideLoading(),r._currentPaymentData={};for(var s=0;s<r._productsInfo.length;s++){var o=r._productsInfo[s].owner;if(o.productId==n.productId){r._currentPaymentData.product=r._productsInfo[s];break}}r._currentPaymentData.product.status=t.ProductStatus.Cancellation,r._currentPaymentData.product.cancelationDate=r._convertCancelationDate(i.cancelationDate),r._currentPaymentData.product.cancelationTimestamp=r._convertCancelationDateToTimestamp(i.cancelationDate),r.unsubscribeDialog=new e.MessageDialog(r._api,r._settings.unsubscribeDialog),r.unsubscribeDialog.create(r._currentPaymentData),r.unsubscribeDialog.show().always(function(){r.unsubscribeDialog.hide(),r.unsubscribeDialog.suspend(),r.unsubscribeDialog=null,r._purchaseDeferred.resolve(!0,r._productsInfo[s])})},function(e){r._hideLoading(),r._onPurchaseError(e,!1)})}).fail(function(e,t){r._hideLoading(),r._onPurchaseError(e,t)}),this._purchaseDeferred},n.prototype.getSubscriptionEndDate=function(){return 0},n.prototype.getProductID=function(e){return e.productId},n.DEFAULT_REQUEST_PRODUCTS_TIMEOUT=4e4,n.DEFAULT_REQUEST_PAYMENT_TIMEOUT=4e4,n.DEFAULT_APPLY_PAYMENT_TIMEOUT=4e4,n.DEFAULT_CHECKOUT_INTERVAL=1e4,n.DEFAULT_CHECK_REQUEST_TIMEOUT=3e4,n}();n.Playworks=r})(n=t.Provider||(t.Provider={}))})(t=e.Payment||(e.Payment={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(n){var r=function(){function n(e,t,n){this._api=e,this._settings=t,this._initialized=!1,this._products=n}return n.prototype._addListeners=function(){var e=this;AmazonIapV2.addListener("purchaseResponse",function(t){e._onPurchaseResponse(t)}),AmazonIapV2.addListener("getPurchaseUpdatesResponse",function(t){e._onPurchaseUpdatesResponse(t)}),AmazonIapV2.addListener("getUserDataResponse",function(t){e._onUserDataResponse(t)}),AmazonIapV2.addListener("getProductDataResponse",function(t){e._api.console.log("getProductDataResponse: "+JSON.stringify(t))})},n.prototype._requestProductsInfo=function(){this._productsInfo=this._products.map(function(e){var n=[];if(e.desc){var r=e.desc.replace(/[,.]/g,"").match(/^\d+|\d+\b|\d+(?=\w)/g);if(r)for(var i=0;i<r.length;i++){var s=parseInt(r[i]);isNaN(s)&&(s=0),n.push(s)}}var o={productId:e.name,status:t.ProductStatus.Unknown,price:e.price,currency:e.currency?e.currency:"USD",name:e.title,desc:e.desc,values:n,adsFree:e.adsFree,isSubscription:e.isSubscription,owner:e};return o})},n.prototype._initializeDebug=function(){var t=new e.Deferred(this._api);return this._settings.amznApiTesterEnabled?this._api.loadScript(this._settings.amznApiTesterScript,3e4).done(function(){amzn_wa.enableApiTester(amzn_wa_tester),t.resolve()}).fail(function(){t.reject("Fail to load Amazon Api tester")}):t.resolve(),t},n.prototype._initProvider=function(){var t=this,n=new e.Deferred(this._api);return this._initialized?n.resolve():typeof AmazonIapV2=="undefined"?n.reject("AmazonIapV2 is not defined"):this._initializeDebug().done(function(){t._addListeners(),t._requestProductsInfo(),t._initialized=!0,n.resolve()}).fail(function(e){n.reject(e)}),n},n.prototype._applyReceipt=function(e,t){var n=this,r=e.sku,i=null;for(var s=0;s<this._products.length;s++)if(this._products[s].productId==r){i=this._products[s];break}AmazonIapV2.notifyFulfillment(function(e){t(i)},function(e){n._api.console.log("Error fulfillment: "+e),t(null)},[{receiptId:e.receiptId,fulfillmentResult:"FULFILLED"}])},n.prototype._onUserDataResponse=function(e){if(!this._userUIDDeferred)return;!e||!e.response||!e.response.amazonUserData||!e.response.amazonUserData.userId||e.response.status!=="SUCCESSFUL"?this._userUIDDeferred.reject("Can't retrieve user id"):(this._api.console.log("response.userId: "+e.response.amazonUserData.userId),this._userUIDDeferred.resolve(e.response.amazonUserData.userId))},n.prototype._onPurchaseUpdatesResponse=function(e){var t=this,n=e.response,r=n.receipts.length;if(n.receipts.length>0)for(var i=0;i<n.receipts.length;i++)this._applyReceipt(n.receipts[i],function(e){e&&(t._appliedProductsIds.push(e.name),r--,r==0&&t._applyDeferred.resolve(t._appliedProductsIds))});else this._applyDeferred.resolve(this._appliedProductsIds)},n.prototype._onPurchaseResponse=function(e){var t=this,n=e.response||{};this._api.console.log("onPurchaseResponse: "+n.status),n.status==="SUCCESSFUL"?AmazonIapV2.notifyFulfillment(function(e){t._purchaseDeferred.resolve(!0,[t._currentPaymentProductSettings.productId]),console.debug(e)},function(e){t._purchaseDeferred.reject(e)},[{receiptId:n.purchaseReceipt.receiptId,fulfillmentResult:"FULFILLED"}]):n.status==="ALREADY_PURCHASED"?this._purchaseDeferred.resolve(!1):n.status==="FAILED"?this._purchaseDeferred.resolve(!1):n.status==="INVALID_SKU"&&this._purchaseDeferred.reject("Invalid SKU")},n.prototype.getUserUID=function(){var t=this;return this._userUIDDeferred=new e.Deferred(this._api),this._initProvider().done(function(){AmazonIapV2.getUserData()}).fail(function(e){t._userUIDDeferred.reject(e)}),this._userUIDDeferred},n.prototype.applyPurchases=function(t){var n=this;return this._appliedProductsIds=[],this._applyDeferred=new e.Deferred(this._api),this._initProvider().done(function(){AmazonIapV2.getPurchaseUpdates(function(e){},function(e){n._api.console.log("getPurchaseUpdates FAIL callback: "+e),n._applyDeferred.resolve([])},[{reset:!0}])}).fail(function(e){n._applyDeferred.reject(e)}),this._applyDeferred},n.prototype.startPayment=function(t){var n=this;return this._purchaseDeferred=new e.Deferred(this._api),this._currentPaymentProductSettings=t,this._initProvider().done(function(){AmazonIapV2.purchase(function(e){},function(e){n._purchaseDeferred.reject("errorResponse")},[{sku:t.productId}])}).fail(function(e){n._purchaseDeferred.reject(e)}),this._purchaseDeferred},n.prototype.getProductsPaymentInfo=function(t){var n=this,r=new e.Deferred(this._api);return this._initProvider().done(function(){t?r.resolve(n._productsInfo.filter(function(e){for(var n=0;n<t.length;n++)if(t[n].name==e.productId)return!0;return!1})):r.resolve(n._productsInfo)}).fail(function(e){r.reject(e)}),r},n.prototype.getStatus=function(n){var r=[];if(n)for(var i=0;i<n.length;i++){var s=n[i];r.push({name:s.name,status:t.ProductStatus.Unknown})}return new e.Deferred(this._api,r)},n.prototype.restoreSubscription=function(t){return new e.Deferred(this._api,!0)},n.prototype.isRestoreSubscriptionSupported=function(){return!1},n.prototype.isUnsubscribeSupported=function(){return!1},n.prototype.unsubscribe=function(t){return new e.Deferred(this._api,!0)},n.prototype.getSubscriptionEndDate=function(){return 0},n.prototype.getProductID=function(e){return e.productId},n}();n.FireTV=r})(n=t.Provider||(t.Provider={}))})(t=e.Payment||(e.Payment={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n,r,i,s,o=function(){function e(e){this.date=new Date(e)}return e}();t.SubscriptionCancellationInfo=o,n=function(){function e(){}return e.Unknown="unknown",e.Free="free",e.Demo="demo",e.AdBased="adbased",e.Purchased="purchased",e.Cancellation="cancellation",e.Locked="locked",e.Retrieving="retrieving",e}(),t.ProductStatus=n,r=function(){function e(){}return e.Canceled="canceled",e.Exit="exit",e.Purchased="purchased",e.No="no",e.Ok="ok",e.PaymentCanceled="payment-canceled",e}(),t.ScreenResult=r,function(e){e.StartDemo="startdemo",e.EndDemo="enddemo",e.PreRollDemo="prerolldemo",e.PreRollFree="prerollfree",e.PostRollDemo="postrolldemo",e.PostRollFree="postrollfree",e.NotAvailable="notavailable",e.Locked="locked"}(i=t.ScreenNames||(t.ScreenNames={})),s=function(){function i(t){this._api=t,this._providers={},this._settings=t.sdkSettings.paymentManager,this._settings||(this._settings={enabled:!1}),e.Api.locationGetParam("iap")==="0"&&(this._settings.enabled=!1),this._backDiv=null,this._statusReported=!1,this._subscriptionCancellationInfo=null}return i.prototype.init=function(r){var i=this;this._productSettings=r,this._productSettings.payment||(this._productSettings.payment={enabled:!1}),this._productSettings.payment.enabled===!1&&(this._settings.enabled=!1),this._isNeedSynchronize=!1,this._api.getStorage().isEnabled()||(this._settings.enabled=!1);if(!this.isEnabled())this._productSettings.payment.status=n.Unknown;else{this._productPaymentSettings=this._productSettings.payment,this._providerName=this._getProviderName(this._productPaymentSettings),this._providerSettings=this._settings.providers[this._providerName];if(this._productPaymentSettings.providers)for(var s=0;s<this._productPaymentSettings.providers.length;s++)if(this._productPaymentSettings.providers[s].name===this._providerName){this._productProviderSettings=this._productPaymentSettings.providers[s];break}this._products=this._getProducts();if(this._products.length<=0){this._productSettings.payment.enabled=!1,this._settings.enabled=!1;return}this._isNeedSynchronize=!0,this._getProductsStatus(this._products).done(function(t){for(var r=0;r<t.length;r++)for(var s=0;s<i._products.length;s++)if(i._products[s].name==t[r].name){i._products[s].status=t[r].status,i._products[s].cancelationDate=t[r].cancelationDate,i._products[s].cancelationTimestamp=t[r].cancelationTimestamp;break}for(var r=0;r<i._products.length;r++)if(i._products[r].adsFree&&(i._products[r].status==n.Purchased||i._products[r].status==n.Cancellation)){i._api.getAdsManager().disablePerType([e.Ads.Type.PreRoll,e.Ads.Type.MidRoll,e.Ads.Type.PostRoll]),i._api.getAdsManager().startPreloadForRewarded();break}i._isNeedSynchronize=!1}).fail(function(){i._isNeedSynchronize=!1;for(var e=0;e<i._products.length;e++)i._products[e].status=t.ProductStatus.Purchased})}},i.prototype.isSamePaymentProductId=function(e,t){if(!this.isEnabled())return!1;var n=this._api.sdkSettings.products[e],r=this._api.sdkSettings.products[t],i=this._productSettings.payment;if(!i||!n||!r||!n.payment||!r.payment||n.payment.enabled===!1||r.payment.enabled===!1)return!1;var s=this._createProvider();return s.getProductID(n.payment)===s.getProductID(r.payment)?!0:!1},i.prototype.needSynchronize=function(){return this.isEnabled()?this._isNeedSynchronize:!1},i.prototype.disable=function(){this._settings.enabled=!1},i.prototype.isEnabled=function(){return this._settings.enabled},i.prototype._filteredProducts=function(e){return this._products.filter(function(t){return e.indexOf(t.name)>=0})},i.prototype.getProductsPaymentInfo=function(t){var n=this;if(!this.isEnabled())return new e.Deferred(this._api,[]);var r=new e.Deferred(this._api);return this._createProvider().getProductsPaymentInfo(this._filteredProducts(t)).done(function(e){for(var t=0;t<e.length;t++)for(var i=0;i<n._products.length;i++)n._products[i].name==e[t].productId&&(e[t].status=n._products[i].status,e[t].cancelationDate=n._products[i].cancelationDate,e[t].cancelationTimestamp=n._products[i].cancelationTimestamp);r.resolve(e)}).fail(function(e){r.reject(e)}),r},i.prototype.localizePrice=function(e,t,n){var r=e;if(n&&t){var i=t,s="/";n>1&&(i+="s",s+=n+" ");var o=this._api.getLanguage();this._settings.localization&&this._settings.localization[i]?this._settings.localization[i][o]?s+=this._settings.localization[i][o]:s+=this._settings.localization[i].en:s+=i,r+=s}return r},i.prototype.isAllowedSubscribeFromAds=function(){return this.isEnabled()?!!this._settings.subscribeFromAds:!1},i.prototype.isPayingUser=function(){var t=new e.Deferred(this._api);if(!this.isEnabled())return t.resolve(!1),t;for(var r=0;r<this._products.length;r++)this._products[r].status==n.Purchased&&t.resolve(!0);return t.resolve(!1),t},i.prototype.isAdsAllowed=function(){var t=new e.Deferred(this._api);return this.isEnabled()?t.resolve(!0):t.resolve(!0),t},i.prototype._getProviderName=function(e){return e.providerName?e.providerName:this._settings.providers.defaultProvider},i.prototype._getValidProviderName=function(e){return e||(e=this._settings.providers.defaultProvider),e},i.prototype._createProvider=function(){var t=this._providerSettings;return t?(this._backDiv&&(t.containerId=this._backDiv.id),this._providers[t.className]||(this._providers[t.className]=new e.Payment.Provider[t.className](this._api,t,this._products)),this._providers[t.className]):null},i.prototype._updateProductStatus=function(e){this._productSettings.payment.status=e},i.prototype.getCachedProductStatusAsString=function(){return this.isEnabled()?this._productSettings&&this._productSettings.payment?""+this._productSettings.payment.status:null:null},i.prototype.isRestoreSubscriptionSupported=function(){return this.isEnabled()?this._createProvider().isRestoreSubscriptionSupported():!1},i.prototype.isUnsubscribeSupported=function(){return this.isEnabled()?this._createProvider().isUnsubscribeSupported():!1},i.prototype.restoreSubscription=function(){return new e.Deferred(this._api,!0)},i.prototype.unsubscribe=function(t){var r=this,i=new e.Deferred(this._api);this._api.disableInput(),this._createBackground();var s=this._filteredProducts([t])[0],o=this._createProvider();return o.unsubscribe(s).done(function(t,o){r._api.enableInput(),r._removeBackground(),t===!0?(r._api.reportPaymentEvent(e.Reporting.Payment.Unsubscribe),s.status=n.Cancellation,o&&(s.cancelationDate=o.cancelationDate,s.cancelationTimestamp=o.cancelationTimestamp),i.resolve(!0)):i.resolve(!1)}).fail(function(){r._api.enableInput(),r._removeBackground(),i.resolve(!1)}),i},i.prototype.getSubscriptionCancellationInfo=function(){return this._subscriptionCancellationInfo},i.prototype._getProducts=function(){var e=[];return this._providerSettings.products&&(e=this._providerSettings.products),this._productProviderSettings&&this._productProviderSettings.products&&(e=e.concat(this._productProviderSettings.products)),e},i.prototype._getProductsStatus=function(t){var r=this,i=new e.Deferred(this._api);if(!this.isEnabled()){var s=[];for(var o=0;o<t.length;o++)s.push({name:t[o].name,status:n.Unknown});return i.resolve(s),i}return this._createProvider().getStatus(t).done(function(e){i.resolve(e)}).fail(function(t){r._api.reportErrorEvent(e.Reporting.Errors.paymentError,"getProductStatus error: p:"+r._getValidProviderName(r._providerName)+" e:"+JSON.stringify(t)),i.reject(t)}),i},i.prototype._createBackground=function(){this._backDiv=this._api.createDiv("payment-back",!0),this._backDiv.id="payment-container"+Math.random()},i.prototype._removeBackground=function(){this._backDiv&&this._backDiv.parentNode&&(this._backDiv.parentNode.removeChild(this._backDiv),this._backDiv=null)},i.prototype.getUserUID=function(){return this.isEnabled()?this._createProvider().getUserUID():this._api.getSystem().getCustomerUID()},i.prototype.applyPurchases=function(t){return this.isEnabled()?this._createProvider().applyPurchases(this._filteredProducts(t)):new e.Deferred(this._api,[])},i.prototype.startPayment=function(t,r){var i=this;this._api.console.log("startPayment: productId: "+r);if(!this.isEnabled())return new e.Deferred(this._api,!1);var s=new e.Deferred(this._api),o=this._filteredProducts([r])[0];return this._api.reportPaymentEvent(e.Reporting.Payment.BuyOption,r),this._api.disableInput(),this._createBackground(),this._createProvider().startPayment(o).done(function(u,a){if(u===!0){o.status=n.Purchased;var f=0;if(a&&a.price){var l=a.price.match(/[+-]?\d+(\.\d+)?/g).map(function(e){return parseFloat(e)});l&&l.length>0?f=l[0]*100:f=0,isNaN(f)&&(f=0)}i._api.reportPaymentEvent(e.Reporting.Payment.Success,r,f,a,t)}else i._api.reportPaymentEvent(e.Reporting.Payment.Cancel,r);i._api.enableInput(),i._removeBackground(),u===!0?(o.adsFree&&(i._api.getAdsManager().disablePerType([e.Ads.Type.PreRoll,e.Ads.Type.MidRoll,e.Ads.Type.PostRoll]),i._api.getAdsManager().startPreloadForRewarded()),s.resolve(!0,a)):s.resolve(!1)}).fail(function(t){i._api.reportPaymentEvent(e.Reporting.Payment.Failed,r),i._api.reportErrorEvent(e.Reporting.Errors.paymentError,"startPayment error: provider:"+i._providerName+" error:"+t),i._api.enableInput(),i._removeBackground(),s.reject(t)}),s},i.prototype._selectSubscriptionScreen=function(e,t){if(!t.payment)return null;var n=null;return t.payment.screens&&t.payment.screens[e]&&(n=t.payment.screens[e]),!n&&this._settings.screens&&this._settings.screens[e]&&(n=this._settings.screens[e]),n},i.prototype.requestScreen=function(t,n,i){var s=this,o=this._selectSubscriptionScreen(t,i);if(!this.isEnabled()||!o||o.enabled===!1||!o.url&&!o.dialog)return new e.Deferred(this._api,r.No);var u=new e.Deferred(this._api);if(o.url){var a=new e.IFrame.Screen(this._api,{src:o.url,className:"payment-iframe"});a.onMessage=function(n,o){n==e.IFrame.Messages.paymentStart&&(a.pause(),s.startPayment(t+"_"+i.productId).done(function(e){e?a.suspend(!0,r.Purchased):a.suspend(!0,r.PaymentCanceled)}).fail(function(e){a.suspend(!0,r.No)}))},a.show(document.body,{language:this._api.getLanguage(),productTitle:i.title}).always(function(n){n==r.No&&s._api.reportPaymentEvent(e.Reporting.Payment.NoThanksOption,t+"_"+i.productId),u.resolve(n)})}else if(o.dialog){var f;f=new e.MessageDialog(this._api,o.dialog),f.create(),f.show().always(function(){f.hide(),f.suspend(),u.resolve(r.Ok)})}return u},i}(),t.PaymentManager=s})(t=e.Payment||(e.Payment={}))}(TGH5||(TGH5={})),function(e){var t=function(){function t(e){this._api=e,this._dotElements=[],this._updateInterval=null,this._isVisible=!1}return t.prototype.show=function(){this._isVisible=!0,this._updateTime=0,this._root.style.display="block"},t.prototype.hide=function(){this._isVisible=!1,this._root.style.display="none"},t.prototype.isVisible=function(){return this._isVisible},t.prototype.create=function(n){var r=this;this._root=document.createElement("div"),this._root.className="tgh5-lpb-shield",this._owner=n,this._owner.appendChild(this._root);var i=(e.System.SCREEN_WIDTH-t._numDots*t._deltaX)/2,s=(e.System.SCREEN_HEIGHT-t._dotWidth)/2;this._startY=s;for(var o=0;o<t._numDots;o++){var u=document.createElement("div");u.className="tgh5-lbp-dot",u.style.width=t._dotWidth+"px",u.style.height=t._dotWidth+"px",u.style.backgroundColor=t._startColor,u.style.left=i+"px",u.style.top=s+"px",u.style.borderRadius=2+t._dotWidth/2+"px",u.style.border="2px solid black",i+=t._deltaX,this._dotElements.push(u),this._root.appendChild(u)}this._updateTime=0,this._updateAnimation(),this._updateInterval=setInterval(function(){r._updateTime+=t._updateInterval,r._updateAnimation()},t._updateInterval)},t.prototype._updateAnimation=function(){var e=this._updateTime%t._loopDuration/t._loopDuration;for(var n=0;n<t._numDots;n++){var r=Math.sin(e*6.28+n*3.14/t._numDots);r<0&&(r=0);var i=this._dotElements[t._numDots-n-1];i.style.top=this._startY-r*t._dotWidth/2+"px",i.style.opacity=t._startOpacity+r*(t._endOpacity-t._startOpacity)+""}},t.prototype.suspend=function(){this._updateInterval&&(clearInterval(this._updateInterval),this._updateInterval=0),this._owner&&(this._owner.removeChild(this._root),this._root=null,this._dotElements=null),this._owner=null},t._numDots=4,t._dotWidth=25,t._deltaX=34,t._loopDuration=2e3,t._startColor="rgb(255,255,255)",t._startOpacity=.9,t._endOpacity=.3,t._updateInterval=50,t}();e.LoadingProgressBar=t}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function n(e,t){this._api=e,this._initialized=!1,this._context=null,this._options=t,this._format=this._api.supportedMedia(null,"audioContext",t.extensions),this._buffers={},this._playingSoundsArray=[],this._request=null,this._timeoutId=null,this._uniqueId=0,this._queue=[]}return n.prototype.isSupported=function(){return!this._format,!this._getAudioContextClass(),this._format&&this._getAudioContextClass()},n.prototype.initialize=function(){if(this._initialized)return;var e=this._getAudioContextClass();this._context=new e,this._onSoundLoaded(null)},n.prototype.isInitialized=function(){return this._initialized},n.prototype.cleanup=function(e){this.stop(),e()},n.prototype.play=function(e,n,r){var i=this;if(!this.isInitialized())return r&&r(!1),!1;var s=this._buffers[e];if(!!s&&typeof s.length=="number"&&s.length>0&&typeof s.duration=="number"&&s.duration>0){var o=0;typeof n!="number"&&(n=t.PlayMode.DEFAULT);switch(n){case t.PlayMode.MIX:case t.PlayMode.MIX_OR_SKIP:case t.PlayMode.MIX_OR_SINGLE:case t.PlayMode.MIX_OR_QUEUE:break;case t.PlayMode.SKIP:if(this.isPlaying()){r&&r(!1);return}break;case t.PlayMode.SINGLE:this.isPlaying()&&(this.stop(),o=1);break;case t.PlayMode.QUEUE:if(this.isPlaying()){this._queue.push({trackName:e,callback:r});return}}var u=this._context.createBufferSource();u.buffer=s,u.connect(this._context.destination);var a={source:u,uid:this._getSoundUID(),timeoutId:window.setTimeout(function(){i._soundEnded(a)},(u.buffer.duration+1)*1e3|0)};return this._playingSoundsArray.push(a),u.onended=function(){i._soundEnded(a)},u.start(0),r&&r(!0),!0}return r&&r(!1),!1},n.prototype.isPlaying=function(){return this._playingSoundsArray.length>0},n.prototype.stop=function(e){var t=0;while(t<this._playingSoundsArray.length)this._playingSoundsArray[t].source.disconnect(),++t;this._queue.length=0,e&&e()},n.prototype._getSoundUID=function(){return this._playingSoundsArray.length===0&&(this._uniqueId=0),++this._uniqueId},n.prototype._soundEnded=function(e){var n=0;while(n<this._playingSoundsArray.length){var r=this._playingSoundsArray[n];if(e.uid===r.uid){r.timeoutId!==null&&(clearTimeout(r.timeoutId),r.timeoutId=null,r.source.onended=null,r.source=null),this._playingSoundsArray.splice(n,1);break}++n}if(this._queue.length>0&&this._playingSoundsArray.length===0){var i=this._queue.shift();this.play(i.trackName,t.PlayMode.QUEUE),i.callback&&i.callback(!0)}},n.prototype._getAudioContextClass=function(){var e;try{e=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.oAudioContext||window.msAudioContext,e||(e=null)}catch(t){e=null}return e},n.prototype._loadSound=function(t){var r=this,i=this._options.folderUrl+"/"+t+this._format.ext;this._request=new XMLHttpRequest,this._request.open("GET",i,!0),this._request.responseType="arraybuffer",this._request.onreadystatechange=function(){r._request.readyState===4&&(r._request.status===200?r._context.decodeAudioData(r._request.response,function(n){n?(r._buffers[t]=n,r._onSoundLoaded(t)):(r._api.reportErrorEvent(e.Reporting.Errors.soundError,"decodeAudioData("+i+"): buffer is empty"),r._onSoundLoaded(t))},function(n){r._api.reportErrorEvent(e.Reporting.Errors.soundError,"decodeAudioData("+i+"): decode error"+n),r._onSoundLoaded(t)}):(r._api.reportErrorEvent(e.Reporting.Errors.soundError,"XHR("+i+"): status="+r._request.status),r._onSoundLoaded(t)))},this._timeoutId=setTimeout(function(){r._request&&r._request.readyState!==4&&(r._request.abort(),r._onSoundLoaded(t))},n._LOAD_TIMEOUT),this._request.send()},n.prototype._onSoundLoaded=function(e){var t=!1;this._timeoutId!==null&&(clearTimeout(this._timeoutId),this._timeoutId=null),e&&!this._request,this._request!==null&&(this._request.onload=this._request.onerror=null,this._request=null,this._buffers[e]||(t=!0));if(!t){var n=!0;for(e in this._options.tracks)if(this._options.tracks.hasOwnProperty(e)&&!this._buffers[e]){n=!1,this._loadSound(e);break}n&&(this._initialized=!0)}},n._LOAD_TIMEOUT=15e3,n}();t.AudioContextEngine=n})(t=e.Sound||(e.Sound={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t,n;(function(e){e[e.ACTION=0]="ACTION",e[e.ACTION_AFTER_CONDITION=1]="ACTION_AFTER_CONDITION",e[e.ACTION_AFTER_DELAY=2]="ACTION_AFTER_DELAY",e[e.ACTION_AFTER_EVENT=3]="ACTION_AFTER_EVENT"})(t||(t={})),n=function(){function e(e,t){this._defaultTimeOut=t,this._thisArg=e,this._timeOutId=null,this._errorTimeOutId=null,this._defaultInterval=50,this.clear()}return e.prototype.clear=function(){this._timeOutId!==null&&(clearTimeout(this._timeOutId),this._timeOutId=null),this._errorTimeOutId!==null&&(clearTimeout(this._errorTimeOutId),this._errorTimeOutId=null),this._queue=[],this._task=null},e.prototype.run=function(){return this._processNextTasks()},e.prototype.actionAfterEvent=function(e,n,r,i){return this._queue.push({type:t.ACTION_AFTER_EVENT,events:[e],callBack:n,conditionCallBack:null,timeOut:r,defaultTimeOut:i}),this},e.prototype.actionAfterDelay=function(e,n){return this._queue.push({type:t.ACTION_AFTER_DELAY,events:[],callBack:n,conditionCallBack:null,timeOut:e}),this},e.prototype.action=function(e){return this._queue.push({type:t.ACTION,events:[],callBack:e,conditionCallBack:null,timeOut:0}),this},e.prototype.actionAfterCondition=function(e,n){return this._queue.push({type:t.ACTION_AFTER_CONDITION,events:[],callBack:n,conditionCallBack:e,timeOut:0}),this},e.prototype.dispatchEvent=function(e){this._task&&this._task.type===t.ACTION_AFTER_EVENT&&this._task.events.indexOf(e)>=0&&this._onTaskComplete(!1,!1,e)},e.prototype._processNextTasks=function(){while(this._task===null&&this._queue.length>0)this._nextItemTask(this._queue.shift());return this._task!==null},e.prototype._nextItemTask=function(e){function i(){var e=this;this._task.conditionCallBack.call(this._thisArg)?this._onTaskComplete(!1,!1):this._timeOutId=setTimeout(function(){i.call(e)},this._defaultInterval)}var n=this,r=typeof e.timeOut=="number"&&e.timeOut>0;if(e.type===t.ACTION)e.callBack&&e.callBack.call(this._thisArg);else if(e.type===t.ACTION_AFTER_CONDITION)this._task=e,this._timeOutId=setTimeout(function(){i.call(n)},this._defaultInterval);else{this._task=e,r&&(this._timeOutId=setTimeout(function(){n._onTaskComplete(!1,!0)},e.timeOut));var s=this._defaultTimeOut;typeof e.defaultTimeOut=="number"&&(s=e.defaultTimeOut),typeof s=="number"&&s>0&&(!r||s>this._task.timeOut)&&(this._errorTimeOutId=setTimeout(function(){n._onTaskComplete(!0,!1)},s))}},e.prototype._onTaskComplete=function(e,t,n){this._timeOutId!==null&&(clearTimeout(this._timeOutId),this._timeOutId=null),this._errorTimeOutId!==null&&(clearTimeout(this._errorTimeOutId),this._errorTimeOutId=null);if(this._task){var r=this._task;return this._task=null,r.callBack&&r.callBack.call(this._thisArg,e,t,n),this._processNextTasks(),!0}return!1},e}(),e.AudioEventQueue=n})(t=e.Sound||(e.Sound={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t,n;(function(e){e[e.NONE=0]="NONE",e[e.PREPARING_TO_PAUSE=1]="PREPARING_TO_PAUSE",e[e.READY_TO_PLAY=2]="READY_TO_PLAY",e[e.PREPARING_TO_PLAY=3]="PREPARING_TO_PLAY",e[e.PLAYING=4]="PLAYING",e[e.SEEKING=5]="SEEKING"})(t||(t={})),n=function(){function n(n,r){this._api=n,this._options=r,this._initialized=!1,this._intervalId=null,this._audioQueue=[],this._pauseTime=-1,this._element=null,this._state=t.NONE,this._isMP3=!1;var i=e.createAudioElement();this._api.console.debug("createAudioElement"),i?(this._format=this._api.supportedMedia(i,"audio",this._options.extensions),this._format&&(this._isMP3=/.mp3$/i.test(this._format.ext))):this._format=null,this._platformConfig=this._api.sdkSettings.audioManager.settings}return n.prototype.isSupported=function(){return!!this._format&&!!this._platformConfig&&typeof this._options.spriteTrackId=="string"&&this._options.spriteTrackId.length>0},n.prototype.initialize=function(){var r=this;if(this._initialized)return;this._taskQueue=new e.AudioEventQueue(this,n._DEFAULT_TIMEOUT),this._intervalId=window.setInterval(function(){r._state===t.PLAYING&&r._pauseTime!==-1&&Date.now()>=r._pauseTime&&(r._audioQueue.length>0?r.stop(function(){var t=r._audioQueue.shift();r.play(t.trackName,e.PlayMode.QUEUE,t.callback)}):r.stop())},50);var i=this._taskQueue;i.clear(),i.action(function(){r._pauseTime=-1,r._audioQueue=[]}),i.action(function(){r._state=t.NONE,r._api.console.debug("createAudioElement"),r._element=e.createAudioElement(),r._addListeners(),r._element.src=r._options.folderUrl+"/"+r._options.spriteTrackId+r._format.ext,r._platformConfig.loadBeforePlay&&r._element.load()}),i.actionAfterEvent("canplaythrough",function(){r._element.play()}),this._platformConfig.firstPauseAfterSecondOfPlaying?(i.actionAfterEvent("playing"),i.actionAfterDelay(1e3,function(){r._element.pause()})):i.actionAfterEvent("playing",function(){r._element.pause()}),i.actionAfterEvent("pause",function(){r._state=t.READY_TO_PLAY,r._initialized=!0}),i.run()},n.prototype.isInitialized=function(){return!!this._format&&this._initialized},n.prototype.play=function(t,n,r){if(!this.isInitialized()||!this._options.tracks[t])return r&&r(!1),!1;typeof n!="number"&&(n=0);switch(n!==0?n:e.PlayMode.DEFAULT){case e.PlayMode.SINGLE:this._audioQueue=[];break;case e.PlayMode.SKIP:if(this.isPlaying())return!1;break;case e.PlayMode.QUEUE:if(this.isPlaying())return this._addToQueue(t,r),!0}return this._playAudioInfo(t,r)},n.prototype.stop=function(e){var n=this;if(!this.isInitialized()||this._state!==t.PREPARING_TO_PLAY&&this._state!==t.PLAYING)e&&e();else{var r=this._taskQueue;r.clear(),r.action(function(){n._state=t.PREPARING_TO_PAUSE,n._pauseTime=-1,n._element.pause()}),r.actionAfterEvent("pause",function(){n._state=t.READY_TO_PLAY,e&&e()}),r.run()}},n.prototype.isPlaying=function(){return this.isInitialized()?this._state!==t.READY_TO_PLAY&&this._state!==t.NONE:!1},n.prototype.handleEvent=function(e){this._taskQueue.dispatchEvent(e.type)},n.prototype._addToQueue=function(e,t){this._audioQueue.push({trackName:e,callback:t})},n.prototype._playAudioInfo=function(e,n){var r=this,i=this._taskQueue,s=this._options.tracks[e];i.clear();if(this._state===t.PLAYING||this._state===t.PREPARING_TO_PAUSE||this._state===t.PREPARING_TO_PLAY)this._state!==t.PREPARING_TO_PAUSE&&i.action(function(){r._state=t.PREPARING_TO_PAUSE,r._pauseTime=-1,r._element.pause()}),i.actionAfterEvent("pause",function(){r._state=t.READY_TO_PLAY});i.action(function(){r._state=t.SEEKING,r._pauseTime=-1,r._element.currentTime=s.start-r._platformConfig.prePlayTime/1e3});var o=this._isMP3?this._platformConfig.seekTimeOutInsteadOfEventIfMP3:this._platformConfig.seekTimeOutInsteadOfEventIfNotMP3;return o=o!==-1?o:undefined,i.actionAfterEvent("seeked",function(){},o),this._isMP3&&this._platformConfig.waitForCanPlayAfterSeekedEventIfMP3?i.actionAfterEvent("canplaythrough",function(){}):!this._isMP3&&this._platformConfig.waitForCanPlayAfterSeekedEventIfNotMP3&&i.actionAfterEvent("canplaythrough",function(){}),i.action(function(){r._state=t.PREPARING_TO_PLAY,r._element.play()}),i.actionAfterEvent("playing",function(){r._pauseTime=Date.now()+(s.end-s.start)*1e3+r._platformConfig.postPlayTime+r._platformConfig.prePlayTime,r._state=t.PLAYING,n&&n(!0)}),i.run(),!0},n.prototype._addListeners=function(){var e=this,t=this;n._HANDLED_AUDIO_EVENT_TYPES.forEach(function(n){e._element.addEventListener(n,t,!0)})},n.prototype.cleanup=function(e){var t=this,r=this;this.stop(function(){t._taskQueue.clear(),t._element!==null&&(n._HANDLED_AUDIO_EVENT_TYPES.forEach(function(e){t._element.removeEventListener(e,r,!0)}),t._element=null),t._intervalId!==null&&(clearInterval(t._intervalId),t._intervalId=null),t._initialized=!1,t._api.processLater(function(){e&&e()})})},n._DEFAULT_TIMEOUT=1e4,n._HANDLED_AUDIO_EVENT_TYPES=["canplaythrough","seeked","pause","playing","ended","error","abort","emptied"],n}(),e.AudioSpriteEngine=n})(t=e.Sound||(e.Sound={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function n(e,t){this._api=e,this._options=t,this._playing=!1,this._platformConfig=null,this._looped=!1,this._format=this._api.supportedMedia(null,"audio",["mp3"]),this._platformConfig=this._api.sdkSettings.audioManager.settings,this._audioQueue=[]}return n.prototype.isSupported=function(){return!!this._format&&!!this._platformConfig},n.prototype.initialize=function(){},n.prototype.isInitialized=function(){return!0},n.prototype.play=function(n,r,i){var s=this;if(!this.isInitialized())return i&&i(!1),!1;typeof r!="number"&&(r=0);switch(r!==0?r:t.PlayMode.DEFAULT){case t.PlayMode.LOOP:this.isPlaying()&&this.stop(),this._looped=!0;break;case t.PlayMode.SINGLE:this._audioQueue=[],this.isPlaying()&&this.stop();break;case t.PlayMode.SKIP:if(this.isPlaying())return!1;break;case t.PlayMode.QUEUE:if(this.isPlaying())return this._audioQueue.push({trackName:n,playMode:r,callback:i}),!0}this._trackName=n,this._playMode=r,this._onStartCallback=i;var o=(location.href+"").split("?")[0],u=o.substring(0,o.lastIndexOf("/"))+"/"+this._options.folderUrl+"/"+n+this._format.ext,a=new e.IFrame.Message(this._api);a.response=function(t,n){t==e.IFrame.Messages.onAudioEnd?s.onEnd():t==e.IFrame.Messages.onAudioError&&(s._api.console.error("AudioError: "+n),s._onStartCallback(!1),s.onEnd())};var f=this._options.tracks[n];return a.request(e.IFrame.Messages.playAudio,{url:u,duration:(f.end-f.start)*1e3}),this.onStart(),!0},n.prototype.isPlaying=function(){return this._playing},n.prototype.stop=function(){if(!this.isInitialized())return;this._looped=!1;var t=new e.IFrame.Message(this._api);t.request(e.IFrame.Messages.stopAudio),this.onEnd()},n.prototype.onStart=function(){this._playing=!0,this._onStartCallback&&this._onStartCallback(!0)},n.prototype.onEnd=function(){this._playing=!1;if(this._looped)this.play(this._trackName,this._playMode,this._onStartCallback);else if(this._audioQueue.length>0){var e=this._audioQueue.shift();this.play(e.trackName,t.PlayMode.QUEUE,e.callback)}},n.prototype.cleanup=function(e){this.stop(),e()},n}();t.AudioSamsungEngine=n})(t=e.Sound||(e.Sound={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t=function(){function t(e,t,n,r){var i=this;this._api=e,this._options=t,this._format=n,this._trackName=r,this._playing=!1,this._platformConfig=this._api.sdkSettings.audioManager.settings,this._createAudioTag(),this._onEndCallback=function(){i.onEnd()}}return t.prototype._createAudioTag=function(){var t="_amte_"+this._trackName;this._audio=document.getElementById(t),this._audio||(this._audio=e.createAudioElement(this._platformConfig.addAudioToDOM),this._audio.loop=!1,this._audio.preload="auto",this._audio.autoplay=!1,this._audio.id=t,this._audio.src=this._api.getResourceManager().resolvePath(this._options.folderUrl+"/"+this._trackName+this._format.ext))},t.prototype.getTrackName=function(){return this._trackName},t.prototype.onEnd=function(){this.stop()},t.prototype.play=function(t,n){typeof t!="number"&&(t=0);switch(t!==0?t:e.PlayMode.DEFAULT){case e.PlayMode.SINGLE:this._playing&&this.stop();break;case e.PlayMode.SKIP:if(this._playing)return!1}this._playing=!0,this._api.bind(this._audio,e.AudioEngine._AUDIO_END_EVENTS,this._onEndCallback),this._audio.play()},t.prototype.stop=function(){this._playing&&(this._api.unbind(this._audio,t._AUDIO_END_EVENTS,this._onEndCallback),this._playing=!1,this._audio.pause())},t.prototype.isPlaying=function(){return this._playing},t.prototype.suspend=function(){this.stop(),this._playing=!1,this._audio&&(e.suspendAudioElement(this._audio),this._audio=null)},t._AUDIO_END_EVENTS=["ended","pause","error","abort"],t}(),n=function(){function n(t,n){this._api=t,this._format=null,this._options=n,this._tracks=[],this._platformConfig=null;var r=e.createAudioElement(!1);r?this._format=this._api.supportedMedia(r,"audio",this._options.extensions):this._format=null,r=null,this._platformConfig=this._api.sdkSettings.audioManager.settings}return n.prototype.isSupported=function(){return!!this._format&&!!this._platformConfig},n.prototype.initialize=function(){},n.prototype.isInitialized=function(){return!0},n.prototype._getTrack=function(e){for(var t=0;t<this._tracks.length;t++)if(this._tracks[t].getTrackName()==e)return this._tracks[t];return null},n.prototype._createTrack=function(e){var n=new t(this._api,this._options,this._format,e);return this._tracks.push(n),n},n.prototype.play=function(e,t,n){if(!this.isInitialized())return n&&n(!1),!1;var r=this._getTrack(e);return r||(r=this._createTrack(e)),r.play(t,n)},n.prototype.isPlaying=function(){for(var e=0;e<this._tracks.length;e++)if(this._tracks[e].isPlaying())return!0;return!1},n.prototype.stop=function(){if(!this.isInitialized())return;for(var e=0;e<this._tracks.length;e++)this._tracks[e].stop()},n.prototype.cleanup=function(e){this.suspend(),e()},n.prototype.suspend=function(){for(var e=0;e<this._tracks.length;e++)this._tracks[e].suspend();this._tracks=[]},n}();e.AudioMultipleEngine=n})(t=e.Sound||(e.Sound={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n,r;(function(e){e[e.NOT_SUPPORTED=0]="NOT_SUPPORTED",e[e.DISABLED=1]="DISABLED",e[e.SWITCHED_ON=2]="SWITCHED_ON",e[e.SWITCHED_OFF=3]="SWITCHED_OFF"})(n=t.AudioControlState||(t.AudioControlState={})),r=function(){function r(n){this._api=n,this._music=null,this._sound=null,this._enabled=!0,this._musicRequested=!1;var r=this._api.productSettings.audio;this._settings=this._api.sdkSettings.audioManager;if(this._settings){if(!this._settings.sound||!r||!r.extensions||!r.folderUrl||!r.tracks)this._settings.sound={enabled:!1};this._settings.music||(this._settings.music={enabled:!1}),this._api.productSettings.musicDisabled&&(this._settings.music.enabled=!1),this._api.productSettings.soundDisabled&&(this._settings.sound.enabled=!1);if(this._settings.sound.enabled){for(var i=0;!this._sound&&i<this._settings.engines.length;i++){var s=this._settings.engines[i];switch(s.toLowerCase()){case"samsungaudio":var o=new t.AudioSamsungEngine(n,r);o.isSupported()&&(this._sound=o,this._api.console.log("Audio: Samsung Player "));break;case"audiocontext":var u=new t.AudioContextEngine(n,r);u.isSupported()&&(this._sound=u,this._api.console.log("Audio: AudioContext, format: "+this._sound._format.ext.toUpperCase()));break;case"audiosprite":if(r.spriteTrackId){var a=new t.AudioSpriteEngine(n,r);a.isSupported()&&(this._sound=a,this._api.console.log("Audio: AudioSprite, format: "+this._sound._format.ext.toUpperCase()),this._settings.music.enabled=!1,this._api.productSettings.musicDisabled=!0)}break;case"audiomultipletag":var f=new t.AudioMultipleEngine(n,r);f.isSupported()&&(this._sound=f,this._api.console.log("Audio: HTML5 Audio Multiple Tags, format: "+this._sound._format.ext.toUpperCase()));break;case"audiotag":var l=new t.AudioEngine(n,r);l.isSupported()&&(this._sound=l,this._api.console.log("Audio: HTML5 Audio Tag, format: "+this._sound._format.ext.toUpperCase()))}}this._sound&&this._sound.initialize(),this._api.productSettings.soundControl&&this._api.sdkSettings.cachedSettings.soundControlState==e.CachedSettings.AUDIO_SWITCHED_OFF&&(this._settings.sound.enabled=!1)}var c=this._getMusicTracks();if(this._settings.music.enabled&&c&&c.length>0){var h=new t.MusicEngine(n,c);h.isSupported()&&(this._music=h)}this._music&&this._music.initialize(),this._api.productSettings.musicControl&&this._api.sdkSettings.cachedSettings.musicControlState==e.CachedSettings.AUDIO_SWITCHED_OFF&&(this._settings.music.enabled=!1)}}return r.prototype.controlMusic=function(t){if(!this._api.productSettings.musicControl||t==this._settings.music.enabled||this.getMusicControlState()==n.DISABLED)return;this._settings.music.enabled=t,this._settings.music.enabled?(this.playMusic(!1),this._api.sdkSettings.cachedSettings.musicControlState=e.CachedSettings.AUDIO_SWITCHED_ON,this._api.sdkSettings.cachedSettings.save()):(this.isMusicPlaying()&&this.stopMusic(),this._api.sdkSettings.cachedSettings.musicControlState=e.CachedSettings.AUDIO_SWITCHED_OFF,this._api.sdkSettings.cachedSettings.save())},r.prototype.controlSound=function(t){if(!this._api.productSettings.soundControl||t==this._settings.sound.enabled||this.getSoundControlState()==n.DISABLED)return;this._settings.sound.enabled=t,!this._settings.sound.enabled&&this.isSoundPlaying()?(this.stopSound(),this._api.sdkSettings.cachedSettings.soundControlState=e.CachedSettings.AUDIO_SWITCHED_OFF,this._api.sdkSettings.cachedSettings.save()):(this._api.sdkSettings.cachedSettings.soundControlState=e.CachedSettings.AUDIO_SWITCHED_ON,this._api.sdkSettings.cachedSettings.save())},r.prototype.getMusicControlState=function(){return this._api.productSettings.musicControl?this._api.productSettings.musicDisabled||!this._enabled?n.DISABLED:this._settings.music.enabled?n.SWITCHED_ON:n.SWITCHED_OFF:n.NOT_SUPPORTED},r.prototype.getSoundControlState=function(){return this._api.productSettings.soundControl?this._api.productSettings.soundDisabled||!this._enabled?n.DISABLED:this._settings.sound.enabled?n.SWITCHED_ON:n.SWITCHED_OFF:n.NOT_SUPPORTED},r.prototype.isMusicPlaying=function(){return this._music?this._music.isPlaying():!1},r.prototype.isMusicRequested=function(){return this._musicRequested},r.prototype.playMusic=function(t,n){return this._musicRequested=!0,this._music&&this._enabled&&this._settings.music.enabled?this._music.play(t,n):new e.Deferred(this._api,!1)},r.prototype.stopMusic=function(){return this._music?this._music.stop():new e.Deferred(this._api,!0)},r.prototype.destroy=function(){this._music=null,this._sound=null},r.prototype.cleanup=function(){if(this._sound){var t=new e.Deferred(this._api);return this._sound.cleanup(function(){t.resolve()}),t}return new e.Deferred(this._api,!0)},r.prototype.restore=function(){return this._sound&&this._enabled!==!1&&this._sound.initialize(),new e.Deferred(this._api,!0)},r.prototype.isSoundPlaying=function(){return this._sound?this._sound.isPlaying():!1},r.prototype.disable=function(){this._enabled=!1},r.prototype.enable=function(){this._enabled=!0},r.prototype.playSound=function(e,t){this._sound&&this._enabled&&this._settings.sound.enabled&&this._sound.play(e,t)},r.prototype.stopSound=function(){this._sound&&this._sound.stop()},r.prototype.needSynchronize=function(){if(!this._enabled)return!1;var e=!0;return this._sound&&!this._sound.isInitialized()&&(e=!1),this._music&&!this._music.isInitialized()&&(e=!1),!e},r.prototype._getMusicTracks=function(){var e=this._api.sdkSettings.audioManager.music,t=this._api.productSettings.music;if(!e.enabled)return null;var n;if(!t)n=[e.tracks[e.defaultTrack]];else{n=[];for(var r in e.tracks)e.tracks.hasOwnProperty(r)&&t.indexOf(r)>=0&&n.push(e.tracks[r])}return n},r}(),t.AudioManager=r})(t=e.Sound||(e.Sound={}))}(TGH5||(TGH5={})),function(e){var t,n=function(){function e(){}return e.cancel="cancel",e.exit="exit",e.exitsmarttv="exitsmarttv",e}();e.MessageDialogAction=n,t=function(){function t(e,t){this._api=e,this._settings=t,this._buttonElements=[],this._visibilityTimeout=0}return t.prototype._setText=function(e,t){var n=this._api.getLanguage(),r;t[n]?r=t[n]:r=t.en,e.innerHTML=r},t.prototype._parseValue=function(e,t){var n=this,r=function(e){if(typeof e=="string"||typeof e=="number")return e;var t=n._api.getLanguage(),r;return e[t]?r=e[t]:r=e.en,r},i=function(e,t){if(!t)return null;var n=e.indexOf("."),r;return n>0?(r=e.substr(0,n),e=e.substr(n+1),i(e,t[r])):t[e]},s=i(e,this._settings);if(s)return r(s);var o=i(e,t);return o?r(o):""},t.prototype.create=function(t){this._backDiv=document.createElement("div"),this._backDiv.className="tgh5-md-back",this._deferred=new e.Deferred(this._api);if(this._settings.template){var r=document.createElement("div"),i=this._settings.template.split("{{");for(var s=0;s<i.length;s++){if(i[s].indexOf("}}")<0)continue;var o=i[s].split("}}"),u=o[0];i[s]=this._parseValue(u,t)+o[1]}r.innerHTML=i.join(""),this._backDiv.appendChild(r),document.body.appendChild(this._backDiv);var a=r.getElementsByClassName("pwbtn");this._settings.buttons=[],this._buttonElements=[];for(var s=0;s<a.length;s++)this._buttonElements.push(a[s]),this._settings.buttons.push({action:n.cancel});this.buttonsFromTemplate=!0}else{var r=document.createElement("div");r.className="tgh5-md-frame",this._settings.width&&(r.style.width=this._settings.width+"px"),this._backDiv.appendChild(r);var f=document.createElement("div");f.className="tgh5-md-text",this._setText(f,this._settings.text),r.appendChild(f);if(this._settings.buttons&&this._settings.buttons.length>0){var l=document.createElement("table");l.className="tgh5-md-buttons";for(var s=0;s<this._settings.buttons.length;s++){var c=this._settings.buttons[s],h=document.createElement("tr"),p=document.createElement("td");h.appendChild(p),p.className="tgh5-md-button regular",this._setText(p,c.text),this._buttonElements.push(p),l.appendChild(h)}r.appendChild(l)}this._lastFocusedBtnIndex=-1,this._lastValidFocusBtnIndex=-1,document.body.appendChild(this._backDiv)}},t.prototype._focusButton=function(e){if(this.buttonsFromTemplate)return;if(this._lastFocusedBtnIndex==e)return;if(this._buttonElements.length<=0)return;this._lastFocusedBtnIndex>=0&&(this._buttonElements[this._lastFocusedBtnIndex].className="tgh5-md-button regular"),this._lastFocusedBtnIndex=e,this._lastFocusedBtnIndex>=0&&(this._buttonElements[this._lastFocusedBtnIndex].className="tgh5-md-button focused"),this._lastFocusedBtnIndex>=0&&(this._lastValidFocusBtnIndex=this._lastFocusedBtnIndex)},t.prototype.suspend=function(){this._buttonElements=null,this._clearVisibilityTimeout(),this._backDiv&&this._backDiv.parentNode&&(this._backDiv.parentNode.removeChild(this._backDiv),this._backDiv=null)},t.prototype.hide=function(){this._removeInputHandlers(),this._clearVisibilityTimeout(),this._backDiv.style.display="none"},t.prototype._clearVisibilityTimeout=function(){this._visibilityTimeout&&(clearTimeout(this._visibilityTimeout),this._visibilityTimeout=0)},t.prototype._addInputHandlers=function(){var t=this._api.getKeyManager(),n=this._api.getMouseManager();t.addListener(e.Key.ListenerType.System,e.Key.EventType.KeyDown,this._onKeyDown,this),t.addListener(e.Key.ListenerType.System,e.Key.EventType.KeyUp,this._onKeyUp,this),n.addListener(this._mouseHandler,this),n.enableMouse()},t.prototype._removeInputHandlers=function(){var t=this._api.getKeyManager(),n=this._api.getMouseManager();t.removeListener(e.Key.ListenerType.System,e.Key.EventType.KeyDown,this._onKeyDown),t.removeListener(e.Key.ListenerType.System,e.Key.EventType.KeyUp,this._onKeyUp),n.removeListener(this._mouseHandler)},t.prototype._findButtonIndexByElement=function(e){for(var t=0;t<this._buttonElements.length;t++)if(e==this._buttonElements[t])return t;return-1},t.prototype._mouseHandler=function(t){switch(t.type){case e.Mouse.Event.MouseOver:this._focusButton(this._findButtonIndexByElement(t.target));break;case e.Mouse.Event.MouseUp:var n=this._findButtonIndexByElement(t.target);n>=0&&this._onAction(this._settings.buttons[n].action)}return!0},t.prototype._onKeyDown=function(t){if(t==e.KeyNames.KEY_ENTER)return!0;var n=0;t==e.KeyNames.KEY_UP?n=-1:t==e.KeyNames.KEY_DOWN&&(n=1);var r=this._buttonElements.length,i=this._lastFocusedBtnIndex;return i<0&&(i=this._lastValidFocusBtnIndex),this._focusButton((i+n+r)%r),!0},t.prototype._onKeyUp=function(t){var r=null;return t==e.KeyNames.KEY_ENTER?this._buttonElements.length>0&&this._lastFocusedBtnIndex>=0?r=this._settings.buttons[this._lastFocusedBtnIndex].action:r=n.cancel:t==e.KeyNames.KEY_BACKSPACE&&(this._settings.buttons&&this._settings.buttons.length>0?r=this._settings.buttons[0].action:r=n.cancel),r&&this._onAction(r),!0},t.prototype._onAction=function(t){var r=this;switch(t){case n.cancel:this._deferred.resolve();break;case n.exit:this._api.getAdsManager().disable(),this.hide(),this._deferred.resolve(),this._api.processLater(function(){r._api.exit(e.ExitRequest.regular)});break;case n.exitsmarttv:this._api.getAdsManager().disable(),this.hide(),this._api.processLater(function(){r._api.setExitRequest(e.ExitRequest.smarttv),r._api.getSystem().exitSmartTV()})}},t.prototype.show=function(){var e=this;return this._deferred.reset(),this._focusButton(0),this._backDiv.style.display="block",this._addInputHandlers(),this._settings.visibilityTime&&this._settings.visibilityTime>0&&(this._visibilityTimeout=setTimeout(function(){e._visibilityTimeout=0,e._deferred.resolve()},this._settings.visibilityTime)),this._deferred},t}(),e.MessageDialog=t}(TGH5||(TGH5={})),function(e){var t,n=function(){function e(){}return e.customerId="customerid",e.urlSpecified="urlspecified",e}();e.AuthorizationMethod=n,t=function(){function t(e){this._api=e,this._settings=this._api.sdkSettings.authorizationManager,this._isAuthorized=!1,this._userUID="",this._isInitialized=!1}return t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.init=function(){var t=this;this._isInitialized=!0;if(!this._settings.enabled)return this._isAuthorized=!0,new e.Deferred(this._api,!0);var r=new e.Deferred(this._api),i=this._getProviderSettings();i||(this._settings.enabled=!1,this._isAuthorized=!0,r.resolve());if(typeof i.overrideUserId!="undefined")i.overrideUserId?(this._userUID=i.overrideUserId,this._isAuthorized=!0,r.resolve()):this.showYouMustLoggedMessage().always(function(){r.resolve(),t._isAuthorized=!0});else if(i.method==n.customerId)this._api.getSystem().getCustomerUID().always(function(e){e?(t._userUID=e,t._isAuthorized=!0,r.resolve()):t.showYouMustLoggedMessage().always(function(){r.resolve(),t._isAuthorized=!0})});else if(i.method==n.urlSpecified){var s=i;this._userUID=e.Api.locationGetParam(s.variableName),s.deviceVariableName?this._deviceUID=e.Api.locationGetParam(s.deviceVariableName):this._deviceUID="",this._isAuthorized=!0,r.resolve()}else this._userUID="user123456",this._isAuthorized=!0,r.resolve();return r},t.prototype.showYouMustLoggedMessage=function(){var n=this._getProviderSettings();if(!n||!n.messageDialogs||!n.messageDialogs[t.youMustLoggedDialogName])return new e.Deferred(this._api,!0);var r=new e.Deferred(this._api),i=new e.MessageDialog(this._api,n.messageDialogs[t.youMustLoggedDialogName]);return i.create(),i.show().always(function(){i.hide(),i.suspend(),r.resolve()}),r},t.prototype._getProviderSettings=function(){var e=null,t=this._api.getProductSettings(this._api.productId);return t&&t.authorizationProvider&&(e=this._settings.providers[t.authorizationProvider]),!e&&this._settings.providers.defaultProvider&&(e=this._settings.providers[this._settings.providers.defaultProvider]),e},t.prototype.getUserUID=function(){return this._userUID},t.prototype.getDeviceUID=function(){return this._deviceUID},t.prototype.needSynchronize=function(){return!this._isAuthorized},t.youMustLoggedDialogName="youMustLogged",t}(),e.AuthorizationManager=t}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(t){var n=function(){function t(e,t){this._api=e,this._setting=t}return t.prototype.requestCountryCode=function(){return this._deferred=new e.Deferred(this._api),this.startRequestTimeout(),this._deferred},t.prototype.requestIpAddress=function(){return this._deferred=new e.Deferred(this._api),this.startRequestTimeout(),this._deferred},t.prototype.requestIp6Address=function(){return this._deferred=new e.Deferred(this._api),this.startRequestTimeout(),this._deferred},t.prototype.resolve=function(e){this._release(),this._deferred.resolve(e)},t.prototype.reject=function(e){this._release(),this._deferred.reject(e)},t.prototype._release=function(){this.stopRequestTimeout()},t.prototype.startRequestTimeout=function(){var t=this;this.stopRequestTimeout(),this._requestTimeout=setTimeout(function(){t._api.reportGeoEvent(e.Reporting.Geo.timeout,t._setting.className),t.reject()},this._setting.requestTimeout)},t.prototype.stopRequestTimeout=function(){this._requestTimeout&&(clearTimeout(this._requestTimeout),this._requestTimeout=0)},t.prototype.noImplementation=function(){var t=new e.Deferred(this._api,"");return t.reject(),t},t}();t.Base=n})(n=t.Providers||(t.Providers={}))})(t=e.Geo||(e.Geo={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(t){var n=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.requestCountryCode=function(){var e=this;return window.geoPlugin_suc=function(t){t&&t.geoplugin_countryCode?(e._ip=""+t.geoplugin_request,e.resolve(""+t.geoplugin_countryCode)):e.reject()},this._api.loadScript(this._setting.url,this._setting.requestTimeout).fail(function(){e.reject()}),t.prototype.requestCountryCode.call(this)},n.prototype.requestIpAddress=function(){var n=this;return this._ip?new e.Deferred(this._api,this._ip):(window.geoPlugin_suc=function(e){e&&e.geoplugin_countryCode?n.resolve(""+e.geoplugin_request):n.reject()},this._api.loadScript(this._setting.url,this._setting.requestTimeout).fail(function(){n.reject()}),t.prototype.requestIpAddress.call(this))},n.prototype.requestIp6Address=function(){return t.prototype.noImplementation.call(this)},n}(t.Base);t.geoPlugin=n})(n=t.Providers||(t.Providers={}))})(t=e.Geo||(e.Geo={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(t){var n=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.requestCountryCode=function(){var e=this;return this._api.loadScript(this._setting.url,this._setting.requestTimeout).done(function(){var t=window.google;t&&t.loader&&t.loader.ClientLocation&&t.loader.ClientLocation.address&&t.loader.ClientLocation.address.country_code?e.resolve(t.loader.ClientLocation.address.country_code):e.reject("")}).fail(function(){e.reject()}),t.prototype.requestCountryCode.call(this)},n.prototype.requestIpAddress=function(){var t=new e.Deferred(this._api);return t.reject(""),t},n.prototype.requestIp6Address=function(){return t.prototype.noImplementation.call(this)},n}(t.Base);t.googleLoader=n})(n=t.Providers||(t.Providers={}))})(t=e.Geo||(e.Geo={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(t){var n=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.requestCountryCode=function(){var e=this;return this._api.loadScript(this._setting.url,this._setting.requestTimeout).done(function(){try{var t=window.geoip2;t.country(function(t){e.resolve(t.country.iso_code)},function(t){e.reject()})}catch(n){e.reject()}}).fail(function(){e.reject("")}),t.prototype.requestCountryCode.call(this)},n.prototype.requestIpAddress=function(){var t=new e.Deferred(this._api);return t.reject(""),t},n.prototype.requestIp6Address=function(){return t.prototype.noImplementation.call(this)},n}(t.Base);t.maxmind=n})(n=t.Providers||(t.Providers={}))})(t=e.Geo||(e.Geo={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(t){var n=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.requestCountryCode=function(){return t.prototype.noImplementation.call(this)},n.prototype.requestIpAddress=function(){var r=this;if(n._ip)return new e.Deferred(this._api,n._ip);var i=new XMLHttpRequest;return i.open("GET",this._setting.url,!0),i.onreadystatechange=function(){if(i&&i.readyState===4)if(i.status===200)try{var e=JSON.parse(i.response);e&&e.ip&&(n._ip=e.ip,r.resolve(n._ip))}catch(t){r.reject()}else r.reject()},i.send(),t.prototype.requestIpAddress.call(this)},n.prototype.requestIp6Address=function(){var r=this;if(n._ip6)return new e.Deferred(this._api,n._ip6);var i=new XMLHttpRequest;return i.open("GET",this._setting.url6,!0),i.onreadystatechange=function(){if(i&&i.readyState===4)if(i.status===200)try{var e=JSON.parse(i.response);e&&e.ip&&(n._ip6=e.ip,r.resolve(n._ip6))}catch(t){r.reject()}else r.reject()},i.send(),t.prototype.requestIp6Address.call(this)},n}(t.Base);t.pwipify=n})(n=t.Providers||(t.Providers={}))})(t=e.Geo||(e.Geo={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(t){var n=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.requestCountryCode=function(){var r=this;if(n._countryCode)return new e.Deferred(this._api,n._countryCode);var i=new XMLHttpRequest;return i.open("GET",this._setting.geoUrl,!0),i.onreadystatechange=function(){if(i&&i.readyState===4)if(i.status===200)try{var e=JSON.parse(i.response);e&&e.location&&e.location.country&&(e.ip&&(n._ip=e.ip),n._countryCode=""+e.location.country,r.resolve(n._countryCode))}catch(t){r.reject()}else r.reject()},i.send(),t.prototype.requestCountryCode.call(this)},n.prototype.requestIpAddress=function(){var r=this;return n._ip?new e.Deferred(this._api,n._ip):(window.getIP_suc=function(e){e&&e.ip?(n._ip=e.ip,r.resolve(""+e.ip)):r.reject()},this._api.loadScript(this._setting.url,this._setting.requestTimeout).fail(function(){r.reject()}),t.prototype.requestIpAddress.call(this))},n.prototype.requestIp6Address=function(){return t.prototype.noImplementation.call(this)},n}(t.Base);t.ipify=n})(n=t.Providers||(t.Providers={}))})(t=e.Geo||(e.Geo={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(t){var n=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.requestCountryCode=function(){var n=t.prototype.requestCountryCode.call(this),r=e.Api.locationGetParam("country");return r?this.resolve(r):this.reject(),n},n.prototype.requestIpAddress=function(){var n=t.prototype.requestIpAddress.call(this),r=e.Api.locationGetParam("ip");return r?this.resolve(r):this.reject(),n},n.prototype.requestIp6Address=function(){var n=t.prototype.requestIp6Address.call(this),r=e.Api.locationGetParam("ip6");return r?this.resolve(r):this.reject(),n},n}(t.Base);t.LaunchParam=n})(n=t.Providers||(t.Providers={}))})(t=e.Geo||(e.Geo={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function n(e){this._api=e,this._settings=e.sdkSettings.geoManager,this._settings||(this._settings={enabled:!1})}return n.prototype.requestCountryCode=function(){var r=this;if(this._settings.enabled===!1)return new e.Deferred(this._api,n.DEFAULT_COUNTRY_CODE);var i=e.Api.locationGetParam("country");typeof i=="string"&&i.length&&(this._api.sdkSettings.cachedSettings.country=i);if(this._settings.nocache!==!0&&this._api.sdkSettings.cachedSettings.country)return new e.Deferred(this._api,this._api.sdkSettings.cachedSettings.country);var s=new e.Deferred(this._api),o=function(n){if(r._settings.providers.length<=n){if(r._settings.defaultCountry){s.resolve(r._settings.defaultCountry);return}r._api.reportGeoEvent(e.Reporting.Geo.unknownCountry),s.reject();return}var i=r._settings.providers[n],u=new t.Providers[i.className](r._api,i);r._api.reportGeoEvent(e.Reporting.Geo.requestGeo,i.className),u.requestCountryCode().done(function(t){r._api.reportGeoEvent(e.Reporting.Geo.responseGeo,i.className,t),r._api.sdkSettings.cachedSettings.country=t,r._api.sdkSettings.cachedSettings.save(),s.resolve(t)}).fail(function(){o(n+1)})};return o(0),s},n.prototype._ipIsValid=function(e){return!e||typeof e!="string"?!1:e.split(".").length!=4?!1:!0},n.prototype._ip6IsValid=function(e){return!e||typeof e!="string"?!1:e.split(":").length>1?!0:!1},n.ipRangeCheck=function(e,t){try{var n=e.split("."),r=t.split(".");if(r.length!=n.length||n.length!=4)return!1;for(var i=0;i<4;i++){if(r[i]==n[i])continue;if(r[i].indexOf("/")>=0){var s=Number(n[i]),o=r[i].split("/");if(s>=Number(o[0])&&s<=Number(o[1]))continue}return!1}return!0}catch(u){return!1}},n.prototype.requestIpAddress=function(){var r=this;if(this._settings.enabled===!1)return new e.Deferred(this._api,n.DEFAULT_IP_ADDRESS);if(this._settings.nocache!==!0&&this._ipIsValid(this._api.sdkSettings.cachedSettings.ip))return new e.Deferred(this._api,this._api.sdkSettings.cachedSettings.ip);var i=new e.Deferred(this._api),s=function(n){if(r._settings.providers.length<=n){r._api.reportGeoEvent(e.Reporting.Geo.unknownIp),i.reject();return}var o=r._settings.providers[n],u=new t.Providers[o.className](r._api,o);r._api.reportGeoEvent(e.Reporting.Geo.requestIp,o.className),u.requestIpAddress().done(function(t){r._ipIsValid(t)?(r._api.reportGeoEvent(e.Reporting.Geo.responseIp,o.className),r._api.sdkSettings.cachedSettings.ip=t,r._api.sdkSettings.cachedSettings.save(),i.resolve(t)):s(n+1)}).fail(function(){s(n+1)})};return s(0),i},n.prototype.requestIp6Address=function(){var r=this;if(this._settings.enabled===!1)return new e.Deferred(this._api,n.DEFAULT_IP6_ADDRESS);if(this._settings.nocache!==!0&&this._ip6IsValid(this._api.sdkSettings.cachedSettings.ip6))return new e.Deferred(this._api,this._api.sdkSettings.cachedSettings.ip6);var i=new e.Deferred(this._api),s=function(n){if(r._settings.providers.length<=n){r._api.reportGeoEvent(e.Reporting.Geo.unknownIp),i.reject();return}var o=r._settings.providers[n],u=new t.Providers[o.className](r._api,o);r._api.reportGeoEvent(e.Reporting.Geo.requestIp,o.className),u.requestIp6Address().done(function(t){r._ip6IsValid(t)?(r._api.reportGeoEvent(e.Reporting.Geo.responseIp,o.className),r._api.sdkSettings.cachedSettings.ip6=t,r._api.sdkSettings.cachedSettings.save(),i.resolve(t)):s(n+1)}).fail(function(){s(n+1)})};return s(0),i},n.DEFAULT_COUNTRY_CODE="us",n.DEFAULT_IP_ADDRESS="",n.DEFAULT_IP6_ADDRESS="",n}();t.GeoManager=n})(t=e.Geo||(e.Geo={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t;(function(e){e[e.RUNTIME_ERROR=201]="RUNTIME_ERROR",e[e.LOGIN_ERROR=202]="LOGIN_ERROR",e[e.GET_ATTRIBUTES_ERROR=203]="GET_ATTRIBUTES_ERROR",e[e.SET_ATTRIBUTES_ERROR=204]="SET_ATTRIBUTES_ERROR",e[e.DELETE_PROFILE_ERROR=205]="DELETE_PROFILE_ERROR",e[e.LOAD_ENTITY_ERROR=206]="LOAD_ENTITY_ERROR",e[e.SAVE_ENTITY_ERROR=207]="SAVE_ENTITY_ERROR",e[e.DELETE_ENTITY_ERROR=208]="DELETE_ENTITY_ERROR",e[e.GET_GLOBAL_ENTITY_ERROR=209]="GET_GLOBAL_ENTITY_ERROR",e[e.REACH_MAXIMUM_USERS=210]="REACH_MAXIMUM_USERS",e[e.ERROR_UPDATE_NICKNAME=216]="ERROR_UPDATE_NICKNAME",e[e.ILLEGAL_NICKNAME=217]="ILLEGAL_NICKNAME",e[e.ERROR_SUBMIT_SCORE=330]="ERROR_SUBMIT_SCORE",e[e.ERROR_GET_SCORE=331]="ERROR_GET_SCORE",e[e.ERROR_RESET_SCORE=332]="ERROR_RESET_SCORE",e[e.ERROR_RESET_PROFILE=334]="ERROR_RESET_PROFILE"})(t=e.IBAASProviderError||(e.IBAASProviderError={}))})(t=e.Social||(e.Social={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t,n=function(){function e(){}return e.WELCOME_SCREEN="welcomeScreen",e.CHOOSE_PROFILE="chooseProfile",e.DELETE_PROFILE="deleteProfile",e.DELETE_PROFILE_NOTIFY="deleteProfileNotify",e.CREATE_PROFILE="createProfile",e.ERROR_MESSAGE="errorMessage",e.ILLEGAL_NICKNAME="illegalNickname",e.LEADERBOARD="leaderboard",e.TOURNAMENT_INFO="tournamentInfo",e.CONGRATULATIONS="congratulations",e.TOURNAMENT_QUALIFICATION="tournamentQualification",e.TOURNAMENT_RULES="tournamentRules",e.ADDITIONAL_INFO="additionalInfo",e.TOURNAMENT_WARNING="tournamentWarning",e}();e.DialogName=n,t=function(){function e(){}return e.OK="ok",e.CANCEL="cancel",e.RENAME_PROFILE="renameProfile",e.DELETE_PROFILE="deleteProfile",e.ADD_PROFILE="addProfile",e.PLAY_AS_GUEST="playAsGuest",e.NEXT="next",e.PREVIOUS="previous",e.QUIT="quit",e.TOURNAMENT_INFO="tournamentInfo",e.TOURNAMENT_RULES="tournamentRules",e}(),e.DialogEvent=t})(t=e.Social||(e.Social={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t,n=function(){function e(){}return e.TOURNAMENT="tournament",e.DAILY="daily",e.WEEKLY="weekly",e.MONTHLY="monthly",e.ALLTIME="alltime",e.HOME="home",e}();e.LeaderboardType=n,e.LeaderboardPriority=[n.TOURNAMENT,n.ALLTIME,n.MONTHLY,n.WEEKLY,n.DAILY,n.HOME],t=function(){function e(){}return e.RANK="rank",e.NAME="name",e.SCORE="score",e}(),e.LeaderboardColumnType=t})(t=e.Social||(e.Social={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t=function(){function t(e,t){this._api=e,this._baasProviderImpl=t}return t.prototype.init=function(e){this._settings=e,this._leaderboards=null},t.prototype.loadConfiguration=function(e,t){var n=this;this._baasProviderImpl.getProductGlobalEntities("leaderboard",this._api.productId,function(t){n._leaderboards=t,n._setDefaultData(),e()},t)},t.prototype._setDefaultData=function(){for(var e=0;e<this._leaderboards.length;e++){var t=this._leaderboards[e];t.name||(t.name=this._settings.defaultSettings.pageNames[t.type]),t.columns||(t.columns=this._settings.defaultSettings.columns),t.timeFormat||(t.timeFormat=this._settings.defaultSettings.timeFormat)}},t.prototype._isTournamentStarted=function(e){var t=Date.now();return e.startTime>t?!1:!0},t.prototype._isTournamentClosed=function(e){var t=Date.now();return e.endTime<t?!0:!1},t.prototype._isTournamentActive=function(e){var t=Date.now();return e.startTime<=t&&t<e.endTime?!0:!1},t.prototype.getActiveTournament=function(t){var n=this._getLeaderboardsForSubmit(t);for(var r=0;r<n.length;r++)if(n[r].type==e.LeaderboardType.TOURNAMENT)return n[r];return null},t.prototype._getLeaderboardsForSubmit=function(t,n){var r=[];for(var i=0;i<this._leaderboards.length;i++)if(this._leaderboards[i].gameMode==t){if(this._leaderboards[i].type==e.LeaderboardType.TOURNAMENT&&(!this._isTournamentActive(this._leaderboards[i])||n==1))continue;r.push(this._leaderboards[i])}return r},t.prototype.resetScore=function(e,t,n){this._baasProviderImpl.resetScore(e,this._leaderboards,t,n)},t.prototype.isQualifiedToTournament=function(t,n,r,i,s){var o=null;for(var u=0;u<this._leaderboards.length;u++){var a=this._leaderboards[u];if(a.gameMode==n&&a.type==e.LeaderboardType.TOURNAMENT&&this._isTournamentActive(a)){o=a;break}}if(!o){i(!1);return}this._baasProviderImpl.isQualifiedToLeaderboard(t,o,r,i,s)},t.prototype.submitScore=function(t,n,r,i,s,o){var u=this._getLeaderboardsForSubmit(n,i);u.sort(function(t,n){return e.LeaderboardPriority.indexOf(t.type)-e.LeaderboardPriority.indexOf(n.type)}),this._baasProviderImpl.submitScore(t,u,r,s,o)},t.prototype.getLeaderboardData=function(t,n,r){var i=this,s=[];for(var o=0;o<this._leaderboards.length;o++){var u=this._leaderboards[o];if(u.type==e.LeaderboardType.TOURNAMENT&&!this._isTournamentStarted(u))continue;s.push(u)}this._baasProviderImpl.getLeaderboardData(t,s,function(t){var r={},s=i._api.getProductSettings();if(t.length<=0){n(t);return}for(var o=0;o<t.length;o++){var u=t[o],a=u.settings.gameMode;r[a]||(r[a]=[]),r[a].push(u)}var f=[];for(var o=0;o<s.gameModes.length;o++){var a=s.gameModes[o];r[a].sort(function(t,n){var r=e.LeaderboardPriority.indexOf(t.settings.type)-e.LeaderboardPriority.indexOf(n.settings.type);return r==0&&t.settings.type==e.LeaderboardType.TOURNAMENT?i._isTournamentClosed(t.settings)?1:-1:r}),f=f.concat(r[a])}n(f)},r)},t.MAX_RECORDS=10,t}();e.LeaderboardManager=t})(t=e.Social||(e.Social={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function t(e,t){this._api=e,this._storage=this._api.getStorage(),this._baasProviderImpl=t}return t.prototype.init=function(){this._gameData={},this._profile=null},t.prototype.remove=function(t,n,r,i){var s=new e.PackedStream;this.save(t,s,n,r,i)},t.prototype.save=function(t,n,r,i,s){var o=this,u=function(){var s=Date.now(),u=new e.PackedStream;u.write(t.profileId),u.write(s),u.appendPackedStream(n),o._storage.save(u,r,null,!1),o._profile=t,o._gameData[r]=u.toString(!0),i()};this._profile&&this._profile.profileId!=t.profileId?this.synchronize(function(){u()},s):u()},t.prototype.load=function(t,n,r,i){var s=this,o=function(){s._profile=t,s._baasProviderImpl.requestProductEntity(t,s._api.productId,n,function(i){var o=s._storage.load(n),u=null,a=function(e){e&&!e.isEnd()?r(e):r(null)};if(o){var f=o.readString();f!=t.profileId&&(o=null)}if(i){u=new e.PackedStream,u.init(i,!0)||(u=null);var f=u.readString();f!=t.profileId&&(u=null)}if(o&&u){var l=o.readInteger(),c=u.readInteger();console.log("Storage game data: "+l),console.log("BC game data: "+c),l>c?a(o):a(u)}else o?(o.readInteger(),a(o)):u?(u.readInteger(),a(u)):a(null)},i)};this._profile&&this._profile.profileId!=t.profileId?this.synchronize(function(){o()},i):o()},t.prototype.resetLocal=function(e){if(this._profile&&this._profile.profileId==e.profileId){console.log("Reset local storage for profile: "+e.profileId),this._profile=null;for(var t in this._gameData)this._gameData.hasOwnProperty(t)&&this._storage.remove(t);this._gameData={}}},t.prototype.synchronize=function(e,t){this._profile&&this._gameData?(this._baasProviderImpl.submitProductEntities(this._profile,this._api.productId,this._gameData,e,t),this._gameData={}):e()},t}();t.StorageManager=n})(t=e.Social||(e.Social={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t,n;(function(e){e[e.FAIL_LOAD_LIBRARIES=101]="FAIL_LOAD_LIBRARIES",e[e.RUNTIME_ERROR=102]="RUNTIME_ERROR",e[e.LOGIN_FAIL=103]="LOGIN_FAIL",e[e.FAIL_RETRIEVE_PROFILES=104]="FAIL_RETRIEVE_PROFILES",e[e.FAIL_DELETE_PROFILE=105]="FAIL_DELETE_PROFILE",e[e.FAIL_CREATE_PROFILE=106]="FAIL_CREATE_PROFILE",e[e.FAIL_SUBMIT_SCORE=107]="FAIL_SUBMIT_SCORE",e[e.FAIL_RETRIEVE_LEADERBOARD=108]="FAIL_RETRIEVE_LEADERBOARD",e[e.FAIL_LOAD_CONFIGURATIONS=109]="FAIL_LOAD_CONFIGURATIONS",e[e.FAIL_LOAD_GAME_DATA=110]="FAIL_LOAD_GAME_DATA",e[e.FAIL_SAVE_GAME_DATA=111]="FAIL_SAVE_GAME_DATA"})(t=e.SocialManagerError||(e.SocialManagerError={})),n=function(){function n(e,t,n){this._socialManagerError=e,typeof t=="number"?this._baasProviderError=t:typeof t=="string"&&(this._message=""+t),n&&(this._message=n)}return n.prototype._getTextByErrorCode=function(e){for(var t=0;t<n._errorText.length;t++)if(n._errorText[t].code==e)return n._errorText[t].text;return"undefined"},n.prototype.toLongString=function(){var e="Error code: "+this._socialManagerError+"["+this._getTextByErrorCode(this._socialManagerError)+"]";return this._baasProviderError&&(e+=", "+this._baasProviderError+"["+this._getTextByErrorCode(this._baasProviderError)+"]"),this._message&&(e+=", "+this._message),e},n.prototype.toString=function(){var e="Error code: "+this._socialManagerError;return this._baasProviderError&&(e+=this._baasProviderError),this._message&&(e+="<br>"+this._message),e},n._errorText=[{code:t.FAIL_LOAD_LIBRARIES,text:"FAIL_LOAD_LIBRARIES"},{code:t.RUNTIME_ERROR,text:"RUNTIME_ERROR"},{code:t.LOGIN_FAIL,text:"LOGIN_FAIL"},{code:t.FAIL_RETRIEVE_PROFILES,text:"FAIL_RETRIEVE_PROFILES"},{code:t.FAIL_DELETE_PROFILE,text:"FAIL_DELETE_PROFILE"},{code:t.FAIL_CREATE_PROFILE,text:"FAIL_CREATE_PROFILE"},{code:t.FAIL_SUBMIT_SCORE,text:"FAIL_SUBMIT_SCORE"},{code:t.FAIL_RETRIEVE_LEADERBOARD,text:"FAIL_RETRIEVE_LEADERBOARD"},{code:t.FAIL_LOAD_CONFIGURATIONS,text:"FAIL_LOAD_CONFIGURATIONS"},{code:t.FAIL_LOAD_GAME_DATA,text:"FAIL_LOAD_GAME_DATA"},{code:t.FAIL_SAVE_GAME_DATA,text:"FAIL_SAVE_GAME_DATA"},{code:e.IBAASProviderError.RUNTIME_ERROR,text:"RUNTIME_ERROR"},{code:e.IBAASProviderError.LOGIN_ERROR,text:"LOGIN_ERROR"},{code:e.IBAASProviderError.GET_ATTRIBUTES_ERROR,text:"GET_ATTRIBUTES_ERROR"},{code:e.IBAASProviderError.SET_ATTRIBUTES_ERROR,text:"SET_ATTRIBUTES_ERROR"},{code:e.IBAASProviderError.DELETE_PROFILE_ERROR,text:"DELETE_PROFILE_ERROR"},{code:e.IBAASProviderError.LOAD_ENTITY_ERROR,text:"LOAD_ENTITY_ERROR"},{code:e.IBAASProviderError.SAVE_ENTITY_ERROR,text:"SAVE_ENTITY_ERROR"},{code:e.IBAASProviderError.DELETE_ENTITY_ERROR,text:"DELETE_ENTITY_ERROR"},{code:e.IBAASProviderError.GET_GLOBAL_ENTITY_ERROR,text:"GET_GLOBAL_ENTITY_ERROR"},{code:e.IBAASProviderError.ERROR_UPDATE_NICKNAME,text:"ERROR_UPDATE_NICKNAME"},{code:e.IBAASProviderError.ILLEGAL_NICKNAME,text:"ILLEGAL_NICKNAME"},{code:e.IBAASProviderError.ERROR_SUBMIT_SCORE,text:"ERROR_SUBMIT_SCORE"},{code:e.IBAASProviderError.ERROR_GET_SCORE,text:"ERROR_GET_SCORE"},{code:e.IBAASProviderError.ERROR_RESET_SCORE,text:"ERROR_RESET_SCORE"},{code:e.IBAASProviderError.ERROR_RESET_PROFILE,text:"ERROR_RESET_PROFILE"}],n}(),e.Error=n})(t=e.Social||(e.Social={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function t(e,t,n){this._gameMode=t,this._slotName=e,this._isTournamentFlow=n}return t.prototype.updateTournament=function(e){if(this._isTournament===!0){if(!e||this._tournamentId!==e.baasId)this._isTournament=!1}else this._isTournament!==!1&&(e?(this._isTournament=!0,this._tournamentId=e.baasId):(this._isTournament=!1,this._tournamentId=""))},t.prototype.disableTournament=function(){this._isTournament=!1,this._tournamentId=""},t.prototype.isAllowTournament=function(){return this._isTournament},t.prototype.isWrongTournament=function(e){return!e||!this._isTournamentFlow?!1:this._isTournament===!0&&this._tournamentId===e.baasId?!1:!0},t.prototype.getGameMode=function(){return this._gameMode},t.prototype.getSlotName=function(){return this._slotName},t.prototype.setStream=function(e){this._stream=e},t.prototype.getStream=function(){return this._stream},t.prototype.clear=function(){this._stream=null},t.prototype._serialize=function(){var t=new e.PackedStream,n=new e.PackedStream;return n.write(this._isTournamentFlow),n.write(this._isTournament),n.write(""+this._tournamentId),n.write(""+this._gameMode),t.writePackedStream(n),t.writePackedStream(this._stream),t},t.prototype._deserialize=function(e){if(e){var t=e.readPackedStream();this._stream=e.readPackedStream(),this._isTournamentFlow=t.readBoolean(),this._isTournament=t.readBoolean(),this._tournamentId=t.readString(),this._gameMode=t.readString()}else this._stream=null,this._isTournamentFlow=!0,this._isTournament=!0,this._tournamentId=""},t}();t.GameData=n})(t=e.Social||(e.Social={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function n(e){this._api=e,this._settings=this._api.sdkSettings.socialManager,this._initialized=!1,this._profiles=[],this._loadingBar=null}return n.prototype.isEnabled=function(){return this._settings.enabled===!1?!1:this._initialized},n.prototype.needSynchronize=function(){return!this._initialized},n.prototype._showLoadingBar=function(){this._loadingBar||(this._loadingBar=new e.LoadingProgressBar(this._api),this._loadingBar.create(document.body)),this._loadingBar.show(),this._api.disableInput(),this._api.getKeyManager().setEnabled(!1,e.Key.ListenerType.System,e.Key.EventType.Any)},n.prototype._hideLoadingBar=function(){this._loadingBar&&this._loadingBar.hide(),this._api.enableInput(),this._api.getKeyManager().setEnabled(!0,e.Key.ListenerType.System,e.Key.EventType.Any)},n.prototype.init=function(){var n=this,r=this._api.getProductSettings(this._api.productId),i=r&&typeof r.socialManagerDisabled!="undefined"&&r.socialManagerDisabled===!0;if(this._settings.enabled===!1||this._initialized||i)return this._settings.enabled=!1,this._initialized=!0,new e.Deferred(this._api,!0);var s=new e.Deferred(this._api),o=0,u=this._settings.libraries.length;for(var a=0;a<u;a++)this._api.loadScript(this._api.resolvePath(this._settings.libraries[a]),this._settings.loadLibraryTimeout).fail(function(e){n._onError(new t.Error(t.SocialManagerError.FAIL_LOAD_LIBRARIES,e)),s.reject()}).done(function(){o++;if(o==u)try{n._baasProviderImpl=new e.Social[n._settings.baasProvider.className],n._baasProviderImpl.init(n._settings.baasProvider),n._dialogManagerImpl=new e.Social[n._settings.dialogManager.className](n._api),n._dialogManagerImpl.init(n._settings.dialogManager),n._leaderboardManager=new e.Social.LeaderboardManager(n._api,n._baasProviderImpl),n._leaderboardManager.init(n._settings.leaderboardManager),n._storageManager=new e.Social.StorageManager(n._api,n._baasProviderImpl),n._storageManager.init(),n._baasProviderImpl.login(n._getHomeAccountProfileId(),n._getDeviceId(),n._getHomeAccountPassword(),function(){n._loadConfiguration(function(){n._initialized=!0,s.resolve()},function(e,r){n._onError(new t.Error(t.SocialManagerError.FAIL_LOAD_CONFIGURATIONS,e,r)),s.reject()})},function(e,r){n._onError(new t.Error(t.SocialManagerError.LOGIN_FAIL,e,r)),s.reject()})}catch(r){n._onError(new t.Error(t.SocialManagerError.RUNTIME_ERROR,""+r)),s.reject()}});return s},n.prototype._loadConfiguration=function(e,t){this._leaderboardManager.loadConfiguration(e,t)},n.prototype._onError=function(n,r,i){var s=this;this._dialogManagerImpl.hideDialog();var o=!1;this._loadingBar&&(o=this._loadingBar.isVisible()),this._hideLoadingBar(),this._api.console.error(n.toLongString()),console.log(n.toLongString()),this._api.reportErrorEvent(e.Reporting.Errors.socialError,n.toLongString()),this._dialogManagerImpl.showDialog(t.DialogName.ERROR_MESSAGE,{error:n,retryMode:r,cancelMode:i},function(e){switch(e){case t.DialogEvent.QUIT:s._api.exit();break;case t.DialogEvent.OK:s._dialogManagerImpl.hideDialog(),r&&(o&&s._showLoadingBar(),r());break;default:s._dialogManagerImpl.hideDialog(),i&&i()}})},n.prototype.getHomeAccountID=function(){return this._api.getAuthorizationManager().getUserUID()},n.prototype._getDeviceId=function(){return this._api.getAuthorizationManager().getDeviceUID()},n.prototype._getHomeAccountProfileId=function(){return this.getHomeAccountID()},n.prototype._getHomeAccountPassword=function(){return n._MAGIC_1+this.getHomeAccountID()+n._MAGIC_2},n.prototype._resolve=function(e){this._dialogManagerImpl.hideDialog(),this._hideLoadingBar(),this._deferred.resolve(e)},n.prototype.chooseProfile=function(){var r=this;return this.isEnabled()?(this._deferred=new e.Deferred(this._api),this._showLoadingBar(),this._baasProviderImpl.getProfiles(function(e){r._profiles=e;var t=r._api.sdkSettings.cachedSettings.lastProfileId;console.log("Last profile ID: "+t);if(t){var n=r._getProfileIndex(t);n<0&&e.length>0&&(n=0),n<0?r._createRandomGuestProfile():(r._selectProfile(e[n]),r._resolve())}else r._createRandomGuestProfile()},function(e,n){r._onError(new t.Error(t.SocialManagerError.FAIL_RETRIEVE_PROFILES,e,n)),r._deferred.reject()}),this._deferred):(this._selectProfile(n._guestProfile),new e.Deferred(this._api,!0))},n.prototype._getRandomDigit=function(){return Math.random()*10%10|0},n.prototype._createRandomGuestProfile=function(){var e=this,n={playerName:"GUEST"+this._getRandomDigit()+this._getRandomDigit()+this._getRandomDigit()};this._baasProviderImpl.createProfile(n,function(t){e._profiles.push(t),e._selectProfile(t),e._resolve()},function(n,r){n==t.IBAASProviderError.REACH_MAXIMUM_USERS?(e._selectProfile(e._profiles[0]),e._resolve()):e._onCreateProfileError(n,r,function(){e._createRandomGuestProfile()},function(){e._api.exit()})})},n.prototype._playAsGuest=function(){console.log("_playAsGuest"),this._selectProfile(n._guestProfile),this._resolve()},n.prototype._onCreateProfileError=function(e,n,r,i){var s=this;this._hideLoadingBar(),e==t.IBAASProviderError.ILLEGAL_NICKNAME?this._dialogManagerImpl.showDialog(t.DialogName.ILLEGAL_NICKNAME,{},function(e){s._dialogManagerImpl.hideDialog(t.DialogName.ILLEGAL_NICKNAME)}):this._onError(new t.Error(t.SocialManagerError.FAIL_CREATE_PROFILE,e,n),r,i)},n.prototype._updateProfile=function(e,n,r){var i=this;this._baasProviderImpl.updateProfile(e,n,function(e){var n=i._getProfileIndex(e.profileId);n>=0&&(i._profiles[n]=e),i._hideLoadingBar(),i._dialogManagerImpl.hideDialog(t.DialogName.ADDITIONAL_INFO),i._dialogManagerImpl.hideDialog(t.DialogName.CREATE_PROFILE),i._selectProfile(e),r&&r()},function(t,s){i._onCreateProfileError(t,s,function(){i._updateProfile(e,n,r)},function(){r&&r()})})},n.prototype._renameProfile=function(e,n){var r=this;this._dialogManagerImpl.showDialog(t.DialogName.CREATE_PROFILE,{nickName:e.playerName,isRename:!0},function(i,s){switch(i){case t.DialogEvent.CANCEL:r._dialogManagerImpl.hideDialog(t.DialogName.CREATE_PROFILE);break;case t.DialogEvent.OK:r._settings.dialogManager.additionalInfoDisabled?(r._showLoadingBar(),r._updateProfile(e,{playerName:s},n)):r._dialogManagerImpl.showDialog(t.DialogName.ADDITIONAL_INFO,{playerName:s,age:e.age,gender:e.gender},function(i,s){i==t.DialogEvent.OK?(r._showLoadingBar(),r._updateProfile(e,s,n)):r._dialogManagerImpl.hideDialog(t.DialogName.ADDITIONAL_INFO)})}})},n.prototype._createProfile=function(e,t){var n=this;this._showLoadingBar(),this._baasProviderImpl.createProfile(e,function(e){n._profiles.push(e),n._selectProfile(e),t?t(e):n._resolve()},function(e,t){n._onCreateProfileError(e,t,null,function(){n._resolve()})})},n.prototype._createNewProfile=function(e){var n=this;this._dialogManagerImpl.showDialog(t.DialogName.CREATE_PROFILE,{nickName:"",isRename:!1},function(r,i){console.log("_createNewProfile: on event: "+r);switch(r){case t.DialogEvent.CANCEL:n._dialogManagerImpl.hideDialog(t.DialogName.CREATE_PROFILE);break;case t.DialogEvent.OK:n._settings.dialogManager.additionalInfoDisabled?n._createProfile({playerName:i},e):n._dialogManagerImpl.showDialog(t.DialogName.ADDITIONAL_INFO,{playerName:i,age:"",gender:""},function(r,s){r==t.DialogEvent.OK?n._createProfile({playerName:i,gender:s.gender,age:s.age},e):n._dialogManagerImpl.hideDialog(t.DialogName.ADDITIONAL_INFO)})}})},n.prototype.showProfileDialog=function(){var t=this;return this.isEnabled()?(this._deferred=new e.Deferred(this._api),this._showProfileDialog({guestAllowed:!1,profiles:this._profiles,lockedProfileId:this._api.sdkSettings.cachedSettings.lastProfileId,defaultProfileId:this._api.sdkSettings.cachedSettings.lastProfileId},function(){t._resolve()}),this._deferred):new e.Deferred(this._api,!0)},n.prototype._deleteProfile=function(e,n){var r=this;this._dialogManagerImpl.showDialog(t.DialogName.DELETE_PROFILE,e,function(i){r._dialogManagerImpl.hideDialog(t.DialogName.DELETE_PROFILE),i==t.DialogEvent.OK&&(r._showLoadingBar(),r._storageManager.resetLocal(e),r._leaderboardManager.resetScore(e,function(){r._baasProviderImpl.deleteProfile(e,function(){r._hideLoadingBar();var i=r._getProfileIndex(e.profileId);i>=0&&r._profiles.splice(i,1),r._dialogManagerImpl.showDialog(t.DialogName.DELETE_PROFILE_NOTIFY,e,function(e){r._dialogManagerImpl.hideDialog(t.DialogName.DELETE_PROFILE_NOTIFY),n()})},function(e,n){r._onError(new t.Error(t.SocialManagerError.FAIL_DELETE_PROFILE,e,n),null,function(){r._resolve()})})},function(e,n){r._onError(new t.Error(t.SocialManagerError.FAIL_DELETE_PROFILE,e,n),null,function(){r._resolve()})}))})},n.prototype._showProfileDialog=function(e,n,r){var i=this;this._dialogManagerImpl.showDialog(t.DialogName.CHOOSE_PROFILE,e,function(s,o){switch(s){case t.DialogEvent.OK:i._selectProfile(o),r?r(o):i._resolve();break;case t.DialogEvent.CANCEL:i._dialogManagerImpl.hideDialog(t.DialogName.CHOOSE_PROFILE),n&&n();break;case t.DialogEvent.PLAY_AS_GUEST:i._playAsGuest();break;case t.DialogEvent.ADD_PROFILE:i._createNewProfile(r);break;case t.DialogEvent.RENAME_PROFILE:i._renameProfile(o,function(){e.profiles=i._profiles,i._dialogManagerImpl.updateDialog(t.DialogName.CHOOSE_PROFILE,e)});break;case t.DialogEvent.DELETE_PROFILE:i._deleteProfile(o,function(){e.profiles=i._profiles,i._dialogManagerImpl.updateDialog(t.DialogName.CHOOSE_PROFILE,e)})}})},n.prototype._showLeaderboard=function(e){var n=this;this._getLeaderboardData(function(r){n._dialogManagerImpl.showDialog(t.DialogName.LEADERBOARD,{firstLeaderboard:e,profile:n._currentProfile,leaderboards:r},function(e,r){switch(e){case t.DialogEvent.TOURNAMENT_INFO:n._dialogManagerImpl.showDialog(t.DialogName.TOURNAMENT_INFO,{leaderboard:r},function(e){n._dialogManagerImpl.hideDialog(t.DialogName.TOURNAMENT_INFO)});break;case t.DialogEvent.OK:case t.DialogEvent.CANCEL:n._resolve()}})},function(r,i){n._onError(new t.Error(t.SocialManagerError.FAIL_RETRIEVE_LEADERBOARD,r,i),function(){n._showLeaderboard(e)},function(){n._deferred.reject()})})},n.prototype.showLeaderboardDialog=function(){var t=this;return this.isEnabled()?(this._deferred=new e.Deferred(this._api),this._currentProfile.isGuest?this._showProfileDialog({guestAllowed:!1,profiles:this._profiles,defaultProfileId:this._api.sdkSettings.cachedSettings.lastProfileId},function(){t._resolve()},function(e){t._showLeaderboard()}):this._showLeaderboard(),this._deferred):new e.Deferred(this._api,!0)},n.prototype._getLeaderboardData=function(e,t){var n=this;this._showLoadingBar(),this._leaderboardManager.getLeaderboardData(this._currentProfile,function(t){n._hideLoadingBar(),e(t)},t)},n.prototype._submitScore=function(e,n,r,i){var s=this;this._leaderboardManager.submitScore(this._currentProfile,e,n,r,function(e){e?(s._hideLoadingBar(),i?s._dialogManagerImpl.showDialog(t.DialogName.CONGRATULATIONS,{leaderboard:e,score:n,profile:s._currentProfile},function(n){switch(n){case t.DialogEvent.RENAME_PROFILE:s._renameProfile(s._currentProfile,function(){s._showLeaderboard(e)});break;default:s._showLeaderboard(e)}}):s._showLeaderboard(e)):s._resolve()},function(o,u){s._onError(new t.Error(t.SocialManagerError.FAIL_SUBMIT_SCORE,o,u),function(){s._submitScore(e,n,r,i)},function(){s._deferred.reject()})})},n.prototype._submitScorePreparation=function(e,n,r){var i=this;r?this._submitScore(e,n,r,!0):this._leaderboardManager.isQualifiedToTournament(this._currentProfile,e,n,function(s){if(s){i._hideLoadingBar();var o={score:n,profile:i._currentProfile};i._dialogManagerImpl.showDialog(t.DialogName.TOURNAMENT_QUALIFICATION,o,function(s){switch(s){case t.DialogEvent.RENAME_PROFILE:i._renameProfile(i._currentProfile,function(){o.profile=i._currentProfile,i._dialogManagerImpl.updateDialog(t.DialogName.TOURNAMENT_QUALIFICATION,o)});break;case t.DialogEvent.OK:i._dialogManagerImpl.hideDialog(),i._showLoadingBar(),i._submitScore(e,n,r,!1);break;case t.DialogEvent.TOURNAMENT_RULES:i._dialogManagerImpl.showDialog(t.DialogName.TOURNAMENT_RULES,{},function(){i._dialogManagerImpl.hideDialog(t.DialogName.TOURNAMENT_RULES)});break;default:i._dialogManagerImpl.hideDialog(),i._showLoadingBar(),i._submitScore(e,n,!0,!1)}})}else i._submitScore(e,n,r,!0)},function(s,o){i._onError(new t.Error(t.SocialManagerError.FAIL_SUBMIT_SCORE,s,o),function(){i._submitScorePreparation(e,n,r)},function(){i._deferred.reject()})})},n.prototype.submitScore=function(t,n,r){return this.isEnabled()?(this._deferred=new e.Deferred(this._api),this._showLoadingBar(),this._submitScorePreparation(t,n,r),this._deferred):new e.Deferred(this._api,!0)},n.prototype._getProfileIndex=function(e){for(var t=0;t<this._profiles.length;t++)if(this._profiles[t].profileId==e)return t;return-1},n.prototype._selectProfile=function(e){this._currentProfile=e,e.isGuest||this._api.sdkSettings.cachedSettings.lastProfileId!=e.profileId&&(this._api.sdkSettings.cachedSettings.lastProfileId=e.profileId,this._api.sdkSettings.cachedSettings.save()),this._onProfileSelectedCallback&&this._onProfileSelectedCallback(e)},n.prototype.onProfileSelected=function(e){this._onProfileSelectedCallback=e},n.prototype.removeGameData=function(n){var r=this;return this._deferred=new e.Deferred(this._api),this._storageManager.remove(this._currentProfile,n,function(){r._deferred.resolve()},function(e,n){r._onError(new t.Error(t.SocialManagerError.FAIL_SAVE_GAME_DATA,e,n)),r._deferred.reject()}),this._deferred},n.prototype.saveGameData=function(n){var r=this;return this._deferred=new e.Deferred(this._api),n.updateTournament(this._leaderboardManager.getActiveTournament(n.getGameMode())),this._storageManager.save(this._currentProfile,n._serialize(),n.getSlotName(),function(){r._deferred.resolve()},function(e,n){r._onError(new t.Error(t.SocialManagerError.FAIL_SAVE_GAME_DATA,e,n)),r._deferred.reject()}),this._deferred},n.prototype._loadGameData=function(e){var n=this;this._storageManager.load(this._currentProfile,e,function(r){var i=new t.GameData(e);i._deserialize(r),i.isWrongTournament(n._leaderboardManager.getActiveTournament(i.getGameMode()))?(i.disableTournament(),n._hideLoadingBar(),n._dialogManagerImpl.showDialog(t.DialogName.TOURNAMENT_WARNING,{},function(e){e==t.DialogEvent.OK?n._resolve(null):n._resolve(i)})):n._resolve(i)},function(r,i){n._onError(new t.Error(t.SocialManagerError.FAIL_LOAD_GAME_DATA,r,i),function(){n._loadGameData(e)},function(){n._deferred.reject()})})},n.prototype.loadGameData=function(t){return this._deferred=new e.Deferred(this._api),this._showLoadingBar(),this._loadGameData(t),this._deferred},n.prototype.synchronizeGameData=function(){var t=this;return this.isEnabled()?(this._deferred=new e.Deferred(this._api),this._showLoadingBar(),this._storageManager.synchronize(function(){t._resolve()},function(e,n){t._resolve()}),this._deferred):new e.Deferred(this._api,!0)},n._MAGIC_1="F4Df",n._MAGIC_2="TG4d",n._guestProfile={isGuest:!0,playerName:"GUEST"},n}();t.SocialManager=n})(t=e.Social||(e.Social={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t=function(){function e(){this._data=[]}return e.prototype.putString=function(e){var t="a".charCodeAt(0);for(var n=0;n<e.length;n++){var r=e.charCodeAt(n)-t;this.put(r,6)}},e.prototype.put=function(e,t){var n=this;if(t<=0)return;var r=function(e,t){while(t)t--,n._data.push(e>>t&1)};if(t>32){var i=e/4294967295|0,s=e%4294967295;r(i,t-32),r(s,32)}else r(e,t)},e.prototype.encode=function(e,t,n,r,i){this.put(2,6);var s=Math.round((new Date).getTime()/100);i?this.put(i,36):this.put(s,36),this.put(s,36),this.put(t.CMPId,12),this.put(t.CMPVersion,12),this.put(1,6);var o=e.getLanguage().toLowerCase();if(!o||typeof o!="string"||o.length!=2)o="en";this.putString(o),this.put(t.globalVendorListVersion,12),this.put(t.tcfPolicyVersion,6),this.put(1,1),this.put(0,1);var u=r.length;for(var a=0;a<u;a++)this.put(r[a]?1:0,1);this.put(0,12-u),u=n.length;for(var a=0;a<u;a++)this.put(n[a]?1:0,1);this.put(0,24-u),this.put(0,24),this.put(0,1),this.putString("uk");var f=0;for(var a=0;a<t.vendors.length;a++)t.vendors[a]>f&&(f=t.vendors[a]);this.put(f,16),this.put(1,1),this.put(t.vendors.length,12);for(var a=0;a<t.vendors.length;a++)this.put(0,1),this.put(t.vendors[a],16);this.put(0,16),this.put(1,1),this.put(0,12),this.put(0,12);while(this._data.length%8!==0)this._data.push(0);var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",c=0,h="";while(c<this._data.length){var p=0;for(var a=23;a>=0;a--)p|=this._data[c]<<a,c++;h+=l.charAt(p>>18&63)+l.charAt(p>>12&63)+l.charAt(p>>6&63)+l.charAt(p&63)}return h},e}();e.ConsentStringEncoder=t})(t=e.GDPR||(e.GDPR={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n,r;(function(e){e[e.none=0]="none",e[e.agree=1]="agree",e[e.expired=2]="expired",e[e.disagree=3]="disagree"})(n=t.GDPRStatus||(t.GDPRStatus={})),r=function(){function r(e){this._api=e,this._gdprString=null,this._status=n.none,this._options=[1,1,1,1,1]}return r.prototype.initialize=function(){var t=this;return this._deferred=new e.Deferred(this._api),typeof this._api.sdkSettings.gdpr!="undefined"?(this._settings=this._api.sdkSettings.gdpr,this._settings.enabled?this._settings.allowedCountry?this._api.requestCountryCode().always(function(e){t._settings.allowedCountry.indexOf(e)<0?(t._api.console.log("GDPR not allowed by country"),t._settings.enabled=!1):(t._loadData(),t._api.console.log("GDPR Status: "+n[t._status])),t._deferred.resolve()}):(this._loadData(),this._api.console.log("GDPR Status: "+n[this._status]),this._deferred.resolve()):this._deferred.resolve()):(this._settings={enabled:!1},this._deferred.resolve()),this._deferred},r.prototype._loadData=function(){var t=this._api.getStorage();this._gdprString=null,this._status=n.none;var i=t.getKey(r.STORAGE_KEY_NAME,null,!0);if(i){var s=new e.PackedStream;if(!s.init(i,!0))return;var o=s.readInteger();if(o!==this._settings.version)return!1;var u=this._getCurrentDay()-s.readInteger();console.log("expirationDays: "+u),this._status=s.readInteger(),this._createdTimeSec=s.readInteger();if(this._status==n.agree){this._gdprString=s.readString();for(var a=0;a<this._options.length;a++){var f=s.readBoolean();this._options[a]=f?1:0}u>this._settings.agreeLifeTime&&(this._gdprString=null,this._status=n.expired)}else if(u>this._settings.disagreeLifeTime)this._gdprString=null,this._status=n.expired;else{this._gdprString=s.readString();if(!this._gdprString)this._gdprString=this._generateString([0,0,0,0,0],null),console.log("GDPR: "+this._gdprString),this._saveData({updatedTimeDays:this._getCurrentDay(),status:n.disagree,gdprString:this._gdprString,options:[0,0,0,0,0],createdSec:Date.now()/1e3|0});else for(var a=0;a<this._options.length;a++)this._options[a]=0}}},r.prototype._saveData=function(t){var n=new e.PackedStream;n.write(this._settings.version),n.write(t.updatedTimeDays),n.write(t.status),this._createdTimeSec=t.createdSec,n.write(t.createdSec),n.write(t.gdprString);for(var i=0;i<t.options.length;i++)n.write(!!t.options[i]);this._api.getStorage().setKey(r.STORAGE_KEY_NAME,n.toString(!0),null,!0),this._status=t.status},r.prototype.isEnabled=function(){return this._settings.enabled},r.prototype.getString=function(){return this._settings.enabled&&this._gdprString?this._gdprString:""},r.prototype._generateString=function(e,n){var r=new t.ConsentStringEncoder;return r.encode(this._api,this._settings.vendors,[e[0],e[1],1,1,1,1,e[2],e[3],1,e[4]],[1,1],n?n*10:null)},r.prototype._getCurrentDay=function(){return Date.now()/864e5|0},r.prototype.getStatus=function(){return this._status},r.prototype.getOptions=function(){return this._options},r.prototype.setConsentData=function(t,r){if(!this._settings.enabled)return;switch(t){case e.IFrame.Messages.success:this._gdprString=this._generateString(r.options,this._status===n.agree?this._createdTimeSec:null),console.log("GDPR: "+this._gdprString),this._options=r.options,this._saveData({updatedTimeDays:this._getCurrentDay(),status:n.agree,gdprString:this._gdprString,options:r.options,createdSec:this._status==n.agree?this._createdTimeSec:Date.now()/1e3|0});break;case e.IFrame.Messages.disagree:this._gdprString=this._generateString([0,0,0,0,0],null),console.log("GDPR: "+this._gdprString),this._saveData({updatedTimeDays:this._getCurrentDay(),status:n.disagree,gdprString:this._gdprString,options:[0,0,0,0,0],createdSec:Date.now()/1e3|0});break;case e.IFrame.Messages.cancel:}},r.STORAGE_KEY_NAME="_tgh5_gdpr",r}(),t.GDPRManager=r})(t=e.GDPR||(e.GDPR={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function t(t){this._api=t,this._isConsentGiven=!1,this._declineTimestamp=0,this._runs=0,this._showTimeout=0,this._newUserShowDelay=0,this._declinesCount=0,this._isDialogShown=!1,this._sdkHome=e.System.getHomeDirectory()}return t.prototype.initialize=function(){var t=this;return this._deferred=new e.Deferred(this._api),typeof this._api.sdkSettings.brightData!="undefined"?(this._settings=this._api.sdkSettings.brightData,typeof this._settings.showTimeout!="undefined"&&(this._showTimeout=this._settings.showTimeout),typeof this._settings.newUserShowDelay!="undefined"&&(this._newUserShowDelay=this._settings.newUserShowDelay),this._settings.enabled&&this._settings.webosScriptUrl&&this._settings.brdScriptUrl?(this._loadData(),this._isDialogShown||(this._runs++,this._saveData()),this._isDialogShown||this._runs>this._newUserShowDelay?this._api.loadScript(this._sdkHome+"/"+this._settings.webosScriptUrl,e.Api.CONFIG_SCRIPT_TIMEOUT).done(function(){var n=t,r=function(t){if(t&&t.returnValue){var r=t.sdkVersion,i=n._settings.minWebosVersion;i&&n._compareVersion(r,i)?n._api.loadScript(n._sdkHome+"/"+n._settings.brdScriptUrl,e.Api.CONFIG_SCRIPT_TIMEOUT).done(function(){n._brdInit()}).fail(function(){n._deferred.resolve()}):n._deferred.resolve()}else n._deferred.resolve()},i=webOS.service.request("luna://com.webos.service.tv.systemproperty",{method:"getSystemInfo",parameters:{keys:["firmwareVersion","sdkVersion"]},onComplete:r})}).fail(function(){t._deferred.resolve()}):this._deferred.resolve()):this._deferred.resolve()):(this._settings={enabled:!1},this._deferred.resolve()),this._deferred},t.prototype.optIn=function(){this._settings.enabled&&brd_api.opt_in()},t.prototype.optOut=function(){this._settings.enabled&&(brd_api.opt_out(),this._isConsentGiven=!1,this._api.reportEvent(e.Reporting.EventCategory.App,e.Reporting.AppEvents.Brightdata,e.Reporting.BrightData.Cancel))},t.prototype.isConsentGiven=function(){return this._isConsentGiven},t.prototype.isEnabled=function(){return this._settings.enabled},t.prototype.setConsentData=function(t,n){if(!this._settings.enabled)return;switch(t){case e.IFrame.Messages.success:this.isConsentGiven()&&!n.options&&this.optOut();break;case e.IFrame.Messages.disagree:break;case e.IFrame.Messages.cancel:}},t.prototype._brdInit=function(){var t=this,n=!1,r=!1,i=function(){t._status=brd_api.get_status?brd_api.get_status():null,t._status?(t._api.console.log("BrightData status: "+t._status.consent),t._isConsentGiven=t._status.consent,t._status.consent&&(t._api.getAdsManager().disablePerType([e.Ads.Type.PreRoll,e.Ads.Type.MidRoll,e.Ads.Type.PostRoll]),t._api.getAdsManager().startPreloadForRewarded()),n&&r&&(t._status.consent?(t._declinesCount=0,t._api.reportEvent(e.Reporting.EventCategory.App,e.Reporting.AppEvents.Brightdata,e.Reporting.BrightData.Accept),t._api.reportEvent(e.Reporting.EventCategory.App,e.Reporting.AppEvents.Brightdata,e.Reporting.BrightData.Enabled)):(t._declineTimestamp=Date.now(),t._declinesCount++,t._api.reportEvent(e.Reporting.EventCategory.App,e.Reporting.AppEvents.Brightdata,e.Reporting.BrightData.Decline)),t._saveData(),t._deferred.resolve())):(t._api.console.error("BrightData sdk not initialized!"),t._deferred.resolve())},s=function(){n=!0,t._isDialogShown=!0,t._runs=0,t._saveData(),t._api.reportEvent(e.Reporting.EventCategory.App,e.Reporting.AppEvents.Brightdata,e.Reporting.BrightData.DialogShown)},o=function(){r=!0},u=function(){t._deferred.resolve()},a=function(){n||(!t._status.consent&&Date.now()-t._declineTimestamp>t._showTimeout*36e5&&(!t._settings.maxDeclinesCount||t._declinesCount<=t._settings.maxDeclinesCount)?t.optIn():(t._status.consent&&t._api.reportEvent(e.Reporting.EventCategory.App,e.Reporting.AppEvents.Brightdata,e.Reporting.BrightData.Enabled),t._deferred.resolve())),t._api.console.log("BrightData sdk version:"+t._status.ver)},f=this._api.getLanguage();this._settings.consentDialog.agreeBtn[f]||(f="en");var l={agree_text:this._settings.consentDialog.agreeBtn[f],disagree_text:this._settings.consentDialog.disagreeBtn[f],opt_out_instructions:this._settings.consentDialog.optOutInstructions[f],app_name:this._api.productSettings.title,benefit_txt:this._settings.consentDialog.benefitText[f],on_status_change:i,on_dialog_shown:s,on_dialog_closed:o,iframe:window.self!==window.top};brd_api.init(l,{on_failure:u,on_success:a})},t.prototype._saveData=function(){var n=new e.PackedStream;n.write(this._settings.version),n.write(this._declineTimestamp),n.write(this._runs),n.write(this._isDialogShown),n.write(this._declinesCount),this._api.getStorage().setKey(t.STORAGE_KEY_NAME,n.toString(!0),null,!0)},t.prototype._loadData=function(){var n=this._api.getStorage(),r=n.getKey(t.STORAGE_KEY_NAME,null,!0);if(r){var i=new e.PackedStream;if(!i.init(r,!0))return!1;var s=i.readInteger();if(s!==this._settings.version)return!1;this._declineTimestamp=i.readInteger(),this._runs=i.readInteger(),this._isDialogShown=i.readBoolean(),this._declinesCount=i.readInteger()}},t.prototype._compareVersion=function(e,t){if(typeof e!="string"||typeof t!="string")return!1;var n=e.split("."),r=t.split("."),i=Math.min(n.length,r.length),s=[],o=[];for(var u=0;u<i;++u){s[u]=parseInt(n[u],10),o[u]=parseInt(r[u],10);if(n[u]>r[u])return!0;if(n[u]<r[u])return!1}return s.length==o.length||s.length>=o.length},t.STORAGE_KEY_NAME="_tgh5_bright_data",t}();t.BrightDataManager=n})(t=e.BrightData||(e.BrightData={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(t){function a(t){var n=t.sdkSettings.reportingGameAnalytics,r=t.getProductSettings(t.productId);return!n||!r||!r.gameAnalytics?null:(r.gameAnalytics.enabled==undefined&&(r.gameAnalytics.enabled=n.enabled),r.gameAnalytics.analyticsScript==undefined&&(r.gameAnalytics.analyticsScript=n.analyticsScript),r.gameAnalytics.infoLogEnabled==undefined&&(r.gameAnalytics.infoLogEnabled=n.infoLogEnabled),r.gameAnalytics.enabled?new e.Reporting.Game.GameAnalyticsManager(t,r):(r.gameAnalytics.enabled=!1,null))}var n,r,i,s,o,u=function(){function e(){}return e.Business="Business",e.ADs="ADs",e.Resource="Resource",e.Progression="Progression",e.Error="Error",e.Design="Design",e}();t.EventType=u,n=function(){function e(){}return e.NoFill="NoFill",e.Unknown="Unknown",e}(),t.NoAdReason=n,r=function(){function e(){}return e.Sink="Sink",e.Source="Source",e}(),t.ResourceFlowType=r,i=function(){function e(){}return e.Start="Start",e.Fail="Fail",e.Complete="Complete",e}(),t.ProgressionStatus=i,s=function(){function e(){}return e.Debug="Debug",e.Info="Info",e.Warning="Warning",e.Error="Error",e.Critical="Critical",e}(),t.ErrorSeverity=s,t.createGameAnalyticsManager=a,o=function(){function t(e,t){this._api=e,this._settings=t.gameAnalytics,gameanalytics=null}return t.prototype.init=function(){var t=this,n=new e.Deferred(this._api);return function(e,t,n,r,i){var s="script",o="GameAnalytics";e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},r=t.createElement(s),i=t.getElementsByTagName(s)[0],r.async=1,r.src=n,i.parentNode.insertBefore(r,i)}(window,document,this._settings.analyticsScript),this._api.getSystem().getCustomerUID().always(function(e){t._api.getPaymentManager().isPayingUser().always(function(r){var i=t._api.productSettings.version;GameAnalytics("configureUserId",e),GameAnalytics("configureBuild",i?i:"unspecified"),GameAnalytics("setEnabledInfoLog",t._settings.infoLogEnabled?t._settings.infoLogEnabled:!1),GameAnalytics("configureAvailableResourceCurrencies",t._settings.currencies?t._settings.currencies:[]),GameAnalytics("configureAvailableResourceItemTypes",t._settings.itemTypes?t._settings.itemTypes:[]),GameAnalytics("configureAvailableCustomDimensions01",["paying","not_paying"]),GameAnalytics("configureAvailableCustomDimensions02",[t._api.getPlatformName()]),GameAnalytics("setCustomDimension01",r?"paying":"not_paying"),GameAnalytics("setCustomDimension02",t._api.getPlatformName()),GameAnalytics("initialize",t._settings.gameKey,t._settings.secretKey),GameAnalytics("addDesignEvent","application_start",null),n.resolve()})}),n},t.prototype.reportEvent=function(e){var t=this;if(!gameanalytics)return;this._api.getPaymentManager().isPayingUser().always(function(n){gameanalytics.GameAnalytics.setCustomDimension01(n?"paying":"not_paying");var r=!1;switch(e.eventType){case u.Business:typeof e.currency=="string"&&typeof e.amount=="number"&&e.amount%1===0&&typeof e.itemType=="string"&&typeof e.itemId=="string"&&typeof e.cartType=="string"&&(gameanalytics.GameAnalytics.addBusinessEvent(e.currency,e.amount,e.itemType,e.itemId,e.cartType),r=!0);break;case u.ADs:typeof e.adAction=="number"&&typeof e.adType=="number"&&typeof e.adProvider=="string"&&typeof e.adPlacement=="string"&&(gameanalytics.GameAnalytics.addAdEvent(e.adAction,e.adType,e.adProvider,e.adPlacement,e.duration,e.noAdReason),r=!0);break;case u.Resource:typeof e.currency=="string"&&typeof e.amount=="number"&&typeof e.itemType=="string"&&typeof e.itemId=="string"&&typeof e.flowType=="string"&&(gameanalytics.GameAnalytics.addResourceEvent(e.flowType,e.currency,e.amount,e.itemType,e.itemId),r=!0);break;case u.Progression:typeof e.progressionStatus=="string"&&typeof e.progression01=="string"&&(gameanalytics.GameAnalytics.addProgressionEvent(e.progressionStatus,e.progression01,e.progression02,e.progression03,e.score),r=!0);break;case u.Error:typeof e.severity=="string"&&typeof e.message=="string"&&(gameanalytics.GameAnalytics.addErrorEvent(e.severity,e.message),r=!0);break;case u.Design:typeof e.eventId=="string"&&(gameanalytics.GameAnalytics.addDesignEvent(e.eventId,e.value),r=!0)}if(r){var i="";for(var s in e)i+=s+": "+e[s]+", ";t._api.console.log("Game Analytics event: "+i)}})},t.prototype.reportSessionEnd=function(){if(!gameanalytics)return;gameanalytics.GameAnalytics.endSession()},t}(),t.GameAnalyticsManager=o})(n=t.Game||(t.Game={}))})(t=e.Reporting||(e.Reporting={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n,r=function(){function e(){}return e.adVendor="d1",e.adType="d2",e.adProvider="d3",e.creator="d4",e.userAgent="d5",e.adTagName="d6",e}();t.Dimensions=r,n=function(){function t(e){this._api=e}return t.prototype.initialize=function(e){var t=this;this._api.sdkSettings.pwAnalytics?this._settings=this._api.sdkSettings.pwAnalytics:this._settings={enabled:!1};if(!this._settings.enabled){e();return}this._isUserActivity=!0,this._inactiveTime=0,this._appName=encodeURIComponent(this._api.productSettings.title.replace(/&.*;/,"")),this._appType=this._api.productSettings.type||"",this._sid=this._api.getSystem().generateUUID(),this._api.getSystem().getCustomerUID().always(function(n){t._uuid=n,t.getPlatformForReporting(function(){t._track(t._settings.url+"/session?sid="+t._sid+"&uuid="+t._uuid+"&a="+t._appName+"&at="+t._appType+"&p="+t._platform);if(t._settings.pingInterval){var n=t._api.getSystem().getInactivityTimeout();t._pingInterval=setInterval(function(){n>0&&(t._inactiveTime+=t._settings.pingInterval,t._inactiveTime>n&&(t._isUserActivity=!1)),t._track(t._settings.url+"/ping?sid="+t._sid+"&uuid="+t._uuid+"&a="+t._appName+"&at="+t._appType+"&p="+t._platform+"&k="+(t._isUserActivity?"1":"0"))},t._settings.pingInterval)}e()})})},t.prototype.getPlatformForReporting=function(e){var t=this;this._platform=this._api.getPlatformName();if(!this._settings.overrides||!this._settings.overrides.platform)e();else{var n=this._settings.overrides.platform,r=!1;for(var i=0;i<n.length;i++)if(n[i].country){r=!0;break}var s=function(r){for(var i=0;i<n.length;i++){if(n[i].country&&n[i]["country"]==r){t._platform=n[i].result,e();return}if(n[i].value&&n[i]["value"]==t._platform){t._platform=n[i].result,e();return}}e()};r?this._api.requestCountryCode().always(function(e){s(e)}):s()}},t.prototype.reportAdErrorEvent=function(t,n){if(!this._settings.enabled)return;var i={};i[r.adVendor]=n.vendorName,i[r.adType]=n.event,i[r.adProvider]=n.name,window&&window.navigator&&(i[r.userAgent]=encodeURIComponent(window.navigator.userAgent)),this.reportEvent(e.Reporting.EventCategory.Errors,e.Reporting.Errors.videoError,t,0,i)},t.prototype.reportAdEvent=function(t,n,i,s){if(!this._settings.enabled)return;n=n||{};if(s&&t==e.Reporting.Ads.impression){var o=0;s&&(o=parseFloat(s),isNaN(o)&&(o=0)),s=o*10|0}var u={};u[r.adVendor]=n?n.vendorName:"",u[r.creator]=n?n.creator:"",u[r.adType]=i,u[r.adProvider]=n?n.name:"",u[r.adTagName]=n?n.adTagName:"";var a=n&&n.name?n.name:"";this.reportEvent(e.Reporting.EventCategory.Ads,t,a,s,u)},t.prototype._remapDimensions=function(t){if(!t||!this._settings.enabled)return null;var n={};return t[e.Reporting.Dimensions.adType]&&(n[r.adType]=t[e.Reporting.Dimensions.adType]),t[e.Reporting.Dimensions.adVendor]&&(n[r.adVendor]=t[e.Reporting.Dimensions.adVendor]),t[e.Reporting.Dimensions.adProvider]&&(n[r.adProvider]=t[e.Reporting.Dimensions.adProvider]),t[e.Reporting.Dimensions.creator]&&(n[r.creator]=t[e.Reporting.Dimensions.creator]),t[e.Reporting.Dimensions.adTagName]&&(n[r.adTagName]=t[e.Reporting.Dimensions.adTagName]),t[e.Reporting.Dimensions.userAgent]&&(n[r.userAgent]=t[e.Reporting.Dimensions.userAgent]),n},t.prototype.reportEvent=function(e,t,n,r,i){if(!this._settings.enabled)return;if(this._settings.bannedEvents&&this._settings.bannedEvents[e]&&this._settings.bannedEvents[e].indexOf(t)>=0)return;var s=this._settings.url+"/event?a="+this._appName+"&at="+this._appType+"&p="+this._platform;s+="&ec="+encodeURIComponent(e)+"&ea="+encodeURIComponent(t),n&&(s+="&el="+encodeURIComponent(n)),r&&(s+="&ev="+r);for(var o in i)i.hasOwnProperty(o)&&i[o]&&(s+="&"+o+"="+encodeURIComponent(i[o]));this._api.pendingRequests(1),this._track(s)},t.prototype.onUserActivity=function(){if(!this._settings.enabled)return;this._inactiveTime=0,this._isUserActivity=!0},t.prototype.close=function(){this._settings.enabled&&this._track(this._settings.url+"/close?sid="+this._sid)},t.prototype._track=function(e){var t=this,n=new XMLHttpRequest;e=e+"&r="+Date.now(),n.open("GET",e,!0),n.onreadystatechange=function(r){n.readyState===4&&(t._api.pendingRequests(-1),n.status!==200&&t._api._reportManager&&t._api._reportManager.reportErrorEvent("pwanalytics","error: "+n.statusText+" : "+n.status+", "+encodeURIComponent(e)))},n.send(null)},t}(),t.PWAnalyticsManager=n})(t=e.PWAnalytics||(e.PWAnalytics={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function t(e){this._api=e,this._gdprOptions=[1,1,1,1,1],this._brdOptions=[1]}return t.prototype.initialize=function(t,n){return this._deferred=new e.Deferred(this._api),this._gdprManager=t,this._brightDataManager=n,this._settings=this._api.sdkSettings.consent,this._gdprSettings=this._api.sdkSettings.gdpr,this._brightDataSettings=this._api.sdkSettings.brightData,this._deferred.resolve(),this._deferred},t.prototype.isEnabled=function(){return this._gdprManager.isEnabled()||this._brightDataManager.isEnabled()&&this._brightDataManager.isConsentGiven()},t.prototype._showDialog=function(t){var n=this,r=new e.IFrame.Message(this._api);r.request(e.IFrame.Messages.disableAutoFocus,{enabled:!0},!0),this._api.processLater(function(){console.log("Focus CONSENT iFrame"),n._iFrame.style.display="block",n._iFrame.focus(),n._requestMessage.request(e.IFrame.Messages.request,{settings:n._settings,language:n._api.getLanguage(),options:n._gdprOptions.concat(n._brdOptions)})})},t.prototype._hideDialog=function(){var t=new e.IFrame.Message(this._api);t.request(e.IFrame.Messages.disableAutoFocus,{enabled:!1},!0),this._iFrame.style.display="none",this._api.processLater(function(){window.focus()})},t.prototype.requestDialog=function(t){var n=this;this._deferred=new e.Deferred(this._api);if((!this._settings||!this._settings.url)&&(!this._gdprSettings||!this._gdprSettings.url))return this._deferred.resolve(),this._deferred;!this._gdprSettings||!this._gdprSettings.enabled||this._gdprManager.getString()&&this._gdprManager.getStatus()===e.GDPR.GDPRStatus.agree&&!t||this._gdprManager.getStatus()===e.GDPR.GDPRStatus.disagree&&!t?this._gdprOptions=[-1,-1,-1,-1,-1]:this._gdprOptions=this._gdprManager.getOptions(),!this._brightDataSettings||!this._brightDataManager.isEnabled()||!this._brightDataManager.isConsentGiven()?this._brdOptions=[-1]:this._brdOptions=[1];if(this._gdprOptions.every(function(e,t,n){return e===-1})&&(this._brdOptions[0]===-1||!t))return this._deferred.resolve(),this._deferred;if(!this._iFrame){this._iFrame=document.createElement("iframe"),this._iFrame.id="iframe"+Math.random(),this._iFrame.className="video-ad-iframe",this._iFrame.name=this._iFrame.id,this._iFrame.style.display="none";var r=this._settings&&this._settings.url?this._settings.url:this._api.sdkSettings.gdpr.url;this._iFrame.src=this._api.resolvePath(r),document.body.appendChild(this._iFrame);var i=function(){n._requestMessage=new e.IFrame.Message(n._api,n._iFrame.contentWindow),n._requestMessage.response=function(e,t){n._hideDialog(),n._gdprManager.setConsentData(e,{options:t.options.slice(0,5)}),n._brightDataManager.setConsentData(e,{options:t.options[5]}),n._deferred.resolve()},n._showDialog(t)},s=function(t,r){t===e.IFrame.Messages.onLoaded&&r.name===n._iFrame.id&&(n._onLoadMessage.suspend(),i())};this._onLoadMessage=new e.IFrame.MessageListener(this._api,s)}else this._showDialog(t);return this._deferred},t}();t.ConsentManager=n})(t=e.Consent||(e.Consent={}))}(TGH5||(TGH5={})),function(e){var t=function(){function e(){}return e.local="local",e.remote="remote",e.both="both",e}(),n=function(){function n(r){var i=this;this._api=r,this._useLocalStorage=!1,this._useFileSystem=!1,this._useCookiesStorage=!1,this._useFakeCookies=!1,this._enabled=!0,this._currentVersion=n._version[n._version.length-1];var s=r.sdkSettings.storageType;this.storageLocation=r.sdkSettings.storageLocation;var o=r.getProductSettings(r.productId);o&&o.storageLocation&&(this.storageLocation=o.storageLocation);if(!this.storageLocation||!r.getBaasManager().isEnabled())this.storageLocation=t.local;try{s!=="cookie"&&s!=="fakeCookie"&&s!=="fileSystem"&&typeof window.localStorage!="undefined"&&window.localStorage&&typeof window.localStorage.setItem=="function"&&typeof window.localStorage.getItem=="function"?(this._useLocalStorage=!0,this.clearAll=function(){window.localStorage.clear()},this.setKey=function(t,n,r){try{return window.localStorage.setItem(t,n),r&&r(!0),!0}catch(s){i._api.reportErrorEvent(e.Reporting.Errors.localStorageError,"setKey="+t+", "+s)}return r&&r(!1),!1},this.getKey=function(t,n){var r;try{r=window.localStorage.getItem(t)||null}catch(s){i._api.reportErrorEvent(e.Reporting.Errors.localStorageError,"getGey="+t+", "+s),r=null}return n&&n(r),r},this.delKey=function(t,n){try{localStorage.removeItem(t)}catch(r){return i._api.reportErrorEvent(e.Reporting.Errors.localStorageError,"delKey="+t+", "+r),n&&n(!1),!1}return n&&n(!0),!0}):s!=="fakeCookie"&&s!=="fileSystem"&&typeof document.cookie!="undefined"&&document.cookie!==null?(this._useCookiesStorage=!0,r.sdkSettings.cookieStorageRestrictions&&r.sdkSettings.cookieStorageRestrictions.enabled?(this.cookieRestrictions=r.sdkSettings.cookieStorageRestrictions,typeof this.cookieRestrictions.maxTotalSize=="undefined"&&(this.cookieRestrictions.maxTotalSize=n._DEFAULT_MAX_COOKIE_TOTAL_SIZE),typeof this.cookieRestrictions.maxItemSize=="undefined"&&(this.cookieRestrictions.maxItemSize=n._DEFAULT_MAX_COOKIE_ITEM_SIZE)):this.cookieRestrictions={enabled:!1},this.clearAll=function(e){document.cookie.split(";").forEach(function(t){var n=t.trim().split("=")[0];if(e&&e.indexOf(n)<0){var r="/";i._api.sdkSettings.cookieLocalPath&&n.indexOf("lp_v")===0&&(r=i._cookieGetLocalPath()),document.cookie=n+"=;"+"expires=Thu, 01 Jan 1970 00:00:00 UTC;path="+r}})},this.setKey=function(t,r,s,o){try{if(!t)return s&&s(!1),!1;var u="/",a=t;i._api.sdkSettings.cookieLocalPath===!0&&!o&&(u=i._cookieGetLocalPath(),a.indexOf("lp_")<0&&(a="lp_"+t),i.delKey(t,null,!0)),r=escape(r);if(i.cookieRestrictions&&i.cookieRestrictions.enabled&&typeof r=="string"&&r.length>i.cookieRestrictions.maxItemSize&&i.cookieRestrictions.maxItemSize>0)return i._api.reportEvent(e.Reporting.EventCategory.Errors,e.Reporting.Errors.cookieError,"Size of saved data greater than "+i.cookieRestrictions.maxItemSize,r.length),s&&s(!1),!1;document.cookie=escape(a)+"="+r+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path="+u,t===e.CachedSettings.STORAGE_KEY_NAME&&i._api.sdkSettings.crossDomainStorageKeys&&i._api.sdkSettings.crossDomainStorageKeys.indexOf(e.CachedSettings.STORAGE_KEY_NAME)>=0&&(document.cookie=n.CROSS_DOMAIN_TS_KEY+"="+Date.now()+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")}catch(f){return i._api.reportErrorEvent(e.Reporting.Errors.cookieError,"setKey="+t+", "+f),s&&s(!1),!1}return s&&s(!0),!0},this.getKey=function(e,t,n){var r=null;if(i._api.sdkSettings.cookieLocalPath===!0&&!n){var s="lp_"+e;r=i._getCookieByKey(s),r||(r=i._getCookieByKey(e))}else r=i._getCookieByKey(e);return t&&t(r),r},this.delKey=function(t,n,r){try{if(i._api.sdkSettings.cookieLocalPath===!0&&!r){var s=t;s&&s.indexOf("lp_")!=0&&(s="lp_"+t),i._hasCookie(s)&&(document.cookie=s+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path="+i._cookieGetLocalPath())}i._hasCookie(t)&&(document.cookie=t+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/")}catch(o){return i._api.reportErrorEvent(e.Reporting.Errors.cookieError,"delKey="+t+", "+o),n&&n(!1),!1}return n&&n(!0),!0}):s!=="fakeCookie"&&(window.requestFileSystem||window.webkitRequestFileSystem)?(this._useFileSystem=!0,this.clearAll=function(){i._api.console.log("Clear All for the FileSystem not implement")},this.setKey=function(t,r,s){var o=i,u=window.requestFileSystem||window.webkitRequestFileSystem;return u(window.TEMPORARY,n._FILE_SYSTEM_SIZE,function(n){var i=function(){n.root.getFile(t,{create:!0},function(n){n.createWriter(function(n){var i=new Blob([r]);n.addEventListener("writeend",function(){s&&s(!0)},!1),n.addEventListener("error",function(n){o._api.reportErrorEvent(e.Reporting.Errors.fileSystemError,"setKey, fileWriter.write, "+t+", "+n),s&&s(!1)},!1),n.write(i)},function(n){o._api.reportErrorEvent(e.Reporting.Errors.fileSystemError,"setKey, createWriter, "+t+", "+n),s&&s(!1)})},function(n){o._api.reportErrorEvent(e.Reporting.Errors.fileSystemError,"setKey, getFile, "+t+", "+n),s&&s(!1)})};n.root.getFile(t,{},function(e){e.remove(i,i)},i)},function(n){o._api.reportErrorEvent(e.Reporting.Errors.fileSystemError,"setKey, requestFileSystem, "+t+", "+n),s&&s(!1)}),!0},this.getKey=function(t,r){var s=i,o=window.requestFileSystem||window.webkitRequestFileSystem;return o(window.TEMPORARY,n._FILE_SYSTEM_SIZE,function(e){e.root.getFile(t,{create:!1},function(e){e.file(function(e){var t=new FileReader;t.onloadend=function(e){r&&r(e&&e.target&&e.target.result?e.target.result:null)},t.readAsText(e)},function(e){r&&r(null)})},function(){r&&r(null)})},function(n){s._api.reportErrorEvent(e.Reporting.Errors.fileSystemError,"getKey, requestFileSystem, "+t+", "+n),r&&r(null)}),null},this.delKey=function(t,r){var s=i,o=window.requestFileSystem||window.webkitRequestFileSystem;return o(window.TEMPORARY,n._FILE_SYSTEM_SIZE,function(e){e.root.getFile(t,{create:!1},function(e){e.remove(function(){r&&r(!0)},function(){r&&r(!1)})},function(){r&&r(!1)})},function(n){s._api.reportErrorEvent(e.Reporting.Errors.fileSystemError,"delKey, requestFileSystem, "+t+", "+n),r&&r(!1)}),null}):(this._useCookiesStorage=!0,this._useFakeCookies=!0,this._fakeCookies={},this.setKey=function(e,t,n){return i._fakeCookies[e]=t,n&&n(!0),!0},this.getKey=function(e,t){var n=i._fakeCookies[e]||null;return t&&t(n),n},this.delKey=function(e,t){return typeof i._fakeCookies[e]!="undefined"&&(i._fakeCookies[e]=undefined),t&&t(!0),!0}),this._api.sdkSettings.emulateLocalStorage===!0&&this._useCookiesStorage&&Object.defineProperty(window,"localStorage",{value:{setItem:function(e,t){i.setKey(e,t,null,!1)},getItem:function(e){return i.getKey(e,null,!1)},removeItem:function(e){i.delKey(e,null,!1)},clear:function(){i.clearAll()}},configurable:!0,enumerable:!0,writable:!1});if(this._api.sdkSettings.crossDomainStorageKeys)for(var u=0;u<this._api.sdkSettings.crossDomainStorageKeys.length;u++){var a=this._api.sdkSettings.crossDomainStorageKeys[u],f=!1,l;a==e.CachedSettings.STORAGE_KEY_NAME&&(f=!0,l=e.Api.locationGetParam(n.CROSS_DOMAIN_TS_KEY));var c=e.Api.locationGetParam(a);if(c){c=decodeURIComponent(c);var h=this.getKey(a,null,!0),p=null;f&&(p=this.getKey(n.CROSS_DOMAIN_TS_KEY,null,!0)),h!==c&&(!f||p&&l&&l>p||!l&&!p||l&&!p?(this._api.console.log("User Cross Domain key from URL: "+a),this.setKey(a,c,null,!0)):this._api.console.log("User Cross Domain key from Cookie: "+a))}}}catch(d){r.console.log(d),this._enabled=!1,this.setKey=function(e,t,n){return n&&n(!0),!0},this.getKey=function(e,t){return t&&t(null),null},this.delKey=function(e,t){return t&&t(!0),!0}}}return n.prototype.checkCookieRestrictions=function(){this.cookieRestrictions&&this.cookieRestrictions.enabled&&document.cookie.length>this.cookieRestrictions.maxTotalSize&&this.cookieRestrictions.maxTotalSize>0&&(this._api.reportEvent(e.Reporting.EventCategory.Errors,e.Reporting.Errors.cookieError,"Cookie total size greater than "+this.cookieRestrictions.maxTotalSize,document.cookie.length),this.cookieRestrictions.autoClear&&this.clearAll(n._SYSTEM_ITEM_NAMES))},n.prototype.isEnabled=function(){return this._enabled},n.prototype._hasCookie=function(e){return RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},n.prototype._getCookieByKey=function(t){if(!t||!this._hasCookie(t))return null;var n;try{n=unescape((document.cookie||"").replace(RegExp("(?:^|.*;\\s*)"+escape(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")||null)}catch(r){this._api.reportErrorEvent(e.Reporting.Errors.cookieError,"getKey="+t+", "+r),n=null}return n},n.prototype._cookieGetLocalPath=function(){var e="/";try{var t=(location.href||"").split("?");if(t.length>0){var n=t[0].split("/");if(n.length>0){var r=n.length-1;n[r].indexOf(".htm")>=0&&r--,r>=0&&(e="./"+n[r])}}}catch(i){}return e},n.prototype.isLocalStorage=function(){return this._useLocalStorage},n.prototype.isFileSystem=function(){return this._useFileSystem},n.prototype.isCookie=function(){return this._useCookiesStorage},n.prototype._getSaveDataKeyName=function(e,t){return t||(t=this._currentVersion),t+"_"+this._api.productId+"_"+e},n.prototype.getStorageName=function(){return this.isLocalStorage()?"localStorage":this.isFileSystem()?"fileSystem":this._useFakeCookies?"fakeCookie":"cookie"},n.prototype._saveToServer=function(e,t,n){var r;this._api.console.debug("Saved "+t.length+" bytes to Remote Server"),this._api.getBaasManager().saveAccountAppData((r={},r[e]=t,r),!0).done(function(){n&&n(!0)}).fail(function(){n&&n(!1)})},n.prototype._loadFromServer=function(e,t){this._api.getBaasManager().loadAccountAppData().done(function(n){t&&t(!1,n?n[e]:null)}).fail(function(){t&&t(!0,null)})},n.prototype.save=function(e,n,r,i){if(!this.isStorageAllowed())return r&&r(!0),!0;this.isFileSystem()||this.removeOldVersions(n);try{var s=Date.now();e.write(s);var o=e.toString(!0),u=0,a=!1,f=function(e){u--,e||(a=!0),u<=0&&r&&r(!a)};return this.storageLocation!=t.local&&(u++,this._saveToServer(n,o,f)),this.storageLocation!=t.remote&&(u++,this._api.console.debug("Saved "+o.length+" bytes to "+this.getStorageName()),this.setKey(this._getSaveDataKeyName(n),o,f,i)||(a=!0)),!a}catch(l){return r&&r(!1),!1}},n.prototype.forceRemove=function(e,t){t||(t=this._currentVersion),this.delKey(this._getSaveDataKeyName(e,t))},n.prototype.remove=function(e,t){if(!this.isStorageAllowed())return;this.forceRemove(e,t)},n.prototype.removeOldVersions=function(e){for(var t=0;t<n._version.length-1;t++)this.remove(e,n._version[t])},n.prototype.isStorageAllowed=function(){return!this._enabled||this._api.getPurchasedStatus()==e.Payment.ProductStatus.Free||this._api.getPurchasedStatus()==e.Payment.ProductStatus.Demo?!1:!0},n.prototype.clearStorage=function(){if(!this.isStorageAllowed())return;this.clearAll()},n.prototype.load=function(r,i){var s=this;if(!this.isStorageAllowed())return i&&i(null),null;try{if(this.isFileSystem())return this.getKey(this._getSaveDataKeyName(r),function(t){if(t){var n=new e.PackedStream;n.init(t,!0)||(s._api.reportErrorEvent(e.Reporting.Errors.fileSystemError,"Bad CRC: "+s._getSaveDataKeyName(r)),n=null),i&&i(n)}else i&&i(null)}),null;var o=null,u=null,a=null,f=null,l=!1,c=function(){o&&(u=new e.PackedStream,u.init(o,!0)||(s._api.reportErrorEvent(s.isLocalStorage()?e.Reporting.Errors.localStorageError:e.Reporting.Errors.cookieError,"Bad CRC: "+s._getSaveDataKeyName(r)),s.remove(r),u=null)),a&&(f=new e.PackedStream,f.init(a,!0)||(s._api.reportErrorEvent(e.Reporting.Errors.remoteStorageError,"Bad CRC: "+s._getSaveDataKeyName(r)),f=null));var t=null;if(u&&f&&!l){var n=u.readLastNumber(),c=f.readLastNumber();n!=null&&c!=null&&(s._api.console.log("LocalTS: "+n+", remoteTS: "+c),n>c?t=u:t=f)}return!t&&u&&(t=u),!t&&f&&(t=f),i&&i(t),t};o=this.getKey(this._getSaveDataKeyName(r));if(o===null)for(var h=n._version.length-2;h>=0;h--){o=this.getKey(this._getSaveDataKeyName(r,n._version[h]));if(o!==null){l=!0;break}}if(this.storageLocation===t.local)return c();this._loadFromServer(r,function(e,n){if(e&&s.storageLocation==t.remote){s._enabled=!1,s._api.console.error("Remote only save not supported, IAP will be disabled");var r=s._api.getPaymentManager();return r&&r.disable(),i&&i(null),null}a=n,c()})}catch(p){return i&&i(null),null}},n._FILE_SYSTEM_SIZE=6144,n._DEFAULT_MAX_COOKIE_TOTAL_SIZE=20480,n._DEFAULT_MAX_COOKIE_ITEM_SIZE=4096,n._SYSTEM_ITEM_NAMES=[e.CachedSettings.STORAGE_KEY_NAME,e.BrightData.BrightDataManager.STORAGE_KEY_NAME,e.System.DEVICE_STORAGE_KEY_NAME,e.GDPR.GDPRManager.STORAGE_KEY_NAME],n.CROSS_DOMAIN_TS_KEY="_tgh5_v1_ts",n._version=["v2","v3"],n}();e.Storage=n}(TGH5||(TGH5={})),function(e){var t;(function(t){var n=function(){function t(){}return t.prototype.number_create=function(){function u(e){var t=0,n=1;for(var r=e.length-1;r>=0;r--){var o=e[r],u=s[o];u*=n,t+=u,n*=i}return t}function a(e){if(e===0)return t[0];var n=[];while(e!==0){var r=e%i,s=t[r];n.push(s),e-=r,e/=i}return n.reverse().join("")}function f(e){return e.split("").reverse().join("")}function l(e){if(e<0)return"-"+l(-e);var t=(e+"").split("."),n=t[0],r=t[1];return r?(n=c(n),r=f(r),r=c(r),n+"."+r):a(e)}function c(e){return e[0]===":"?-this.s_to_num(e.substr(1)):this.s_to_int(e)+""}function h(e){return e[0]===":"?-this.s_to_num(e.substr(1)):u(e)+""}function p(e){if(e[0]==="-")return-p(e.substr(1));var t=e.split("."),n=t[0],r=t[1];return r?(n=h(n),r=h(r),r=f(r),+(n+"."+r)):u(n)}var e={},t="";for(var n=0;n<10;n++){var r=String.fromCharCode(48+n);t+=r}for(var n=0;n<26;n++){var r=String.fromCharCode(65+n);t+=r}for(var n=0;n<26;n++){var r=String.fromCharCode(97+n);t+=r}var i=t.length,s={};for(var n=0;n<i;n++){var o=t[n];s[o]=n}return e.s_to_int=u,e.int_to_s=a,e.num_to_s=l,e.int_str_to_s=c,e.s_to_num=p,e},t.prototype.encode_create=function(){function n(t){var n="n|"+e.num_to_s(t);return n}function r(t){return t=t.replace("n|",""),e.s_to_num(t)}function i(t){return typeof t=="number"?t:e.s_to_int(t)}function s(e){return e?"b|T":"b|F"}function o(e){switch(e){case"b|T":return!0;case"b|F":return!1}return!!e}function u(e){var t=e[0]+e[1];switch(t){case"b|":case"o|":case"n|":case"a|":case"s|":e="s|"+e}return e}function a(e){var t=e[0]+e[1];return t==="s|"?e.substr(2):e}var e=this.number_create(),t={};return t.encodeNum=n,t.decodeNum=r,t.decodeKey=i,t.encodeBool=s,t.decodeBool=o,t.encodeStr=u,t.decodeStr=a,t},t.prototype.decodeObject=function(e,t){if(t==="o|")return{};var n={},r=t.split("|"),i=r[1],s=this.decode(e,i),o=r.length;o-2===1&&!Array.isArray(s)&&(s=[s]);for(var u=2;u<o;u++){var a=s[u-2],f=r[u];f=this.decode(e,f),n[a]=f}return n},t.prototype.decodeArray=function(e,t){if(t==="a|")return[];var n=t.split("|"),r=n.length-1,i=Array(r);for(var s=0;s<r;s++){var o=n[s+1];o=this.decode(e,o),i[s]=o}return i},t.prototype.decode=function(e,t){if(t===""||t==="_")return null;var n=this.encode_create(),r=n.decodeKey(t),i=e[r];if(i===null)return i;switch(typeof i){case"undefined":return i;case"number":return i;case"string":var s=i[0]+i[1];switch(s){case"b|":return n.decodeBool(i);case"o|":return this.decodeObject(e,i);case"n|":return n.decodeNum(i);case"a|":return this.decodeArray(e,i);default:return n.decodeStr(i)}}return null},t.decompress=function(n){t._instance||(t._instance=new e.BaaS.DecompressJSON);var r=n[0],i=n[1];return t._instance.decode(r,i)},t._instance=null,t}();t.DecompressJSON=n})(t=e.BaaS||(e.BaaS={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n,r,i,s,o,u;(function(e){e[e.BAAS_DISABLED=50]="BAAS_DISABLED",e[e.FAIL_TO_RETRIEVE_DEVICE_ID=51]="FAIL_TO_RETRIEVE_DEVICE_ID",e[e.REQUEST_TIMEOUT=51]="REQUEST_TIMEOUT",e[e.NETWORK_ERROR=52]="NETWORK_ERROR",e[e.FAIL_PARSE_RESPONSE=53]="FAIL_PARSE_RESPONSE",e[e.FAIL_REQUEST_API=54]="FAIL_REQUEST_API",e[e.BAD_WORD=100]="BAD_WORD",e[e.EXISTING_ENTITY=200]="EXISTING_ENTITY",e[e.INVALID_ENTITY=300]="INVALID_ENTITY",e[e.NOT_FOUND_ENTITY=400]="NOT_FOUND_ENTITY",e[e.INUSE_ENTITY=500]="INUSE_ENTITY",e[e.BLOCKED_ENTITY=600]="BLOCKED_ENTITY",e[e.ACCESS_DENIED=700]="ACCESS_DENIED"})(n=t.ErrorCodes||(t.ErrorCodes={})),r=function(){function e(e,t){this.code=e,typeof t=="string"?this.message=t:t&&(this.message=t.en||JSON.stringify(t))}return e}(),t.Error=r,function(e){e[e.VIRTUAL=0]="VIRTUAL",e[e.REAL=1]="REAL",e[e.GAME=2]="GAME"}(i=t.EventType||(t.EventType={})),function(e){e[e.SUCCESS=200]="SUCCESS",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.BAD_REQUEST=400]="BAD_REQUEST"}(s||(s={})),o={Init:{uid:"init",url:"/init"},AccountAuthorize:{uid:"account_authorize",mandatory:["uuids","appUid","deploymentUid","platformUid"],optional:["appDataKeys","countryCode","additionalAppDataKeys"]},ProgressSubmit:{uid:"progress_submit",mandatory:["userId","appModeId","score"],optional:["submitToRealEvents","eventIds","exp","level"]},LbsGet:{uid:"lbs_get",optional:["userId","closedLbsCount","eventIds","appModeIds","lbIds","lbRecordsRequired"]},AppSave:{uid:"data_save",mandatory:["appId","userId","data"]},AppLoad:{uid:"data_load",mandatory:["appId","userId","keys"]},ShopsGet:{uid:"shops_get",optional:["ids","appId"]},ItemsGet:{uid:"items_get",optional:["ids"]},PurchasesSubmit:{uid:"purchase_submit",mandatory:["userId","itemId","shopId"]},PurchasesGet:{uid:"purchases_get",mandatory:["userId","shopIds","lastPurchasedItemsCount"],optional:["purchaseStartDate","purchaseEndDate"]},AccountCreateUser:{uid:"account_createuser",mandatory:["id","username"],optional:["avatarId","countryCode"]},AccountChangeUser:{uid:"account_changeuser",mandatory:["id","userId","appId"],optional:["appDataKeys"]},SaveUserBalance:{uid:"data_save",mandatory:["userId","appId","data"]},UserUpdate:{uid:"data_save",mandatory:["userId"],optional:["username","selectedAvatars","countryCode"]},BadWordsCheck:{uid:"badwords_check",mandatory:["text"],optional:[]},AccountDataSave:{uid:"data_save",mandatory:["accountId"],optional:["purchasedItems"]},ClearAccountData:{uid:"data_delete",mandatory:["accountId"],optional:[]},ClearAccountAppData:{uid:"data_delete",mandatory:["accountId","appId"],optional:[]},ClearUserData:{uid:"data_delete",mandatory:["userId"],optional:[]},ClearAppData:{uid:"data_delete",mandatory:["userId","appId"],optional:["keys"]},AccountAppDataSave:{uid:"data_save",mandatory:["accountId","appId"],optional:[]},UserDelete:{uid:"user_delete",mandatory:["accountId"]},AccountDelete:{uid:"account_delete",mandatory:["id"]}},u=function(){function i(e){var t=this,n;this._api=e,this._requestTimeout=null,this._settings=this._api.sdkSettings.baasSettings;if(!this._settings)this._settings={enabled:!1};else if((n=this._api.productSettings)===null||n===void 0?void 0:n.baasSettings){var r=this._api.productSettings.baasSettings;r.enabled?(this._settings.enabled=!0,["url","errorMessageDialog","deployment","certificate","publicKey","appDataKeys","additionalAppDataKeys"].forEach(function(e){r[e]&&(t._settings[e]=r[e])})):this._settings.enabled=!1}}return i.prototype.showErrorDialog=function(t){if(this._settings.errorMessageDialog){var n=this._settings.errorMessageDialog.text;for(var r in n)n.hasOwnProperty(r)&&(n[r]+="<br>"+t.code+" : "+t.message);var i=new e.MessageDialog(this._api,this._settings.errorMessageDialog);i.create(),i.show().always(function(){i.hide(),i.suspend()})}},i.prototype.isEnabled=function(){return this._settings.enabled},i.prototype.getAccountId=function(){var e;return(e=this._authorizeData)===null||e===void 0?void 0:e.account.id},i.prototype.getAccount=function(){var e;return(e=this._authorizeData)===null||e===void 0?void 0:e.account},i.prototype.getApp=function(){var e;return(e=this._authorizeData)===null||e===void 0?void 0:e.platform.deployment.app},i.prototype.getAppMode=function(e){var t=this.getApp();if(t&&t.modes){if(!e)return t.modes[0];for(var n=0;n<t.modes.length;n++)if(t.modes[n].uid===e)return t.modes[n]}return null},i.prototype.getEvents=function(e){var t=this.getAppMode(e);return t?t.events:null},i.prototype.getShops=function(){var e=this.getApp();return e?e.shops:null},i.prototype.getServiceConfig=function(){var e;return(e=this._authorizeData)===null||e===void 0?void 0:e.config},i.prototype.getCurrentUserId=function(){var e,t=(e=this._authorizeData)===null||e===void 0?void 0:e.account;return t&&t.users?t.users[0].id:null},i.prototype.getCurrentUser=function(){var e,t=(e=this._authorizeData)===null||e===void 0?void 0:e.account;return t&&t.users?t.users[0]:null},i.prototype.saveAccountData=function(t,n){var r=this,i=new e.Deferred(this._api),s={};return t&&(s.purchasedItems=t),n&&(s=this._api.extend(s,n)),this._sendRequest(o.AccountDataSave,s).done(function(e){var s=r._authorizeData.account;t?s.purchasedItems=t:s.purchasedItems=[],n&&r._api.extend(s,n),i.resolve(e)}).fail(function(e){i.reject(e)}),i},i.prototype.clearAccountData=function(){return this._sendRequest(o.ClearAccountData,{})},i.prototype.saveAccountAppData=function(e,t){var n=this,r;if(t){var i=this.getAccountAppData();i?(r=this._api.extend({},i),r=this._api.extend(r,e)):r=e}else r=e;var s=this._sendRequest(o.AccountAppDataSave,r);return s.done(function(e){n._authorizeData.account.appData=r}),s},i.prototype.loadAccountAppData=function(){var t=new e.Deferred(this._api);return t.resolve(this.getAccountAppData()||{}),t},i.prototype.clearAccountAppData=function(){var t=this,n=new e.Deferred(this._api);return this._sendRequest(o.ClearAccountAppData,{}).done(function(){t._authorizeData.account.appData=null,n.resolve(!0)}).fail(function(e){n.reject(e)}),n},i.prototype.getAccountAppData=function(){var e;return(e=this._authorizeData)===null||e===void 0?void 0:e.account.appData},i.prototype.updateUser=function(t,n,r,i,s){var u=this,a=new e.Deferred(this._api),f={userId:s?s:this.getCurrentUserId()};t&&(f.username=t),n&&(f.countryCode=n),i&&(f=this._api.extend(f,i)),r&&(f.selectedAvatars=r);var l=this._sendRequest(o.UserUpdate,f);return l.done(function(e){var t=u.findUserById(f.userId);t&&(f.username&&(t.username=f.username),f.countryCode,i&&(t=u._api.extend(t,i)),r),a.resolve(e)}).fail(function(e){a.reject(e)}),a},i.prototype.clearUserCustomData=function(e){return this._sendRequest(o.ClearUserData,{userId:e?e:this.getCurrentUserId()})},i.prototype.saveAppData=function(t,n,r){var i,s=this,u=new e.Deferred(this._api),a={data:(i={},i[t]=n,i),userId:r?r:this.getCurrentUserId()};return this._sendRequest(o.AppSave,a).done(function(){s._updateUserAppData(a.userId,t,n),u.resolve(!0)}).fail(function(e){u.reject(e)}),u},i.prototype.getCurrentAppData=function(){var e=this.getCurrentUser();return e?e.appData:null},i.prototype.loadAppData=function(t,n,r){var i=this,s=new e.Deferred(this._api),u={key:t};n?u.userId=n:u.userId=this.getCurrentUserId();if(!r){var a=this.findUserById(u.userId);a&&s.resolve(a.appData?a.appData[t]:null)}else this._sendRequest(o.AppLoad,{keys:[t],userId:n?n:this.getCurrentUserId()}).done(function(e){i._updateUserAppData(u.userId,t,e?e[t]:null),s.resolve(e?e[t]:null)}).fail(function(e){s.reject(e)});return s},i.prototype.clearAppData=function(t,n){var r=this,i=new e.Deferred(this._api),s={userId:n?n:this.getCurrentUserId()};return t&&(s.keys=t),this._sendRequest(o.ClearAppData,s).done(function(){var e=r.findUserById(s.userId);if(e)if(t)for(var n=0;n<t.length;n++)e.appData[t[n]]=null;else e.appData=null;i.resolve(!0)}).fail(function(e){i.reject(e)}),i},i.prototype.findUserIndex=function(e){var t=this.getUsers();if(t)for(var n=0;n<t.length;n++)if(t[n].id===e)return n;return-1},i.prototype.findUserById=function(e){var t=this.getUsers();if(t)for(var n=0;n<t.length;n++)if(t[n].id===e)return t[n];return null},i.prototype.getUsers=function(){var e,t;return this.isEnabled()&&((e=this._authorizeData)===null||e===void 0?void 0:e.account)?(t=this._authorizeData)===null||t===void 0?void 0:t.account.users:null},i.prototype.createUser=function(t,n,r){var i=this,s=new e.Deferred(this._api),u={username:t};n&&(u.avatarId=n),r&&(u.countryCode=r);var a=this._sendRequest(o.AccountCreateUser,u);return a.done(function(e){i._authorizeData.account.users.splice(0,0,e),s.resolve(e)}).fail(function(e){s.reject(e)}),s},i.prototype.changeUser=function(t){var n=this,r=new e.Deferred(this._api),i={userId:t};this._settings.appDataKeys&&(i.appDataKeys=this._settings.appDataKeys);var s=this._sendRequest(o.AccountChangeUser,i);return s.done(function(e){var i=n.getUsers(),s=n.findUserIndex(t);if(s>0){i[0].appData=null;var o=i[s];i.splice(s,1),i.splice(0,0,o),o.appData=e}r.resolve(e)}).fail(function(e){r.reject(e)}),r},i.prototype.deleteUser=function(t){var n=this,r=new e.Deferred(this._api),i=this._sendRequest(o.UserDelete,{id:t});return i.done(function(e){var i=n.findUserIndex(t);i>=0&&n.getUsers().splice(i,1),r.resolve(e)}).fail(function(e){r.reject(e)}),r},i.prototype.usernameProfanityCheck=function(e){return this._sendRequest(o.BadWordsCheck,{checkType:1,text:e})},i.prototype.submitUserPurchase=function(e,t,n){return this._sendRequest(o.PurchasesSubmit,{itemId:e,shopId:t,userId:n?n:this.getCurrentUserId()})},i.prototype.getUserPurchases=function(e,t,n,r,i){var s={shopIds:e?e:this.getShops().map(function(e){return e.id}),userId:n?n:this.getCurrentUserId()};return t&&(s.lastPurchasedItemsCount=t),r&&(s.purchaseStartDate=r),i&&(s.purchaseEndDate=i),this._sendRequest(o.PurchasesGet,s)},i.prototype.submitProgress=function(e,t,n,r,i,s,u){var a={score:e,userId:t?t:this.getCurrentUserId(),submitToRealEvents:n?1:0};typeof s!="undefined"&&(a.exp=s);var f=this.getAppMode(r);return f&&(a.appModeId=f.id),typeof u!="undefined"&&(a.level=u),i&&(a.eventIds=i),this._sendRequest(o.ProgressSubmit,a)},i.prototype.getLeaderboards=function(e,t,n,r,i,s){var u={userId:i?i:this.getCurrentUserId()};return e&&(u.eventIds=e),t&&(u.appModeIds=t),n&&(u.lbIds=n),r?u.closedLbsCount=r:u.closedLbsCount=0,u.lbRecordsRequired=s===!1?0:1,this._sendRequest(o.LbsGet,u)},i.prototype._getApiFullURL=function(e){var t=e.url;if(!t)for(var n=0;n<this._availableApis.length;n++){var r=this._availableApis[n];if(r.uid===e.uid){t=r.url;break}}return t?this._settings.url+t:null},i.prototype._clearRequestTimeout=function(){this._requestTimeout&&(clearTimeout(this._requestTimeout),this._requestTimeout=null)},i.prototype._sendRequest=function(i,o){var u=this,a=4,f=new e.Deferred(this._api),l=this._getApiFullURL(i);if(!l){f.reject(new r(n.ACCESS_DENIED,"api"+i.uid+" not allowed"));return}var c=new XMLHttpRequest;this._settings.timeout&&(this._requestTimeout=setTimeout(function(){u._requestTimeout=null,f.reject(new r(n.REQUEST_TIMEOUT,"Request timeout api: "+i.uid))},this._settings.timeout)),c.onreadystatechange=function(){var e=c.status;if(e==0||e>=s.SUCCESS&&e<s.BAD_REQUEST){if(c.readyState==a){u._clearRequestTimeout();try{var i=JSON.parse(c.responseText);i.isCompressed&&(i.data=t.DecompressJSON.decompress(i.data)),i.status.id!==0?f.reject(new r(i.status.id,i.status.message)):f.resolve(i.data)}catch(o){f.reject(new r(n.FAIL_PARSE_RESPONSE))}}}else u._clearRequestTimeout(),f.reject(new r(n.NETWORK_ERROR,"Network error: "+c.status))};var h=JSON.stringify(this._prepareData(i,o)),p=this._api.calculateMD5(h+this._settings.publicKey);return c.open("POST",l,!0),c.setRequestHeader("Authorization","Basic "+p+"."+this._settings.certificate),c.setRequestHeader("Content-type","application/json"),c.setRequestHeader("cache-control","no-cache"),c.send(h),f},i.prototype._prepareData=function(e,t){var n=this;return e.mandatory&&e.mandatory.forEach(function(e){typeof n._requestParameters[e]!="undefined"&&(t[e]=n._requestParameters[e])}),t},i.prototype.init=function(){var t=this;return this._initResultDef=new e.Deferred(this._api),this._settings&&this._settings.enabled&&this._settings.url?this._api.getSystem().getUserUID().done(function(e){typeof e=="string"&&e?(t._createRequestParameters(e),t._sendRequest(o.Init,{}).done(function(e){t._availableApis=e,t._authorize()}).fail(function(e){t._disable(),t._initResultDef.reject(new r(n.FAIL_REQUEST_API,"Fail retrieve BaaS Apis"))})):(t._disable(),t._initResultDef.reject(new r(n.FAIL_TO_RETRIEVE_DEVICE_ID,"Wrong device id")))}).fail(function(){t._disable(),t._initResultDef.reject(new r(n.FAIL_TO_RETRIEVE_DEVICE_ID,"Fail to retrieve device id"))}):this._initResultDef.resolve(!1),this._initResultDef},i.prototype._disable=function(){this._settings.enabled=!1},i.prototype._authorize=function(){var e=this,t={};this._settings.appDataKeys&&(t.appDataKeys=this._settings.appDataKeys),this._settings.additionalAppDataKeys&&(t.additionalAppDataKeys=this._settings.additionalAppDataKeys),this._sendRequest(o.AccountAuthorize,t).done(function(t){e._authorizeData=t,e._updateRequestParameters(),e._initResultDef.resolve()}).fail(function(t){e._initResultDef.reject(t)})},i.prototype._updateRequestParameters=function(){this._requestParameters.id=this._requestParameters.accountId=this.getAccountId(),this._requestParameters.appId=this._getAppId(),this._requestParameters.lastPurchasedItemsCount=this.getServiceConfig().purchaseHistoryLimit},i.prototype._createRequestParameters=function(e){this._requestParameters={uuids:[e],appUid:this._api.productId,deploymentUid:this._settings.deployment,platformUid:this._api.getPlatformName(),id:"",accountId:"",appId:"",lastPurchasedItemsCount:0},this._settings.appDataKeys&&(this._requestParameters.appDataKeys=this._settings.appDataKeys),this._settings.additionalAppDataKeys&&(this._requestParameters.additionalAppDataKeys=this._settings.additionalAppDataKeys)},i.prototype._getAppId=function(){var e;return(e=this._authorizeData)===null||e===void 0?void 0:e.platform.deployment.app.id},i.prototype._updateUserAppData=function(e,t,n){var r,i=this.findUserById(e);i&&(i.appData?i.appData[t]=n:i.appData=(r={},r[t]=n,r))},i}(),t.BaasManager=u})(t=e.BaaS||(e.BaaS={}))}(TGH5||(TGH5={})),function(e){var t,n,r,i,s;e.settings={},t=function(){function e(){}return e.gamesPortal="games-portal",e.videoChannel="video-channel",e.game="game",e}(),e.ApplicationType=t,n=function(){function e(){}return e.div="div",e.canvas="canvas",e.webgl="webgl",e}(),e.RenderEngine=n,r=function(){function e(){}return e.regular="regular",e.broadcast="broadcast",e.smarttv="smarttv",e}(),e.ExitRequest=r,i=function(){function e(){}return e}(),e.IMedia=i,s=function(){function t(n,r,i){var s=this;this._pendingExit=!1,this._pendingRequests=0,this._inProgressExit=!1,this._exitFlow=!1,this._synchronized=!1,this._isSystemInitilized=!1,this._requestingProductSettings=!0,this._onPauseResumeListeners=[],this._sdkHome=e.System.getHomeDirectory(),console.log("SDKHOME: "+this._sdkHome);var o=this.loadScript(this._sdkHome+"/settings.js?r="+Date.now(),t.CONFIG_SCRIPT_TIMEOUT);this._deferred=new e.Deferred(this),o.done(function(){s.sdkSettings=JSON.parse(JSON.stringify(e.settings)),s.sdkSettings.screenResolution||(s.sdkSettings.screenResolution={width:1280,height:720}),e.System.SCREEN_WIDTH=s.sdkSettings.screenResolution.width,e.System.SCREEN_HEIGHT=s.sdkSettings.screenResolution.height,s.createGenericCSS();var o=function(){var o=s.sdkSettings.platform,u=new e.Deferred(s);if(typeof s.sdkSettings.platformsConfig!="undefined"){var a=s.sdkSettings.platformsConfig;if(!a.configFiles)u.reject();else{var f=a.configFiles[s.sdkSettings.platform];typeof f!="string"&&(f=a.configFiles["default"]);if(typeof f!="string")u.reject();else{var l;f.indexOf("://")<0?l=s._sdkHome+"/"+f:l=f,s.loadScript(l+(l.indexOf("?")>0?"&r=":"?r=")+Date.now(),t.CONFIG_SCRIPT_TIMEOUT).done(function(){s.sdkSettings=JSON.parse(JSON.stringify(e.settings));if(!s.sdkSettings.platform||s.sdkSettings.platform==="")s.sdkSettings.platform=o;u.resolve()}).fail(function(){u.reject()})}}}else u.resolve();u.done(function(){s.createConsole(),s.console.log("TGH5 SDK version: "+e.VERSION),s.console.log("Product ID: "+n),s.console.log("Platform: "+s.sdkSettings.platform),s._loadState=0;var o=t.locationGetParam("product_id");o&&(n=o),s.productId=n,s._initProductSettings(n,r,i,function(){s._baasManager=new e.BaaS.BaasManager(s),s._storage=new e.Storage(s),s.sdkSettings.cachedSettings=new e.CachedSettings(s),s._geoManager=new e.Geo.GeoManager(s),s._resourceManager=new e.Resources.ResourceManager(s),s._audioManager=new e.Sound.AudioManager(s),s._isSystemInitilized&&!s._authorizationManager.isInitialized()&&s._authorizationManager.init().always(function(){s._paymentManager.init(s.productSettings)}),s._leaderboars=new e.Leaderboards.LeaderboardManager(s),s._language=new e.Language(s,r.supportedLanguages),s.getLanguage=function(){return s._language.getLanguage()},s.setLanguage=function(e){return s._language.setLanguage(e)},s.getAllowedLanguages=function(){return s._language.getAllowedLanguages()},s.preferredLanguage=e.calculatedLanguage(s),s.changePlayersLanguage=function(e){return s._language.setLanguage(e)},s._parentAppProductId=e.Api.locationGetParam("parent"),s._addOnErrorListener(),s._adsManager=new e.Ads.AdsManager(s),s._keyManager=new e.Key.KeyManager(s),s._mouseManager=new e.Mouse.MouseManager(s),s.productSettings.title?document.title=s.productSettings.title:s.productSettings.title=document.title,s._exitRequestTo=e.ExitRequest.regular,s._system=new e.System(s),s._system.init().always(function(){s._isSystemInitilized=!0,s._checkServiceAvailability().always(function(){e.Reporting.createReportManager(s,function(t){s._reportManager=t,s._pwAnalyticsManager=new e.PWAnalytics.PWAnalyticsManager(s),s._pwAnalyticsManager.initialize(function(){s.sdkSettings.cachedSettings.isPlatformReported||(s.sdkSettings.cachedSettings.isPlatformReported=!0,s.sdkSettings.cachedSettings.save(),s.reportSystemEvent(e.Reporting.System.userAgent,""+window.navigator.userAgent)),s.reportSystemEvent(e.Reporting.System.version,e.VERSION),s._storage.checkCookieRestrictions(),s._baasManager.init().done(function(){s.incrementLoadState()}).fail(function(e){s.console.error("BaaS Error: "+e.code+" : "+e.message),s._baasManager.showErrorDialog(e)}),s._brightDataManager=new e.BrightData.BrightDataManager(s),s._brightDataManager.initialize().always(function(){s._keyManager.init().always(function(){s._authorizationManager=new e.AuthorizationManager(s),s._paymentManager=new e.Payment.PaymentManager(s),s._socialManager=new e.Social.SocialManager(s),s._gdprManager=new e.GDPR.GDPRManager(s),s._gdprManager.initialize().always(function(){s._consentManager=new e.Consent.ConsentManager(s),s._consentManager.initialize(s._gdprManager,s._brightDataManager).always(function(){s._consentManager.requestDialog().always(function(){s.processLater(function(){!s._requestingProductSettings&&!s._authorizationManager.isInitialized()&&s._authorizationManager.init().always(function(){s._paymentManager.init(s.productSettings),s._socialManager.init()}),s.incrementLoadState()})})})})})})})})})})})}).fail(function(e,t){s._deferred.reject(t)})};s.sdkSettings.platform?o():e.System.detectPlatformName(s.sdkSettings.platformsConfig.configFiles,function(e){console.log("DETECT PLATFORM: "+e),s.sdkSettings.platform=e,o()})}).fail(function(e,t){s._deferred.reject(t)})}return t.prototype.requestCountryCode=function(){return this._geoManager.requestCountryCode()},t.prototype.requestIpAddress=function(){return this._geoManager.requestIpAddress()},t.prototype.requestIp6Address=function(){return this._geoManager.requestIp6Address()},t.prototype._checkServiceAvailabilityByIp=function(){var t=this.sdkSettings.serviceAvailability,n=new e.Deferred(this);return!t||!t.allowedIps?n.resolve(!1):this._geoManager.requestIpAddress().always(function(r){for(var i=0;i<t.allowedIps.length;i++)if(e.Geo.GeoManager.ipRangeCheck(r,t.allowedIps[i])){n.resolve(!0);return}n.resolve(!1)}),n},t.prototype._checkServiceAvailability=function(){var t=this,n=this.sdkSettings.serviceAvailability;if(!n||n.enabled==0||!n.allowedCountries||n.allowedCountries.length<1)return new e.Deferred(this,!0);var i=new e.Deferred(this);return this.requestCountryCode().always(function(s){typeof s=="string"?(s=s.toLowerCase(),n.allowedCountries.indexOf(s)<0?t._checkServiceAvailabilityByIp().done(function(s){if(!s){var o=t.createDiv("tgh5-exit",!0);o.style.backgroundImage="url("+t.resolvePath(n.screenBackground)+")",t._exitRequestTo=r.smarttv,t._keyManager.setEnabled(!1,e.Key.ListenerType.Product,e.Key.EventType.Any),t._keyManager.addListener(e.Key.ListenerType.System,e.Key.EventType.KeyUp,t.doExit,t),t._mouseManager.addListener(function(n){n.type==e.Mouse.Event.MouseUp&&t.doExit()},t)}else i.resolve(!0)}):i.resolve(!0)):i.resolve(!0)}),i},t.prototype.loadingCompleted=function(){this._system.loadingCompleted()},t.prototype.hasModalAd=function(e){return this._adsManager.isAdExists(e)},t.prototype.setOnAdsResponseCallback=function(e,t){this._adsResponseCallback=e,this._adsResponseThisArg=t},t.prototype._onAdResponse=function(){var t=this;this._adsResponseCallback&&this._adsManager.isAdExists(e.Ads.Type.MidRoll).always(function(n){n?t._adsResponseCallback.call(t._adsResponseThisArg,!0):t._adsManager.isAdExists(e.Ads.Type.Rewarded).always(function(e){t._adsResponseCallback.call(t._adsResponseThisArg,!!e)})})},t.prototype.requestAd=function(t,n){return t==e.Ads.Type.PreRoll&&this._system.loadingCompleted(),this._adsManager&&this._adsManager.isEnabled()?this._adsManager.requestAds(t,n):new e.Deferred(this,!0)},t.prototype.startCatapult=function(t){return this._adsManager&&this._adsManager.isEnabled()?this._adsManager.startCatapult(t):new e.Deferred(this,!0)},t.prototype.requestModalAd=function(t){console.log("api.requestModalAd is deprecated! Please call api.requestAd");var n=e.Ads.Type.PreRoll;return t==="inGame"?n=e.Ads.Type.MidRoll:t==="postRoll"?n=e.Ads.Type.PostRoll:t==="preRoll"&&(n=e.Ads.Type.PreRoll),this.requestAd(n)},t.prototype.getAdsManager=function(){return this._adsManager},t.prototype.reportAdEvent=function(t,n,r,i){this._reportManager&&this._reportManager.reportAdEvent(t,n,r,i),this._pwAnalyticsManager&&this._pwAnalyticsManager.reportAdEvent(t,n,r,i),this._gameAnalyticsManager&&gameanalytics&&r==e.Ads.Type.Rewarded&&t==e.Reporting.Ads.completed&&this._gameAnalyticsManager.reportEvent({eventType:e.Reporting.Game.EventType.ADs,adAction:gameanalytics.EGAAdAction.RewardReceived,adType:gameanalytics.EGAAdType.RewardedVideo,adProvider:n.name,adPlacement:this._adsManager.getCurrentPlacement()})},t.prototype.reportAdPodStarted=function(t,n,r){var i=e.Reporting.Ads.startedPodsAd+r;this.reportAdEvent(i,t,n)},t.prototype.reportAdPodResponse=function(t,n,r){var i=e.Reporting.Ads.responsePodsAd+r;this.reportAdEvent(i,t,n)},t.prototype.reportAdImpression=function(t,n,r){this._reportManager&&this._reportManager.reportAdImpression(t,n,r),this._pwAnalyticsManager&&this._pwAnalyticsManager.reportAdEvent(e.Reporting.Ads.impression,t,n,r),this._gameAnalyticsManager&&gameanalytics&&this._gameAnalyticsManager.reportEvent({eventType:e.Reporting.Game.EventType.ADs,adAction:gameanalytics.EGAAdAction.Show,adType:n==e.Ads.Type.Rewarded?gameanalytics.EGAAdType.RewardedVideo:gameanalytics.EGAAdType.Interstitial,adProvider:t.name,adPlacement:this._adsManager.getCurrentPlacement()})},t.prototype.reportAdErrorEvent=function(t,n){this._reportManager&&this._reportManager.reportAdErrorEvent(t,n),this._pwAnalyticsManager&&this._pwAnalyticsManager.reportAdErrorEvent(t,n),this._gameAnalyticsManager&&gameanalytics&&this._gameAnalyticsManager.reportEvent({eventType:e.Reporting.Game.EventType.ADs,adAction:gameanalytics.EGAAdAction.FailedShow,adType:n.adType==e.Ads.Type.Rewarded?gameanalytics.EGAAdType.RewardedVideo:gameanalytics.EGAAdType.Interstitial,adProvider:n.name,adPlacement:this._adsManager.getCurrentPlacement()})},t.prototype.gameplayStart=function(){this._system.gameplayStart()},t.prototype.gameplayStop=function(){this._system.gameplayStop()},t.prototype.reportGeoEvent=function(t,n,r){this._reportManager&&this._reportManager.reportGeoEvent(t,n,r),this._pwAnalyticsManager&&this._pwAnalyticsManager.reportEvent(e.Reporting.EventCategory.Geo,t,n)},t.prototype.reportSystemEvent=function(t,n){this._reportManager&&this._reportManager.reportSystemEvent(t,n),this._pwAnalyticsManager&&this._pwAnalyticsManager.reportEvent(e.Reporting.EventCategory.System,t,n)},t.prototype.reportPaymentEvent=function(t,n,r,i,s){this._gameAnalyticsManager&&t==e.Reporting.Payment.Success&&this._gameAnalyticsManager.reportEvent({eventType:e.Reporting.Game.EventType.Business,itemType:i&&i.isSubscription?"Subscription":"Purchase",itemId:i&&i.productId?i.productId:"",amount:r,currency:"USD",cartType:s}),this._reportManager&&this._reportManager.reportPaymentEvent(t,n,r),this._pwAnalyticsManager&&this._pwAnalyticsManager.reportEvent(e.Reporting.EventCategory.Payment,t,n,r)},t.prototype.reportFocusEvent=function(e,t){this._reportManager&&this._reportManager.reportFocusEvent(e,t)},t.prototype.reportClickEvent=function(e,t){this._reportManager&&this._reportManager.reportClickEvent(e,t)},t.prototype.reportErrorEvent=function(t,n){this._reportManager&&this._reportManager.reportErrorEvent(t,n),this._pwAnalyticsManager&&this._pwAnalyticsManager.reportEvent(e.Reporting.EventCategory.Errors,t,n)},t.prototype.reportCrossPromotionEvent=function(t,n){this._reportManager&&this._reportManager.reportCrossPromotionEvent(t,n),this._pwAnalyticsManager&&this._pwAnalyticsManager.reportEvent(e.Reporting.EventCategory.CrossPromotion,t,n)},t.prototype.reportEvent=function(e,t,n,r,i){this._reportManager&&this._reportManager.reportEvent(e,t,n,r,i),this._pwAnalyticsManager&&(i=this._pwAnalyticsManager._remapDimensions(i),this._pwAnalyticsManager.reportEvent(e,t,n,r,i))},t.prototype.reportAppEvent=function(t,n){this._reportManager&&this._reportManager.reportAppEvent(t,n),this._pwAnalyticsManager&&this._pwAnalyticsManager.reportEvent(e.Reporting.EventCategory.App,t,n)},t.prototype.reportNavigationEvent=function(e,t){console.log("api.reportNavigationEvent is deprecated: "+e)},t.prototype.reportPollEvent=function(e,t,n,r){this._reportManager&&this._reportManager.reportPollEvent(e,t,n,r)},t.prototype.reportGameAnalyticsCustomEvent=function(e){this._gameAnalyticsManager&&this._gameAnalyticsManager.reportEvent(e)},t.prototype.reportGameAnalyticsDesignEvent=function(t,n){this._gameAnalyticsManager&&this._gameAnalyticsManager.reportEvent({eventType:e.Reporting.Game.EventType.Design,eventId:t,value:n});if(this._pwAnalyticsManager){var r=t.split(":"),i={};for(var s=1;s<5;s++)r[s+1]&&(i["d"+s]=r[s+1]);this._pwAnalyticsManager.reportEvent("app",r[0],r[1],n,i)}},t.prototype.reportGameAnalyticsScreenEvent=function(t){this._gameAnalyticsManager&&this._gameAnalyticsManager.reportEvent({eventType:e.Reporting.Game.EventType.Design,eventId:"Screen:"+t}),this._pwAnalyticsManager&&this._pwAnalyticsManager.reportEvent("Screen",t)},t.prototype.reportGameAnalyticsGameplayStart=function(t,n,r,i){this._gameAnalyticsManager&&this._gameAnalyticsManager.reportEvent({eventType:e.Reporting.Game.EventType.Progression,progressionStatus:e.Reporting.Game.ProgressionStatus.Start,progression01:t,progression02:n,progression03:r,score:i});if(this._pwAnalyticsManager){var s={};n&&(s.d1=n),r&&(s.d2=n),this._pwAnalyticsManager.reportEvent("app","gameplay-start",t,i,s)}},t.prototype.reportGameAnalyticsGameplayComplete=function(t,n,r,i){this._gameAnalyticsManager&&this._gameAnalyticsManager.reportEvent({eventType:e.Reporting.Game.EventType.Progression,progressionStatus:e.Reporting.Game.ProgressionStatus.Complete,progression01:t,progression02:n,progression03:r,score:i});if(this._pwAnalyticsManager){var s={};n&&(s.d1=n),r&&(s.d2=n),this._pwAnalyticsManager.reportEvent("app","gameplay-complete",t,i,s)}},t.prototype.reportGameAnalyticsGameplayFail=function(t,n,r,i){this._gameAnalyticsManager&&this._gameAnalyticsManager.reportEvent({eventType:e.Reporting.Game.EventType.Progression,progressionStatus:e.Reporting.Game.ProgressionStatus.Fail,progression01:t,progression02:n,progression03:r,score:i});if(this._pwAnalyticsManager){var s={};n&&(s.d1=n),r&&(s.d2=n),this._pwAnalyticsManager.reportEvent("app","gameplay-fail",t,i,s)}},t.prototype.reportGameAnalyticsResourceEarned=function(t,n,r,i){this._gameAnalyticsManager&&this._gameAnalyticsManager.reportEvent({eventType:e.Reporting.Game.EventType.Resource,flowType:e.Reporting.Game.ResourceFlowType.Source,currency:t,amount:n,itemType:r,itemId:i}),this._pwAnalyticsManager&&this._pwAnalyticsManager.reportEvent("app","resource-earned",t,n,{d1:r,d2:i})},t.prototype.reportGameAnalyticsResourceSpent=function(t,n,r,i){this._gameAnalyticsManager&&this._gameAnalyticsManager.reportEvent({eventType:e.Reporting.Game.EventType.Resource,flowType:e.Reporting.Game.ResourceFlowType.Sink,currency:t,amount:n,itemType:r,itemId:i}),this._pwAnalyticsManager&&this._pwAnalyticsManager.reportEvent("app","resource-spent",t,n,{d1:r,d2:i})},t.prototype.reportGameAnalyticsErrorEvent=function(t,n){this._gameAnalyticsManager&&this._gameAnalyticsManager.reportEvent({eventType:e.Reporting.Game.EventType.Error,severity:t,message:n}),this._pwAnalyticsManager&&this._pwAnalyticsManager.reportEvent("errors","game",n)},t.prototype._checkSynchronization=function(){if(this._synchronized!==!0)throw Error("Critical error: please call Api.synchronize() first")},t.prototype.getPurchasedStatus=function(){return this._checkSynchronization(),this.productSettings.payment.status},t.prototype._needSynchronize=function(){return this._paymentManager.needSynchronize()||this._socialManager.needSynchronize()||this._audioManager.needSynchronize()||this._authorizationManager.needSynchronize()||this._system.needSynchronize()||this._requestingProductSettings},t.prototype.synchronize=function(){var n=this,r=new e.Deferred(this);if(!this._needSynchronize())this._synchronized=!0,this._onSynchronized().always(function(){r.resolve()});else var r=new e.Deferred(this),i=function(){n._needSynchronize()||(clearInterval(s),n._synchronized=!0,n._onSynchronized().always(function(){r.resolve()}))},s=setInterval(i,t.CHECK_SYNC_INTERVAL);return r},t.prototype._onSynchronized=function(){var t=new e.Deferred(this);return this._gameAnalyticsManager=e.Reporting.Game.createGameAnalyticsManager(this),this._gameAnalyticsManager?this._gameAnalyticsManager.init().always(function(){t.resolve()}):t.resolve(),t},t.prototype.startPayment=function(e,t){return this._checkSynchronization(),this._paymentManager.startPayment(e,t)},t.prototype.getProductsPaymentInfo=function(e){return this._paymentManager.getProductsPaymentInfo(e)},t.prototype.applyPurchases=function(e){return this._paymentManager.applyPurchases(e)},t.prototype.requestPaymentScreen=function(t,n,r){var i=this;this._checkSynchronization();var s=new e.Deferred(this);return this._keyManager.waitKeyUp().always(function(){i._paymentManager.requestScreen(t,n,r?i.getProductSettings(r):i.productSettings).always(function(e){s.resolve(e)})}),s},t.prototype.restoreSubscription=function(){var t=this;this._checkSynchronization();var n=new e.Deferred(this);return this._keyManager.waitKeyUp().always(function(){t._paymentManager.restoreSubscription().always(function(e){n.resolve(e)})}),n},t.prototype.unsubscribe=function(t){var n=this;this._checkSynchronization();var r=new e.Deferred(this);return this._keyManager.waitKeyUp().always(function(){n._paymentManager.unsubscribe(t).always(function(e){r.resolve(e)})}),r},t.prototype.getSubscriptionCancellationInfo=function(){return this._paymentManager.getSubscriptionCancellationInfo()},t.prototype.getDefaultUserName=function(){this._checkSynchronization();var n=this.getPurchasedStatus();return n===e.Payment.ProductStatus.Demo||n===e.Payment.ProductStatus.Free?t.DEFAULT_USER_NAME:this.sdkSettings.cachedSettings.defaultUserName?this.sdkSettings.cachedSettings.defaultUserName:typeof this.sdkSettings.defaultUserName!="undefined"?this.sdkSettings.defaultUserName:t.DEFAULT_USER_NAME},t.prototype.setDefaultUserName=function(t){this._checkSynchronization();if(status===e.Payment.ProductStatus.Demo||status===e.Payment.ProductStatus.Free)return;this.sdkSettings.cachedSettings.defaultUserName=t,this.sdkSettings.cachedSettings.save()},t.prototype.getAuthorizationManager=function(){return this._authorizationManager},t.prototype.getPaymentManager=function(){return this._paymentManager},t.prototype.getSocialManager=function(){return this._socialManager},t.prototype.getPollUsedData=function(){return this.sdkSettings.cachedSettings.pollData},t.prototype.setPollUsedData=function(e){this.sdkSettings.cachedSettings.pollData=e,this.sdkSettings.cachedSettings.save()},t.prototype.playMusic=function(e){return this._audioManager.playMusic(!0,e)},t.prototype.stopMusic=function(){return this._audioManager.stopMusic()},t.prototype.getMusicControlState=function(){return this._audioManager.getMusicControlState()},t.prototype.getSoundControlState=function(){return this._audioManager.getSoundControlState()},t.prototype.controlMusic=function(e){this._audioManager.controlMusic(e)},t.prototype.controlSound=function(e){this._audioManager.controlSound(e)},t.prototype.isMusicPlaying=function(){return this._audioManager.isMusicPlaying()},t.prototype.isSoundPlaying=function(){return this._audioManager.isMusicPlaying()},t.prototype.playSound=function(e,t){this._audioManager.playSound(e,t)},t.prototype.stopSound=function(){this._audioManager.stopSound()},t.prototype.getAudioManager=function(){return this._audioManager},t.prototype.getExitRequest=function(){return this._exitRequestTo},t.prototype.setExitRequest=function(e){this._exitRequestTo=e},t.prototype.createDiv=function(e,t){var n=document.createElement("div");return e&&(n.className=e),t===!0&&document.body.appendChild(n),n},t.prototype._hideAllDivs=function(){var e=document.querySelectorAll("div");for(var t=0;t<e.length;t++){var n=e[t];n.style.visibility="hidden",n.style.display="none"}},t.prototype._requestPaymentExitScreen=function(){return!1},t.prototype.exit=function(t,n){var r=this;if(this._exitFlow||!this.isExitAvailable()&&!this.isExtraExitAvailable())return;this._system.prepareExit(),this._keyManager.setEnabled(!1,e.Key.ListenerType.Any,e.Key.EventType.Any),this._reportManager&&this._reportManager.reportEvent(e.Reporting.EventCategory.App,e.Reporting.AppEvents.Ended,"time",this._system.getAppSpentTimeSec()),this._pwAnalyticsManager&&this._pwAnalyticsManager.close(),this._gameAnalyticsManager&&this._gameAnalyticsManager.reportSessionEnd(),this._exitFlow=!0,this._audioManager.disable(),this._exitRequestTo=t,this.getSocialManager().synchronizeGameData().always(function(){r.stopMusic().always(function(){r._audioManager.cleanup().always(function(){(n===!1||!r._requestPaymentExitScreen())&&r._exit()})})})},t.prototype.isExitFlow=function(){return this._exitFlow===!0},t.prototype._exit=function(){var n=this;this._waitForExit||(this._waitForExit=(new Date).getTime()+t.WAIT_PANDING_REQUEST_TIMEOUT),this.sdkSettings.adsSettings.ads["post-roll"]!==!1&&this.createDiv("tgh5-exit",!0),this.requestAd(e.Ads.Type.PostRoll).always(function(){if(!n._pendingExit){n._pendingExit=!0;if(n._pendingRequests===0)n.doExit();else var e=setInterval(function(){if(n._pendingRequests===0||n._waitForExit<(new Date).getTime())clearInterval(e),n.doExit()},100)}})},t.prototype.pendingRequests=function(e){return arguments.length&&(this._pendingRequests+=e,this._pendingExit&&this._pendingRequests===0&&this.doExit()),this._pendingRequests},t.prototype.doExit=function(){if(this._inProgressExit)return;this._inProgressExit=!0,this._exitRequestTo==r.smarttv?this._system.exitSmartTV():this._system.exit()},t.prototype.getGDPRManager=function(){return this._gdprManager},t.prototype.getConsentManager=function(){return this._consentManager},t.prototype.getBaasManager=function(){return this._baasManager},t.prototype.getMultiControllerManager=function(){return this._system.getMultiControllerManager()},t.prototype.getSystem=function(){return this._system},t.prototype.isPortal=function(){return this.productId&&this.productId.indexOf("portal")==0},t.prototype.launchApp=function(t,n){if(this.sdkSettings.products&&this.sdkSettings.products[t]&&this.sdkSettings.products[t].url){var r=this.resolvePath(this.sdkSettings.products[t].url);t!=this.productId&&t!="portal"&&this._paymentManager.isSamePaymentProductId(t,this.productId)&&(r=this.locationURLAddParam(r,"status",this.getPurchasedStatus()));if(this.productSettings.defaultLaunchParameters){var i=this.productSettings.defaultLaunchParameters;for(var s in i){if(!i.hasOwnProperty(s))continue;var o=e.Api.locationGetParam(s);o||(r=this.locationURLAddParam(r,s,i[s]))}}return this.changeLocation(r,n,t),!0}return!1},t.prototype.changeLocation=function(n,r,i){var s=this,o=this;this._waitForExit=Date.now()+t.WAIT_PANDING_REQUEST_TIMEOUT,this._reportManager&&this._reportManager.reportEvent(e.Reporting.EventCategory.App,e.Reporting.AppEvents.Ended,"time",this._system.getAppSpentTimeSec()),this._pwAnalyticsManager&&this._pwAnalyticsManager.close();var u=setInterval(function(){if(o._pendingRequests===0||o._waitForExit<Date.now()){clearInterval(u);var e=n;i&&i===o.productId?o._parentAppProductId&&(e=o.locationURLAddParam(n,"parent",o._parentAppProductId)):r!==!0&&(e=o.locationURLAddParam(n,"parent",o.productId)),s._system.changeLocation(e,r)}},100)},t.prototype._initProductSettings=function(e,t,n,r){var i=this;if(this.sdkSettings.products)this.sdkSettings.products[e]?this.productSettings=this.sdkSettings.products[e]:this.productSettings={},n&&this.sdkSettings.products[n]&&(this.console.log("Get settings from owner ProductID: "+n),this.extend(this.productSettings,this.sdkSettings.products[n])),this.extend(this.productSettings,t),this.productSettings.productId=e,this._requestingProductSettings=!1,r();else{this.productSettings={},this.extend(this.productSettings,t),this.productSettings.productId=e;var s=this.sdkSettings.productsDefinitions;for(var o in s){if(!s.hasOwnProperty(o))continue;if(s[o].productId==e){this.productSettings.title=s[o].title;break}}this._geoManager.requestCountryCode().always(function(t){typeof t=="string"&&(t=t.toLowerCase()),i.console.log("Country Code: "+t);var n=i.sdkSettings.productsByCountry["default"];i.sdkSettings.productsByCountry[t]&&(n=i.sdkSettings.productsByCountry[t]),i.sdkSettings.products={};for(o in n){if(!n.hasOwnProperty(o))continue;var s=i.sdkSettings.productsDefinitions[n[o]];i.sdkSettings.products[s.productId]=s}i.extend(i.productSettings,i.sdkSettings.products[e]),i._requestingProductSettings=!1,r()})}},t.prototype.isNewUser=function(){return this.sdkSettings&&this.sdkSettings.cachedSettings?this.sdkSettings.cachedSettings.isNewUser:!1},t.prototype._addOnErrorListener=function(){var t=this;window.onerror=function(n,r,i,s,o){try{var u=""+n+" url: "+r;typeof i!="undefined"&&(u+=" l: "+i),typeof s!="undefined"&&(u+=" c: "+s),typeof o!="undefined"&&o.stack&&(u+=" s: "+o.stack),t.console.error(u),t.reportErrorEvent(e.Reporting.Errors.system,u)}catch(a){}return!0}},t.prototype.getPWAnalyticsManager=function(){return this._pwAnalyticsManager},t.prototype.getRenderEngine=function(){if(!this.productSettings.renderEngine)return e.RenderEngine.div;if(typeof this.productSettings.renderEngine=="string")return this.productSettings.renderEngine;var t=this.productSettings.renderEngine,n=window.navigator.userAgent;if(n){var r=e.RenderEngine.div;for(var i in t)if(t.hasOwnProperty(i)){var s=t[i];if(this.isArray(s)&&s.length<=0)r=i;else for(var o=0;o<s.length;o++)if(n.indexOf(s[o])>=0)return i}return r}return e.RenderEngine.div},t.prototype.getProductSettings=function(e){var t;return e?(t=this.sdkSettings.products[e],t&&!t.productId&&(t.productId=e),t&&t.payment&&!t.payment.ownerProductId&&(t.payment.ownerProductId=e)):(this._checkSynchronization(),t=this.productSettings),t},t.replaceAll=function(e,t,n){if(typeof n=="undefined")return e;while(e.indexOf(t)>=0)e=e.replace(t,n);return e},t._initCRCTable=function(){var e;t._crcTable=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t._crcTable[n]=e}},t.calculateCRC=function(e){t._crcTable||this._initCRCTable();var n=-1;for(var r=0;r<e.length;r++)n=n>>>8^t._crcTable[(n^e.charCodeAt(r))&255];return(n^-1)>>>0},t.prototype.createConsole=function(){var t=this.sdkSettings.logging;t&&t.enabled&&(t.console==="overlay"?(this.console=new e.Console(24,14,20,t.level),e._RegisterOwnerConsoleListener(this)):(this.console=new e.NativeConsole,e._RegisterOwnerConsoleListener(this))),this.console||(this.console=new e.EmptyConsole)},t.prototype.applyCSS=function(e){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n)},t.prototype.createGenericCSS=function(){var e="body{overflow:hidden;margin:0;padding:0;width:"+this.sdkSettings.screenResolution.width+"px;height:"+this.sdkSettings.screenResolution.height+"px;cursor:default;-webkit-tap-highlight-color:rgba(255,255,255,0);-webkit-user-select:none;outline:0}",t=e+".tgh5-not-available{position:fixed;top:87px;left:1153px;height:40px;width:40px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAAyVBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9mmcyjwuFwoNBsnc6Yu92ErdbW4/F/qtR3pdLv9frY5fKIr9eMs9n6+/30+fzm7vfP3++PtNrp8Pjc5/PK3O3F2OyTt9u50Oh7p9P3+vzf6vS/1eqtyeSqxuPbRuZZAAAAJHRSTlMA2V4cmu7AILysy6WXdAwF0LCfOt4o5uN6by4Uw7aLY4RM9Rb4FAAYAAACd0lEQVQ4y3WUZ3uqQBCFVxQiGnuJpt97z9IUEoq9pPz/H3VnIARX8XwBdl9m5szOs0LVSKsZQ10fGrWXkbiqh1YdJzIm1VKsUwOw2lrhwbYPobVNAPTbl9yfCrBwHVlot4kw1M45Cvf2Llm+F4aeL1nejIKqXBP44q33fXIEKUo+Q/62IvRULl5ysjVDDcNogPTh8p8Bk0XemNLaW6D7PEjrb9+/ErygCuYBmr8+gCWtJPg7ESeajhF4FPOI3FEXX+mfjzdK3dUK1mzKwvjhJ/Ga8iZ4EufczJaSGrbIrD8AlGADQ+VuMu57RskicK4WFuQXerWMswDyvkWNlurYSfmByTn35qQcVo58BzpilL011Pp+Oe0nzkC8YCvlHs/l8TQxwYb3W+TZkjLB4CxeVt8tfSBwpAtTGAilH6Gt9sXJOdEB5tJDVwxxoGdD5X7jpWaX0sed0GHLEMYllx+cCVfa0FUw85FzKsipi+7cqPFYT9ilqR8LM2pfcgEem0nb46xwf437h9iWLnpZwz/xyj4uuGwUsoaPkEhy81hw3JdCTzwVaz6QdLwTTNX+5dL4YDweCnHLh+liXMq1u7C4shpXhmjOU6z0JZfJ03+IM6990BT7wbqEayI+8PQ3s/AVDu9dch0TxyWXhWpecJTeJt8qp1UQEzePi6r7CKhMZwYYrWonm41pHXijVX/FiXP1EHBMNwGpbpoEAStLUrwV6kwU5JGXnd0mQKoguwLdGPX2+XW28CSz86XrLskah9sApjiTNka0pfyFvM8Y+rTkBu8D+Ni7nm/bvufu1wCa5bf46LmBU9XuxVUNWmbjTtfvur3WoKPs/AeKFIGyWfiCbgAAAABJRU5ErkJggg==);background-repeat:no-repeat;z-index:100000}"+".tgh5-console{position:fixed;top:0;left:0;width:600px;margin:0;padding:0;z-index:2147483647;font-family:monospace;font-size:14px;color:#fff;background-color:rgba(0,0,0,.5);text-shadow:1pt 1pt #444;text-align:left}.payment-back{background-color:rgba(0,0,0,.84);position:fixed;width:1280px;height:720px;top:0;left:0;z-index:99997}.payment-iframe{position:fixed;width:1280px;height:720px;border:none;z-index:99997;top:0;left:0}.video-ad-iframe{position:absolute;top:0;left:0;width:1280px;height:720px;border:none;z-index:99999}.tgh5-ad-container{position:absolute;top:0;left:0;width:1280px;height:720px;border:none;z-index:99999;background:black}.tgh5-ad-container.post-roll{background:#000;background-repeat:no-repeat}.tgh5-video{position:absolute;top:132px;left:237px;width:800px;height:450px;border:3px solid #3173e5;background:#000}.tgh5-video.post-roll{border:none}.tgh5-ad-copyright{font-family:Archivo,Xscale,Arial,Archivo Narrow,sans-serif,monospace;font-weight:700;font-size:17px;color:#fff;margin-top:651px;width:1280px;text-align:center}.tgh5-ad-topStrip{position:absolute;margin:0;width:1280px;height:18px;background:#000}.tgh5-ad-topStripText{position:absolute;margin:0;width:1280px;height:18px;font-family:Archivo,Xscale,Arial,Archivo Narrow,sans-serif,monospace;font-weight:700;font-size:15px;color:#fff;text-align:center}.tgh5-ad-shield{background-color:rgba(255,0,0,0);position:fixed;top:0;left:0;width:1280px;height:720px;z-index:100000}.tgh5-exit{position:absolute;top:0;right:0;bottom:0;left:0;z-index:99988;background:#000 no-repeat}:focus{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;outline:0 solid transparent}:hover{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;outline:0 solid transparent}.tgh5-lpb-shield{background-color:rgba(255,0,0,0);position:fixed;top:0;left:0;width:1280px;height:720px;z-index:99997}.tgh5-lpb-background{width:200px;height:200px;left:540px;top:260px;background-color:rgba(0,0,0,.75);position:fixed;z-index:99998}.tgh5-lbp-dot{position:absolute}.tgh5-adbased{position:fixed;width:1280px;height:720px;z-index:100002;top:0;left:0}.tgh5-adbased-line{position:fixed;width:1280px;height:40px;background-color:#000;text-align:center;line-height:40px;z-index:100001;top:0;left:0;font-size:20px}.tgh5-adbased-text{color:#fff;display:inline-block}.tgh5-adbased-arrow{display:inline-block;width:14px;background-repeat:no-repeat;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAMBAMAAACgrpHpAAAAD1BMVEUAAAD///////////////+PQt5oAAAABHRSTlMAwUBB0lyk7gAAACtJREFUCNdjEGIAARcGFyEoDWSAaSADTIMYIBrMgNEo4kIo+oQh5ghDzAUARLcMA7A8OcAAAAAASUVORK5CYII=);margin-left:9px;background-position:center}#viAd{z-index:99999!important}.tgh5-md-back{display:none;position:fixed;top:0;left:0;width:1280px;height:720px;z-index:99999;font-family:sans-serif,serif;text-align:center}.tgh5-md-frame{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);-webkit-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);min-width:440px;padding-left:40px;padding-right:40px;margin:auto;background-color:#333;border:6px solid #f5b402;border-radius:7px;padding-top:12px;padding-bottom:20px}.tgh5-md-text{top:12px;color:#fff;font-size:36px;line-height:50px;font-weight:700;margin-bottom:5px;text-align:center}.tgh5-md-text span{color:#f5b402}.tgh5-md-buttons{margin:auto;border-collapse:separate;border-spacing:0 10px}.tgh5-md-button{font-size:30px;height:50px;line-height:40px;min-width:150px;max-width:600px;text-align:center;vertical-align:middle}.tgh5-md-button.regular{color:#fff;background-color:#878e96;padding:4px 24px 4px 24px}.tgh5-md-button.focused{color:#f2b600;border:solid #f2b600 4px;border-radius:4px;background-color:#2a36ea;padding:0 20px 0 20px}";this.applyCSS(t)},t.prototype.getLeaderboards=function(){return this._leaderboars},t.prototype.getResourceManager=function(){return this._resourceManager},t.prototype.getStorage=function(){return this._storage},t.prototype.getParentProductId=function(){return this._parentAppProductId},t.prototype.extend=function(e,t){if(t)for(var n in t)e[n]&&typeof e[n]=="object"&&e[n]+""=="[object Object]"&&t[n]?this.extend(e[n],t[n]):e[n]=t[n];return e},t.prototype.locationURLAddParam=function(e,t,n){var r=e.split("?");if(r.length>1){var i=r[1].split("&"),s=i.length,o;while(s--){o=i[s].split("=");if(o[0]==t){o[1]=n,i[s]=o.join("=");break}}return s<0&&(i[i.length]=[t,n].join("=")),r[0]+"?"+i.join("&")}return e+"?"+[t,n].join("=")},t.locationGetParam=function(e){var t=location.search.substr(1),n=t.split("&");for(var r=0;r<n.length;r++){var i=n[r].split("=");if(i.length===2&&i[0]==e)return i[1]}return null},t.prototype.getApplicationType=function(){return this.productSettings?this.productSettings.type:null},t.prototype.getPlatformName=function(){return this.sdkSettings.platform},t.prototype.getUserUID=function(){return this._authorizationManager.getUserUID()},t.prototype.deferred=function(){return this._deferred},t.prototype.resolvePath=function(e){return e.indexOf("//")<0?this.appendPath(this._sdkHome,e):e},t.prototype.appendPath=function(e,n){var r;return n[0]==="/"?r=n:r=e+"/"+n,t.normalizePath(r)},t.normalizePath=function(e){var t="";if(e.indexOf("//")==0)t="//",e=e.substr(2);else{var n=e.indexOf(":///");if(n>0)t=e.substr(0,n+4),e=e.substr(n+4);else{var n=e.indexOf("://");n>0&&(t=e.substr(0,n+3),e=e.substr(n+3))}}var r=e.split("/"),i=document.location.pathname.split("/"),s,o,u=[],a;o=0;for(s=r.length-1;s>=0;s--){a=r[s];if(a===""||a===".")continue;a===".."?o++:o>0?o--:u.unshift(a)}return o>0&&(u=i.slice(0,i.length-o).concat(u)),t+u.join("/")},t.prototype.supportedMedia=function(t,n,r,i){var s=this.sdkSettings.mediaFormats[n];if(typeof s=="undefined")return null;for(var o in s)if(s.hasOwnProperty(o)){var u=s[o],a=r?r.indexOf(u.ext.replace(".",""))>=0:!0,f;t&&!i?f=t.canPlayType(u.mimeType):f=!0;if(a&&f)return u}return this.reportErrorEvent(e.Reporting.Errors.unsupportedMedia,n),null},t.prototype.toString=function(){return"[Api]"},t.init=function(e,n,r){if(!e)throw"You must specify productId";return(new t(e,n,r)).deferred()},t.prototype.requestServer=function(t,n,r){var i=new XMLHttpRequest,s=new e.Deferred(this);return i.open(n,t,!0),i.onreadystatechange=function(){if(i&&i.readyState===4){if(i.status===200||i.status===204)s.resolve(i.responseText);else{var e=i.statusText+" (status = "+i.status+")"+t;s.reject(e)}i=null}},i.send(r?JSON.stringify(r):null),s},t.prototype.loadTextFile=function(n,r){var i=this,s=new XMLHttpRequest,o=null,u=new e.Deferred(this);return s.open("GET",n,!0),s.setRequestHeader("Content-Type","text/plain"),s.onreadystatechange=function(){if(s&&s.readyState===4){if(s.status===200)u.resolve(s.responseText);else{var t=s.statusText+" (status = "+s.status+")"+n;u.reject(t),i.reportErrorEvent(e.Reporting.Errors.textFileError,t)}o!==null&&(clearTimeout(o),o=null),s=null}},o=setTimeout(function(){if(s&&s.readyState!==4){s.abort(),s=null;var t="Timeout: "+n;u.reject(t),i.reportErrorEvent(e.Reporting.Errors.textFileError,t)}},r?r:t.LOAD_TEXTFILE_TIMEOUT),s.send(),u},t.prototype.loadScript=function(n,r){function a(){u>0&&(clearTimeout(u),u=0)}var i=new e.Deferred(this),s=!1,o=this,u=window.setTimeout(function(){a(),s=!0,o.reportErrorEvent(e.Reporting.Errors.scriptTimeOut,n),i.reject("Script load TIMEOUT failed:"+n)},r?r:t.LOAD_SCRIPT_TIMEOUT),f=document.createElement("script");return f.onreadystatechange=f.onload=function(){if(!f.readyState||f.readyState==="loaded"||f.readyState==="complete")a(),s||i.resolve(f.src)},f.onerror=function(){a(),s||i.reject("Script load failed:"+n)},f.src=n,document.body.appendChild(f),i},t.prototype.incrementLoadState=function(){this._loadState++,console.log("_loadState: "+this._loadState),this._loadState>1&&this._deferred.isPending()&&(this.reportAppEvent(e.Reporting.AppEvents.Loaded),this._deferred.resolve(this))},t.prototype.stopEventPropagation=function(e){e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble&&(e.cancelBubble=!0)},t.prototype.enableKeyInput=function(){this._keyManager.setEnabled(!0,e.Key.ListenerType.Product,e.Key.EventType.Any)},t.prototype.disableKeyInput=function(){this._keyManager.setEnabled(!1,e.Key.ListenerType.Product,e.Key.EventType.Any)},t.prototype.disableInput=function(){this.disableKeyInput(),this.disableMouse()},t.prototype.enableInput=function(){this.enableKeyInput(),this.enableMouse()},t.prototype.getKeyManager=function(){return this._keyManager},t.prototype.getMouseManager=function(){return this._mouseManager},t.prototype.addKeyDownListener=function(t,n){this._keyManager.addListener(e.Key.ListenerType.Product,e.Key.EventType.KeyDown,t,n)},t.prototype.removeKeyDownListener=function(t){this._keyManager.removeListener(e.Key.ListenerType.Product,e.Key.EventType.KeyDown,t)},t.prototype.addKeyUpListener=function(t,n){this._keyManager.addListener(e.Key.ListenerType.Product,e.Key.EventType.KeyUp,t,n)},t.prototype.removeKeyUpListener=function(t){this._keyManager.removeListener(e.Key.ListenerType.Product,e.Key.EventType.KeyUp,t)},t.prototype.addMouseListener=function(t,n){this._mouseManager.addListener(t,n,e.Mouse.ListenerType.Product)},t.prototype.removeMouseListener=function(e){this._mouseManager.removeListener(e)},t.prototype.enableMouse=function(){this._mouseManager.enableMouse()},t.prototype.disableMouse=function(){this._mouseManager.disableMouse()},t.prototype.resetMouse=function(){this._mouseManager.reset()},t.prototype.addListener=function(e,t,n,r){typeof t=="string"&&(t=[t]);var i="_tgh5_"+t.join("_");e[i]=function(e){n.apply(r,e)},this.bind(e,t,e[i],!0)},t.prototype.removeListener=function(e,t,n){typeof t=="string"&&(t=[t]);var r="_tgh5_"+t.join("_");this.unbind(e,t,e[r],!0)},t.prototype.bind=function(e,t,n,r){if(!e)return;typeof t=="string"&&(t=[t]);for(var i=0;i<t.length;i++){var s=t[i];e.addEventListener?e.addEventListener(s,n,r===undefined?!1:r):e.attachEvent?(e.__tgh5_handler__=function(){n.call(window.event)},e.attachEvent("on"+s,e.__tgh5_handler__)):e["on"+s]=n}},t.prototype.unbind=function(e,t,n,r){if(!e)return;typeof t=="string"&&(t=[t]);for(var i=0;i<t.length;i++){var s=t[i];e.removeEventListener?e.removeEventListener(s,n,r==undefined?!1:r):e.detachEvent?(e.detachEvent("on"+s,e.__tgh5_handler__),e.__tgh5_handler__=null):e["on"+s]=null}},t.prototype.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"},t.prototype.isObject=function(e){return typeof e=="object"&&e instanceof Object&&!(e instanceof Array)},t.prototype.getWeekNumber=function(e,t){var n=new Date(e.getFullYear(),0,1),r=0;return t===!0&&(r=60*e.getFullYear()),r+Math.ceil(((e.getTime()-n.getTime())/864e5+n.getDay()+1)/7)},t.prototype.getMonthNumber=function(e,t){return t===!0?e.getMonth()+12*e.getFullYear():e.getMonth()},t.prototype.processLater=function(e,t){var n=[];for(var r=2;r<arguments.length;r++)n[r-2]=arguments[r];setTimeout(function(){e.apply(t,n)},4)},t.prototype.addOnPauseResumeListener=function(e){this._onPauseResumeListeners.indexOf(e)<0&&this._onPauseResumeListeners.push(e)},t.prototype.removeOnPauseResumeListener=function(e){var t=this._onPauseResumeListeners.indexOf(e);t>=0&&this._onPauseResumeListeners.splice(t,1)},t.prototype._invokePauseResume=function(e){for(var t=0;t<this._onPauseResumeListeners.length;t++)this._onPauseResumeListeners[t].call(this,e)},t.prototype.isExitAvailable=function(){return this._system.isExitAvailable()},t.prototype.isExtraExitAvailable=function(){return this._system.isExtraExitAvailable()},t.prototype.isLowEndDevice=function(){return this._system.isLowEndDevice()},t.prototype.textToSpeechPlay=function(e){this._system.textToSpeechPlay(e)},t.prototype.textToSpeechCancel=function(){this._system.textToSpeechCancel()},t.prototype.validateData=function(e,t,n){var r=this,i=!0,s=function(e){if(!n)return;i=!1,n(e)};if(!e)return s("data validation: data is not defined"),!1;var o=function(e,t,n){if(n.name&&typeof t[n.name]=="undefined")return n.optional===!0?!0:(s("data validation: property "+e+(n.name?n.name:"")+" does not defined"),!1);if(n.type==="array"){if(!r.isArray(t[n.name]))return s("data validation: property "+e+(n.name?n.name:"")+" is not "+n.type+" type"),!1}else if(n.type&&typeof (n.name?t[n.name]:t)!==n.type)return s("data validation: property "+e+(n.name?n.name:"")+" is not "+n.type+" type"),!1;if(typeof n.minLength!="undefined"&&(n.name?t[n.name]:t).length<n.minLength)return s("data validation: property "+e+(n.name?n.name:"")+" length less then "+n.minLength),!1;if(typeof n.maxLength!="undefined"&&(n.name?t[n.name]:t).length>n.maxLength)return s("data validation: property "+e+(n.name?n.name:"")+" length more then "+n.maxLength),!1;if(typeof n.allowedValues!="undefined"&&!n.properties&&n.allowedValues.indexOf(t)<0)return s("data validation: property "+e+" has wrong value"),!1;if(typeof n.properties!="undefined")for(var u=0;u<n.properties.length;u++)if(n.type==="array"){var a=t[n.name];for(var f=0;f<a.length;f++)if(!o(e+n.name+"["+f+"].",a[f],n.properties[u]))return!1}else if(!o(e+n.name+".",t[n.name],n.properties[u]))return!1;return i},u={name:"data",properties:t};return this.isArray(e)&&(u.type="array"),o("",{data:e},u),i},t.prototype.calculateMD5=function(e){return CryptoJS.MD5(e)+""},t.LOAD_SCRIPT_TIMEOUT=8e3,t.LOAD_TEXTFILE_TIMEOUT=6e4,t.WAIT_PANDING_REQUEST_TIMEOUT=3e3,t.CONFIG_SCRIPT_TIMEOUT=3e4,t.CHECK_SYNC_INTERVAL=50,t.RADIX_64_BASE="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/",t.DEFAULT_USER_NAME="GUEST",t._crcTable=null,t}(),e.Api=s}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(n){var r=[{name:"disabledTypes",optional:!0,type:"array",minLength:0,maxLength:100,properties:[{type:"string",allowedValues:["pre-roll","mid-roll","post-roll","rewarded"]}]},{name:"name",type:"string"},{name:"url",type:"string",minLength:7},{name:"priority",type:"number",optional:!0}],i=function(){function n(e,t){this._api=e,this._elements=[],this._slotEl=null,this._listeners=null,this._loadingBar=null,this._started=!1,this._className=t,this._created=!1,this._adsPodStartedReported=!1}return n.prototype.isAdExists=function(){return this._pwAdPlayer?this._pwAdPlayer&&typeof this._pwAdPlayer.hasVideoForPlay=="function"?this._pwAdPlayer.hasVideoForPlay(this._settings.event):!1:!1},n.prototype.requestAd=function(e,t){var n=this;this._listeners=t,this._settings=e,this._instructionEnabled=!1,this._copyrightEnabled=!1,this._isError=!1,this._started=!1,this._totalAdsVideos=-1,this._onStartCalled=!1,this._create(function(){n._requestAd()})},n.prototype._getElement=function(e){var t=n.CONTAINER_ELEMENTS.indexOf(e);return t<0?null:this._elements[t]},n.prototype._showCopyright=function(){var e=this._getElement("tgh5-ad-copyright");e.innerHTML=this._settings.copyrightText,e.style.display="block"},n.prototype._hide=function(){this._slotEl.style.display="none";for(var e=0;e<this._elements.length;e++)this._elements[e]&&(this._elements[e].style.display="none")},n.prototype._show=function(){this._slotEl.style.display=this._getElement("tgh5-ad-shield").style.display="block",this._settings.adSettings.notCreateVideoEl!==!0&&(this._getElement("tgh5-video").style.display="block")},n.prototype._showInstruction=function(){if(!this._instructionEnabled)return;this._updateInstructionText(),this._getElement("tgh5-ad-topStrip").style.display=this._getElement("tgh5-ad-topStripText").style.display="block"},n.prototype._updateInstructionText=function(){if(!this._instructionEnabled)return;var e=this._settings.instructionText,t=this._secondsLeft;t<0&&(t=0);if(this._totalAdsVideos>1&&this._settings.adPodInstructionText){e=this._settings.adPodInstructionText;var n="00"+(t/60|0);n=n[n.length-2]+n[n.length-1];var r="00"+t%60;r=r[r.length-2]+r[r.length-1],e=e.replace("[time]",n+":"+r),e=e.replace("[playedVideos]",""+(this._totalAdsVideos-this._leftAdsVideos)),e=e.replace("[totalVideos]",""+this._totalAdsVideos)}else e=e.replace("[time]",""+t);this._getElement("tgh5-ad-topStripText").innerHTML=e},n.prototype.startPreload=function(e,t){var n=this;this._settings=e,this._listeners=t,this._create(function(){n._pwAdPlayer.startPreload()})},n.prototype._requestAd=function(){var t=this;this._adsPodStartedReported=!1;if(this._settings.event==e.Ads.Type.PreRoll&&this._settings.adSettings.preRollHide==1){this._pwAdPlayer.startPreload(),this._onAdComplete();return}this._api.getAdsManager().isLoadingBarDisabled()&&(this._loadingBar=new e.LoadingProgressBar(this._api),this._loadingBar.create(document.body)),this._settings.instructionText&&(this._instructionEnabled=!0),this._settings.copyrightText&&(this._copyrightEnabled=!0,this._showCopyright()),this._settings.adSettings.width&&(n.VIDEO_WIDTH=this._settings.adSettings.width,n.VIDEO_HEIGHT=this._settings.adSettings.height),this._settings.adSettings.fullScreen===!0&&(window.innerWidth&&(n.VIDEO_WIDTH=window.innerWidth),window.innerHeight&&(n.VIDEO_HEIGHT=window.innerHeight),this._settings.adSettings.top=0,this._settings.adSettings.left=0),this._slotEl.className="tgh5-ad-container "+this._settings.event;var r=this._getElement("tgh5-video");r&&(r.className="tgh5-video "+this._settings.event,r.style.width=n.VIDEO_WIDTH+"px",r.style.height=n.VIDEO_HEIGHT+"px"),typeof this._settings.adSettings.top!="undefined"&&(r&&(r.style.top=this._settings.adSettings.top+"px"),this._settings.adSettings.top==0&&(this._getElement("tgh5-ad-topStrip").style.opacity="0.7")),r&&typeof this._settings.adSettings.left!="undefined"&&(r.style.left=this._settings.adSettings.left+"px"),r&&this._settings.adSettings.border===!1&&(r.style.border="none"),this._restoreMusic=!0,this._api.isMusicPlaying()&&this.isAdExists()?this._api.stopMusic().always(function(){t._pwAdPlayer.requestAd(null,t._settings.event)}):this._pwAdPlayer.requestAd(null,this._settings.event)},n.prototype.isSkipAdAllowed=function(){return this._pwAdPlayer&&typeof this._pwAdPlayer.isSkipAllowed=="function"?this._pwAdPlayer.isSkipAllowed():!1},n.prototype.stopPlayingAd=function(){var e=this;this._started&&this._pwAdPlayer&&typeof this._pwAdPlayer.interruptAd=="function"&&(typeof this._pwAdPlayer.isSkipAllowed!="function"||this._pwAdPlayer.isSkipAllowed())&&(this._pwAdPlayer.interruptAd(),this._started=!1,setTimeout(function(){e._tryRestoreMusic()},n.INTERRUPT_RESTORE_MUSIC_TIMEOUT))},n.prototype.release=function(){this._hide()},n.prototype._createSlotElement=function(){if(this._slotEl)return;this._slotEl=this._api.createDiv(n.SLOT_ELEMENT),this._slotEl.id=n.SLOT_ELEMENT,document.body.appendChild(this._slotEl)},n.prototype._createElements=function(){this._elements=[];for(var e=0;e<n.CONTAINER_ELEMENTS.length;e++){var t,r=n.CONTAINER_ELEMENTS[e];r=="tgh5-video"?this._settings.adSettings.notCreateVideoEl!==!0?(t=document.createElement("video"),t.id=r,t.className=r):t=null:t=this._api.createDiv(r),t&&this._slotEl.appendChild(t),this._elements.push(t)}this._hide()},n.prototype._fixUrlTag=function(e,t){var n=this,r=this._settings.adSettings.settings.providers;if(!r||e>=r.length){t();return}var i=r[e].url;this._api.getAdsManager().prepareAdURL(i,!0).always(function(i){r[e].url=i,n._fixUrlTag(e+1,t)})},n.prototype._getCountryCode=function(e){this._api.requestCountryCode().done(function(t){e(t)}).fail(function(){e(null)})},n.prototype.reset=function(){this._pwAdPlayer&&this._pwAdPlayer.reset()},n.prototype._create=function(n){var i=this;if(this._created)n();else{this._created=!0;try{this._createSlotElement(),this._createElements(),this._api.validateData(this._settings.adSettings.settings.providers,r,function(e){i._api.reportErrorEvent("configuration",e)}),this._settings.adSettings.width&&(this._settings.adSettings.settings.player.width=this._settings.adSettings.width),typeof this._settings.adSettings.top!="undefined"&&(this._settings.adSettings.settings.player.y=this._settings.adSettings.top),typeof this._settings.adSettings.left!="undefined"&&(this._settings.adSettings.settings.player.x=this._settings.adSettings.left),this._settings.adSettings.height&&(this._settings.adSettings.settings.player.height=this._settings.adSettings.height),this._fixUrlTag(0,function(){i._getCountryCode(function(r){var s={name:"",className:i._className,adTagName:"",vendorName:""};i._pwAdPlayer=new PWAD.Player(i._settings.adSettings.settings,r,i._api.sdkSettings.platform),i._pwAdPlayer.addListener("finished",function(){i._onAdComplete()}),i._pwAdPlayer.addListener("completed",function(n,r,o){i._secondsLeft=0,i._adVideoDuration=0,i._started&&(s.name=n,s.vendorName=i._listeners.owner.name,r===!0&&i._api.reportAdEvent(e.Reporting.Ads.completed,s,i._settings.event,1)),o&&(i._removeProviderRequest(n),i._api.getAdsManager().disablePerType([t.Type.PreRoll,t.Type.MidRoll,t.Type.PostRoll]))}),i._pwAdPlayer.addListener("request",function(t,n){s.name=t,s.vendorName=i._listeners.owner.name,i._api.reportAdEvent(e.Reporting.Ads.requestAd,s,"preload")}),i._pwAdPlayer.addListener("response",function(t,n,r){s.name=t,s.vendorName=i._listeners.owner.name,i._api.reportAdEvent(e.Reporting.Ads.responseAd,s,"preload"),i._api.reportAdPodResponse(s,"preload",r?r:1),i._api._onAdResponse()}),i._pwAdPlayer.addListener("impression",function(e,t,n){s.name=e,s.adTagName=n,s.vendorName=i._listeners.owner.name,i._api.reportAdImpression(s,i._settings.event,t)}),i._pwAdPlayer.addListener("started",function(e,t,n,r,o){if(typeof o!="undefined"){if(i._totalAdsVideos<0||i._totalAdsVideos===o)i._totalAdsVideos=o+1;i._leftAdsVideos=o}else i._totalAdsVideos=1,i._leftAdsVideos=0;i._adsPodStartedReported||(i._adsPodStartedReported=!0,s.name=t,s.adTagName=r,s.vendorName=i._listeners.owner.name,i._api.reportAdPodStarted(s,i._settings.event,i._totalAdsVideos)),i._onStarted(e)}),i._pwAdPlayer.addListener("error",function(e,t,n){s.name=t,s.vendorName=i._listeners.owner.name,s.adType=i._settings.event,e.code!=303&&(i._api.reportAdErrorEvent(e+"",s),n!==!1&&i._onError(e,!1))}),i._pwAdPlayer.addListener("timerUpdate",function(e,t){i._onTimeUpdate(e,t)}),n()})})}catch(s){this._onError(s+"",!0)}}},n.prototype._onTimeUpdate=function(e,t){!this._instructionEnabled&&t&&(this._adVideoDuration=Math.round(t/1e3),this._instructionEnabled=!0,this._showInstruction());if(this._instructionEnabled){var n=this._adVideoDuration-Math.round(e/1e3);if(n<this._secondsLeft||this._secondsLeft<=0)this._secondsLeft=n;this._updateInstructionText()}},n.prototype._onStarted=function(e){this._settings.adSettings.hideBody===!0&&(document.body.style.display="none"),this._loadingBar&&(this._loadingBar.suspend(),this._loadingBar=null),this._started=!0,e>0?(this._adVideoDuration=Math.round(e/1e3),this._instructionEnabled=!0):(this._instructionEnabled=!1,this._adVideoDuration=0),this._secondsLeft=this._adVideoDuration,this._showInstruction(),this._show(),this._listeners&&!this._onStartCalled&&(this._onStartCalled=!0,this._listeners.onAdStarted.call(this._listeners.owner))},n.prototype._tryRestoreMusic=function(){this._restoreMusic&&(this._restoreMusic=!1,this._api.isMusicPlaying()||this._api.playMusic())},n.prototype._removeProviderRequest=function(e){e&&typeof this._pwAdPlayer.disableProvider=="function"&&this._pwAdPlayer.disableProvider(e)},n.prototype._onAdComplete=function(){this._loadingBar&&(this._loadingBar.suspend(),this._loadingBar=null),this._settings.adSettings.hideBody===!0&&(document.body.style.display="block"),this._tryRestoreMusic();if(this._isError)return;var e=this._listeners;this.release(),this._started?e&&e.onAdComplete.call(e.owner):e&&e.onAdNoResponse.call(e.owner)},n.prototype._onError=function(e,t){this._loadingBar&&(this._loadingBar.suspend(),this._loadingBar=null),this._settings.adSettings.hideBody===!0&&(document.body.style.display="block"),this._tryRestoreMusic(),this._isError=!0,this._api.console.error(this._className+"Impl error:"+e),this._listeners&&this._listeners.onError.call(this._listeners.owner,e,t)},n.INTERRUPT_RESTORE_MUSIC_TIMEOUT=3e3,n.VIDEO_WIDTH=1280,n.VIDEO_HEIGHT=720,n.SLOT_ELEMENT="tgh5-ad-container",n.CONTAINER_ELEMENTS=["tgh5-video","tgh5-ad-topStrip","tgh5-ad-topStripText","tgh5-ad-copyright","tgh5-ad-shield"],n}();n.PWAdImpl=i})(n=t.Vendors||(t.Vendors={}))})(t=e.Ads||(e.Ads={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(n){var r=null,i=function(t){function i(e,n,r,i){return t.call(this,e,n,r,"PWAd",i)||this}return __extends(i,t),i.prototype.needToStopMusic=function(){return!1},i.prototype._createImplementation=function(){r||(r=new n.PWAdImpl(this.api,this.className)),this._impl=r},i.prototype._getListeners=function(){return{owner:this,onAdStarted:this.onAdStarted,onError:this.onAdError,onAdComplete:this.onAdComplete,onAdNoResponse:this.onAdNoResponse}},i.prototype.show=function(){return this.deferred=new e.Deferred(this.api),this._createImplementation(),this._impl.requestAd(this.getSettings(),this._getListeners()),this.deferred},i.prototype.release=function(){this._impl&&(this._impl.release(),this._impl=null)},i.prototype.stopPlayingAd=function(){this._impl&&this._impl.stopPlayingAd(),this.onFinish(),this.suspend(!0)},i.prototype.isStopPlayingAdAllowed=function(){return this._impl?this._impl.isSkipAdAllowed():!1},i.prototype.suspend=function(e){this.release(),e&&this.deferred&&this.deferred.resolve(this)},i.prototype.isNeedCopyright=function(){var e=this.api.sdkSettings.adsSettings.adsInstruction;if(!e)return!1;if(!e[this.event])return!1;var t=e[this.event];return t[this.api.productId]?t[this.api.productId].copyright:t["default"]?t["default"].copyright:!1},i.prototype.getSettings=function(){var e={event:this.event,adSettings:this.settings,name:this.name,copyrightText:"",instructionText:"",adPodInstructionText:""},t=this.api.sdkSettings.adsSettings.adsInstruction;return t&&t[this.event]&&(this.isNeedCopyright()===!0&&(e.copyrightText=this.api.getAdsManager().getText("copyrightText")),e.instructionText=this.api.getAdsManager().getText(this.event),e.adPodInstructionText=this.api.getAdsManager().getText("adPod")),e},i.prototype.startPreload=function(){this._impl||this._createImplementation(),this._impl.startPreload(this.getSettings(),this._getListeners())},i.prototype.isAdExists=function(){return this._impl||this._createImplementation(),this._impl.isAdExists()},i.prototype.onAdError=function(e,t){this.onError(e?e:"",t),this.suspend(t),this.deferred&&this.deferred.reject(e)},i.prototype.reportResponseAd=function(){return!1},i.prototype.reportCompleted=function(){return!1},i.prototype.reportRequestAd=function(){return!1},i.prototype.reportImpression=function(){return!1},i.prototype.reportError=function(){return!1},i.prototype.onAdComplete=function(){this.onFinish(),this.suspend(!0)},i.prototype.onAdNoResponse=function(){this.suspend(!0)},i.prototype.onAdStarted=function(){this.onStart()},i}(t.Vendor);n.PWAd=i})(n=t.Vendors||(t.Vendors={}))})(t=e.Ads||(e.Ads={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t;(function(e){var t=function(){function e(e){this._api=e,this._listeners=null,this._started=!1}return e.prototype.requestAd=function(e,t){var n=this;this._listeners=t,this._settings=e,this._isError=!1,this._started=!1;if(!this._cgCallbackCreated){this._cgCallbackCreated=!0;var r=CrazyGames.CrazySDK.getInstance();r.addEventListener("adStarted",function(e){n._onStarted()}),r.addEventListener("adFinished",function(e){n._onAdComplete()}),r.addEventListener("adError",function(e){console.log("adError: ",e),n._onError(""+(e&&e.error)?e.error+"":"unknown error",!1)})}this._requestAd()},e.prototype._requestAd=function(){console.log("CrazyGames: requestAd: "+this._settings.adSettings.type);var e=CrazyGames.CrazySDK.getInstance();e.requestAd(this._settings.adSettings.type)},e.prototype.release=function(){this._listeners=null},e.prototype._onStarted=function(){this._started=!0,this._listeners&&this._listeners.onAdStarted.call(this._listeners.owner)},e.prototype._onAdComplete=function(){if(this._isError)return;var e=this._listeners;this.release(),this._started?e&&e.onAdComplete.call(e.owner):e&&e.onAdNoResponse.call(e.owner)},e.prototype._onError=function(e,t){this._isError=!0,this._api.console.error("CGAdImpl error:"+e),this._listeners&&this._listeners.onError.call(this._listeners.owner,e,t)},e}();e.CGAdImpl=t})(t=e.Vendors||(e.Vendors={}))})(t=e.Ads||(e.Ads={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(n){var r,i=function(t){function i(e,n,r,i){return t.call(this,e,n,r,"CGAd",i)||this}return __extends(i,t),i.prototype.needToStopMusic=function(){return!0},i.prototype.show=function(){return this.deferred=new e.Deferred(this.api),r||(r=new n.CGAdImpl(this.api)),r.requestAd(this.getSettings(),{owner:this,onAdStarted:this.onAdStarted,onError:this.onAdError,onAdComplete:this.onAdComplete,onAdNoResponse:this.onAdNoResponse}),this.deferred},i.prototype.release=function(){r&&r.release()},i.prototype.suspend=function(e){this.release(),e&&this.deferred.resolve(this)},i.prototype.isAdExists=function(){return!0},i.prototype.getSettings=function(){var e={event:this.event,adSettings:this.settings};return e},i.prototype.onAdError=function(e,t){this.onError(e?e:"",t),this.suspend(t),this.deferred.reject(e)},i.prototype.reportError=function(){return!1},i.prototype.onAdComplete=function(){this.onFinish(),this.suspend(!0)},i.prototype.onAdNoResponse=function(){this.suspend(!0)},i.prototype.onAdStarted=function(){this.onStart()},i.AD_START_TIMEOUT=2e4,i}(t.Vendor);n.CGAd=i})(n=t.Vendors||(t.Vendors={}))})(t=e.Ads||(e.Ads={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t;(function(e){var t=function(){function e(e){this._api=e,this._listeners=null,this._started=!1}return e.prototype.requestAd=function(e,t){var n=this;this._listeners=t,this._settings=e,this._isError=!1,this._started=!1,this._api.console.error("Poki ad type:"+this._settings.event),this._settings.event==="rewarded"?PokiSDK.rewardedBreak(function(){n._onStarted()}).then(function(e){e?n._onAdComplete():n._onError("Rewarded ad failed",!1)}):PokiSDK.commercialBreak(function(){n._onStarted()}).then(function(){n._onAdComplete()})},e.prototype.release=function(){this._listeners=null},e.prototype._onStarted=function(){this._started=!0,this._listeners&&this._listeners.onAdStarted.call(this._listeners.owner)},e.prototype._onAdComplete=function(){if(this._isError)return;var e=this._listeners;this.release(),this._started?e&&e.onAdComplete.call(e.owner):e&&e.onAdNoResponse.call(e.owner)},e.prototype._onError=function(e,t){this._isError=!0,this._api.console.error("PokiAdImpl error:"+e),this._listeners&&this._listeners.onError.call(this._listeners.owner,e,t)},e}();e.PokiAdImpl=t})(t=e.Vendors||(e.Vendors={}))})(t=e.Ads||(e.Ads={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(n){var r,i=function(t){function i(e,n,r,i){return t.call(this,e,n,r,"PokiAd",i)||this}return __extends(i,t),i.prototype.needToStopMusic=function(){return!0},i.prototype.show=function(){return this.deferred=new e.Deferred(this.api),r||(r=new n.PokiAdImpl(this.api)),r.requestAd(this.getSettings(),{owner:this,onAdStarted:this.onAdStarted,onError:this.onAdError,onAdComplete:this.onAdComplete,onAdNoResponse:this.onAdNoResponse}),this.deferred},i.prototype.release=function(){r&&r.release()},i.prototype.suspend=function(e){this.release(),e&&this.deferred.resolve(this)},i.prototype.isAdExists=function(){return!0},i.prototype.getSettings=function(){var e={event:this.event,adSettings:this.settings};return e},i.prototype.onAdError=function(e,t){this.onError(e?e:"",t),this.suspend(t),this.deferred.reject(e)},i.prototype.reportError=function(){return!1},i.prototype.onAdComplete=function(){this.onFinish(),this.suspend(!0)},i.prototype.onAdNoResponse=function(){this.suspend(!0)},i.prototype.onAdStarted=function(){this.onStart()},i.AD_START_TIMEOUT=2e4,i}(t.Vendor);n.PokiAd=i})(n=t.Vendors||(t.Vendors={}))})(t=e.Ads||(e.Ads={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t;(function(e){var t=function(){function e(e){this._api=e,this._listeners=null,this._started=!1,this._initialized=!1}return e.prototype.requestAd=function(e,t){var n=this;this._listeners=t,this._settings=e,this._isError=!1,this._started=!1,this._initialized||(this._initialized=!0,this._airConsole=this._api.getSystem().getExternalManager(),this._airConsole.onAdShow=function(){n._onStarted()},this._airConsole.onAdComplete=function(e){n._onAdComplete(e)}),this._airConsole&&this._airConsole.showAd?this._airConsole.showAd():this._onError("AirConsole or showAd is undefined",!1)},e.prototype.release=function(){this._listeners=null},e.prototype._onStarted=function(){this._started=!0,this._listeners&&this._listeners.onAdStarted.call(this._listeners.owner)},e.prototype._onAdComplete=function(e){if(this._isError)return;var t=this._listeners;this.release(),this._started&&e?t&&t.onAdComplete.call(t.owner):t&&t.onAdNoResponse.call(t.owner)},e.prototype._onError=function(e,t){this._isError=!0,this._api.console.error("AirConsoleAdImpl error:"+e),this._listeners&&this._listeners.onError.call(this._listeners.owner,e,t)},e}();e.AirConsoleAdImpl=t})(t=e.Vendors||(e.Vendors={}))})(t=e.Ads||(e.Ads={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(n){var r,i=function(t){function i(e,n,r,i){return t.call(this,e,n,r,"AirConsoleAd",i)||this}return __extends(i,t),i.prototype.needToStopMusic=function(){return!0},i.prototype.show=function(){var t=this;return this.deferred=new e.Deferred(this.api),this._adRequestTimeOut=setTimeout(function(){t._clearAdStartTimeOut(),t.suspend(!1),t.deferred.reject("Time Out")},i.AD_START_TIMEOUT),r||(r=new n.AirConsoleAdImpl(this.api)),r.requestAd(this.getSettings(),{owner:this,onAdStarted:this.onAdStarted,onError:this.onAdError,onAdComplete:this.onAdComplete,onAdNoResponse:this.onAdNoResponse}),this.deferred},i.prototype._clearAdStartTimeOut=function(){this._adRequestTimeOut&&(clearTimeout(this._adRequestTimeOut),this._adRequestTimeOut=0)},i.prototype.release=function(){this._clearAdStartTimeOut(),r&&r.release()},i.prototype.suspend=function(e){this.release(),e&&this.deferred.resolve(this)},i.prototype.isAdExists=function(){return!1},i.prototype.getSettings=function(){var e={event:this.event,adSettings:this.settings};return e},i.prototype.onAdError=function(e,t){this.onError(e?e:"",t),this.suspend(t),this.deferred.reject(e)},i.prototype.reportError=function(){return!1},i.prototype.onAdComplete=function(){this.onFinish(),this.suspend(!0)},i.prototype.onAdNoResponse=function(){this.suspend(!0)},i.prototype.onAdStarted=function(){this._clearAdStartTimeOut(),this.onStart()},i.AD_START_TIMEOUT=2e4,i}(t.Vendor);n.AirConsoleAd=i})(n=t.Vendors||(t.Vendors={}))})(t=e.Ads||(e.Ads={}))}(TGH5||(TGH5={})),function(e){var t;(function(e){var t;(function(e){var t=function(){function e(e){this._api=e,this._videoEl=null,this._listeners=null,this._started=!1,this._isCreated=!1,this._isListenersEnabled=!1}return e.prototype.requestAd=function(e,t){this._listeners=t,this._settings=e,this._instructionEnabled=!1,this._copyrightEnabled=!1,this._isError=!1,this._started=!1,this._create(),this._requestAd()},e.prototype._getElement=function(t){var n=e.CONTAINER_ELEMENTS.indexOf(t);return n<0?null:this._elements[n]},e.prototype._showCopyright=function(){var e=this._getElement("tgh5-ad-copyright");e.innerHTML=this._settings.copyrightText,e.style.display="block"},e.prototype._hide=function(){this._slotEl.style.display="none";for(var e=0;e<this._elements.length;e++)this._elements[e].style.display="none"},e.prototype._show=function(){this._slotEl.style.display="block",this._getElement("tgh5-ad-shield").style.display="block"},e.prototype._showInstruction=function(){if(!this._instructionEnabled)return;this._updateInstructionText(),this._getElement("tgh5-ad-topStrip").style.display=this._getElement("tgh5-ad-topStripText").style.display="block"},e.prototype._updateInstructionText=function(){if(!this._instructionEnabled)return;var e=this._settings.instructionText;e.indexOf("[time]")>=0&&(e=e.replace("[time]",""+this._secondsLeft)),this._getElement("tgh5-ad-topStripText").innerHTML=e},e.prototype._requestAd=function(){var e=this;this._settings.instructionText&&(this._instructionEnabled=!0),this._settings.copyrightText&&(this._copyrightEnabled=!0,this._showCopyright()),this._isListenersEnabled=!0,this._getElement("tgh5-ad-container").className="tgh5-ad-container "+this._settings.event,this._videoEl.className="tgh5-video "+this._settings.event,this._videoEl.style.top="0",this._videoEl.style.left="0",this._videoEl.style.width="1280px",this._videoEl.style.height="720px",this._videoEl.style.border="none",this._api.getAdsManager().prepareAdURL(this._settings.adSettings.url).always(function(t){e._show(),cordova.exec(function(t){t?(e._videoEl.src=t,e._videoEl.autoplay=!0,e._videoEl.load()):e._onAdComplete()},function(t){var n=null;try{n=JSON.parse(t)}catch(r){}n||(n={message:t}),n.errorNumber==1009||n.errorNumber==1010?e._onAdComplete():e._onError(n.message,!1)},"IMAJSDriver","requestAd",[t])})},e.prototype.release=function(){this._listeners=null,this._hide()},e.prototype._create=function(){var t=this;if(this._isCreated)return;this._isCreated=!0,this._elements=[];for(var n=0;n<e.CONTAINER_ELEMENTS.length;n++){var r=e.CONTAINER_ELEMENTS[n],i=null;r===e.VIDEO_ELEMENT_ID&&(i=document.getElementById(e.VIDEO_ELEMENT_ID),i||(i=document.createElement("video"),this._slotEl.appendChild(i))),i||(i=this._api.createDiv(e.CONTAINER_ELEMENTS[n],n===0),n==0?this._slotEl=i:this._slotEl.appendChild(i)),this._elements.push(i)}this._videoEl=this._getElement(e.VIDEO_ELEMENT_ID),this._videoEl.addEventListener("timeupdate",function(e){t._isListenersEnabled&&t._onTimeUpdate()}),this._videoEl.addEventListener("playing",function(e){t._isListenersEnabled&&t._onStarted()}),this._videoEl.addEventListener("ended",function(e){t._isListenersEnabled&&t._onAdComplete()}),this._videoEl.addEventListener("error",function(e){t._isListenersEnabled&&t._onError("Video playing error",!1)}),this._hide()},e.prototype._onTimeUpdate=function(){if(!this._started)return;var e=this._videoEl.duration-this._videoEl.currentTime,t=Math.round(e);t<0&&(t=0),this._secondsLeft=t,this._instructionEnabled&&this._updateInstructionText(),cordova.exec(function(){},function(e){},"IMAJSDriver","timeUpdate",[this._videoEl.currentTime,this._videoEl.duration])},e.prototype._onStarted=function(){this._started=!0,this._secondsLeft=Math.round(this._videoEl.duration),this._showInstruction(),this._videoEl.style.display="block",this._listeners&&this._listeners.onAdStarted.call(this._listeners.owner),cordova.exec(function(){},function(){},"IMAJSDriver","started",[this._videoEl.duration])},e.prototype._onAdComplete=function(){this._api.console.log("_onAdComplete: "+this._started);if(this._isError)return;this._isListenersEnabled=!1;var e=this._listeners;this.release(),this._started?e&&e.onAdComplete.call(e.owner):e&&e.onAdNoResponse.call(e.owner),cordova.exec(function(){},function(){},"IMAJSDriver","completed",[])},e.prototype._onError=function(e,t){this._isError=!0,this._isListenersEnabled=!1,this._api.console.error("CordovaIMAImpl error:"+e),this._listeners&&this._listeners.onError.call(this._listeners.owner,e,t),cordova.exec(function(){},function(){},"IMAJSDriver","error",[e])},e.CONTAINER_ELEMENTS=["tgh5-ad-container","tgh5-video","tgh5-ad-topStrip","tgh5-ad-topStripText","tgh5-ad-copyright","tgh5-ad-shield"],e.VIDEO_ELEMENT_ID="tgh5-video",e}();e.CordovaIMAImpl=t})(t=e.Vendors||(e.Vendors={}))})(t=e.Ads||(e.Ads={}))}(TGH5||(TGH5={})),function(e){var t;(function(t){var n;(function(n){var r=null,i=function(t){function i(e,n,r,i){var s=t.call(this,e,n,r,"CordovaIMA",i)||this;return s._adRequestTimeOut=0,s}return __extends(i,t),i.prototype.needToStopMusic=function(){return!0},i.prototype._clearAdStartTimeOut=function(){this._adRequestTimeOut&&(clearTimeout(this._adRequestTimeOut),this._adRequestTimeOut=0)},i.prototype._createImplementation=function(){r||(r=new n.CordovaIMAImpl(this.api)),this._impl=r},i.prototype.show=function(){var t=this;return this.deferred=new e.Deferred(this.api),this._createImplementation(),this._adRequestTimeOut=setTimeout(function(){t._clearAdStartTimeOut(),t.suspend(!1),t.deferred.reject("Time Out")},i.AD_START_TIMEOUT),this._impl.requestAd(this.getSettings(),{owner:this,onAdStarted:this.onAdStarted,onError:this.onAdError,onAdComplete:this.onAdComplete,onAdNoResponse:this.onAdNoResponse}),this.deferred},i.prototype.release=function(){this._clearAdStartTimeOut(),this._impl&&(this._impl.release(),this._impl=null)},i.prototype.suspend=function(e){this.release(),e&&this.deferred.resolve(this)},i.prototype.isNeedCopyright=function(){var e=this.api.sdkSettings.adsSettings.adsInstruction;if(!e)return!1;if(!e[this.event])return!1;var t=e[this.event];return t[this.api.productId]?t[this.api.productId].copyright:t["default"]?t["default"].copyright:!1},i.prototype.getSettings=function(){var e={event:this.event,adSettings:this.settings,name:this.name,copyrightText:"",instructionText:""},t=this.api.sdkSettings.adsSettings.adsInstruction;return t&&t[this.event]&&(this.isNeedCopyright()===!0&&(e.copyrightText=this.api.getAdsManager().getText("copyrightText")),e.instructionText=this.api.getAdsManager().getText(this.event)),e},i.prototype.isAdExists=function(){return!1},i.prototype.onAdError=function(e,t){this.onError(e?e:"",t),this.suspend(t),this.deferred.reject(e)},i.prototype.onAdComplete=function(){this.onFinish(),this.suspend(!0)},i.prototype.onAdNoResponse=function(){this.suspend(!0)},i.prototype.onAdStarted=function(){this._clearAdStartTimeOut(),this.onStart()},i.AD_START_TIMEOUT=2e4,i}(t.Vendor);n.CordovaIMA=i})(n=t.Vendors||(t.Vendors={}))})(t=e.Ads||(e.Ads={}))}(TGH5||(TGH5={}));